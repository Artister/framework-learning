/*
* (c)2002-2015 Skava. All rights reserved. The Skava system, including without
* limitation, all software and other elements thereof, are owned or controlled
* exclusively by Skava and protected by copyright, patent, and other laws. Use
* without permission is prohibited. For further information contact Skava at
* info@skava.com.
*/
/*! Copyright 2012, Ben Lin (http://dreamerslab.com/)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 1.0.19
 *
 * Requires: jQuery >= 1.2.3
 */
(function (a) {
  if (typeof define === 'function' && define.amd) {
    define(['jquery'], a)
  } else { a(jQuery) }
}(function (a) {
  a.fn.addBack = a.fn.addBack || a.fn.andSelf; a.fn.extend({ actual: function (b, l) {
    if (!this[b]) {
      throw '$.actual => The jQuery method "' + b + '" you called does not exist'
    } var f = { absolute: false, clone: false, includeMargin: false, display: 'block' }; var i = a.extend(f, l); var e = this.eq(0); var h, j; if (i.clone === true) {
      h = function () {
        var m = 'position: absolute !important; top: -1000 !important; '
        e = e.clone().attr('style', m).appendTo('body')
      }; j = function () { e.remove() }
    } else {
      var g = []; var d = ''; var c; h = function () {
        c = e.parents().addBack().filter(':hidden')
        d += 'visibility: hidden !important; display: ' + i.display + ' !important; '; if (i.absolute === true) { d += 'position: absolute !important; ' }c.each(function () {
          var m = a(this)
          var n = m.attr('style'); g.push(n); m.attr('style', n ? n + ';' + d : d)
        })
      }; j = function () {
        c.each(function (m) {
          var o = a(this); var n = g[m]; if (n === undefined) {
            o.removeAttr('style')
          } else { o.attr('style', n) }
        })
      }
    }h(); var k = /(outer)/.test(b) ? e[b](i.includeMargin) : e[b](); j(); return k
  } })
}))

!(function (n) { n.easing.jswing = n.easing.swing, n.extend(n.easing, { def: 'easeOutQuad', swing: function (t, e, u, a, r) { return n.easing[n.easing.def](t, e, u, a, r) }, easeInQuad: function (n, t, e, u, a) { return u * (t /= a) * t + e }, easeOutQuad: function (n, t, e, u, a) { return -u * (t /= a) * (t - 2) + e }, easeInOutQuad: function (n, t, e, u, a) { return (t /= a / 2) < 1 ? u / 2 * t * t + e : -u / 2 * (--t * (t - 2) - 1) + e }, easeInCubic: function (n, t, e, u, a) { return u * (t /= a) * t * t + e }, easeOutCubic: function (n, t, e, u, a) { return u * ((t = t / a - 1) * t * t + 1) + e }, easeInOutCubic: function (n, t, e, u, a) { return (t /= a / 2) < 1 ? u / 2 * t * t * t + e : u / 2 * ((t -= 2) * t * t + 2) + e }, easeInQuart: function (n, t, e, u, a) { return u * (t /= a) * t * t * t + e }, easeOutQuart: function (n, t, e, u, a) { return -u * ((t = t / a - 1) * t * t * t - 1) + e }, easeInOutQuart: function (n, t, e, u, a) { return (t /= a / 2) < 1 ? u / 2 * t * t * t * t + e : -u / 2 * ((t -= 2) * t * t * t - 2) + e }, easeInQuint: function (n, t, e, u, a) { return u * (t /= a) * t * t * t * t + e }, easeOutQuint: function (n, t, e, u, a) { return u * ((t = t / a - 1) * t * t * t * t + 1) + e }, easeInOutQuint: function (n, t, e, u, a) { return (t /= a / 2) < 1 ? u / 2 * t * t * t * t * t + e : u / 2 * ((t -= 2) * t * t * t * t + 2) + e }, easeInSine: function (n, t, e, u, a) { return -u * Math.cos(t / a * (Math.PI / 2)) + u + e }, easeOutSine: function (n, t, e, u, a) { return u * Math.sin(t / a * (Math.PI / 2)) + e }, easeInOutSine: function (n, t, e, u, a) { return -u / 2 * (Math.cos(Math.PI * t / a) - 1) + e }, easeInExpo: function (n, t, e, u, a) { return t == 0 ? e : u * Math.pow(2, 10 * (t / a - 1)) + e }, easeOutExpo: function (n, t, e, u, a) { return t == a ? e + u : u * (1 - Math.pow(2, -10 * t / a)) + e }, easeInOutExpo: function (n, t, e, u, a) { return t == 0 ? e : t == a ? e + u : (t /= a / 2) < 1 ? u / 2 * Math.pow(2, 10 * (t - 1)) + e : u / 2 * (2 - Math.pow(2, -10 * --t)) + e }, easeInCirc: function (n, t, e, u, a) { return -u * (Math.sqrt(1 - (t /= a) * t) - 1) + e }, easeOutCirc: function (n, t, e, u, a) { return u * Math.sqrt(1 - (t = t / a - 1) * t) + e }, easeInOutCirc: function (n, t, e, u, a) { return (t /= a / 2) < 1 ? -u / 2 * (Math.sqrt(1 - t * t) - 1) + e : u / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + e }, easeInElastic: function (n, t, e, u, a) { var r = 1.70158; var i = 0; var s = u; if (t == 0) return e; if ((t /= a) == 1) return e + u; if (i || (i = 0.3 * a), s < Math.abs(u)) { s = u; var r = i / 4 } else var r = i / (2 * Math.PI) * Math.asin(u / s); return -s * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * a - r) * (2 * Math.PI) / i) + e }, easeOutElastic: function (n, t, e, u, a) { var r = 1.70158; var i = 0; var s = u; if (t == 0) return e; if ((t /= a) == 1) return e + u; if (i || (i = 0.3 * a), s < Math.abs(u)) { s = u; var r = i / 4 } else var r = i / (2 * Math.PI) * Math.asin(u / s); return s * Math.pow(2, -10 * t) * Math.sin((t * a - r) * (2 * Math.PI) / i) + u + e }, easeInOutElastic: function (n, t, e, u, a) { var r = 1.70158; var i = 0; var s = u; if (t == 0) return e; if ((t /= a / 2) == 2) return e + u; if (i || (i = a * (0.3 * 1.5)), s < Math.abs(u)) { s = u; var r = i / 4 } else var r = i / (2 * Math.PI) * Math.asin(u / s); return t < 1 ? s * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * a - r) * (2 * Math.PI) / i) * -0.5 + e : s * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * a - r) * (2 * Math.PI) / i) * 0.5 + u + e }, easeInBack: function (n, t, e, u, a, r) { return void 0 == r && (r = 1.70158), u * (t /= a) * t * ((r + 1) * t - r) + e }, easeOutBack: function (n, t, e, u, a, r) { return void 0 == r && (r = 1.70158), u * ((t = t / a - 1) * t * ((r + 1) * t + r) + 1) + e }, easeInOutBack: function (n, t, e, u, a, r) { return void 0 == r && (r = 1.70158), (t /= a / 2) < 1 ? u / 2 * (t * t * ((1 + (r *= 1.525)) * t - r)) + e : u / 2 * ((t -= 2) * t * ((1 + (r *= 1.525)) * t + r) + 2) + e }, easeInBounce: function (t, e, u, a, r) { return a - n.easing.easeOutBounce(t, r - e, 0, a, r) + u }, easeOutBounce: function (n, t, e, u, a) { return (t /= a) < 1 / 2.75 ? u * (7.5625 * t * t) + e : t < 2 / 2.75 ? u * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + e : t < 2.5 / 2.75 ? u * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + e : u * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + e }, easeInOutBounce: function (t, e, u, a, r) { return e < r / 2 ? 0.5 * n.easing.easeInBounce(t, 2 * e, 0, a, r) + u : 0.5 * n.easing.easeOutBounce(t, 2 * e - r, 0, a, r) + 0.5 * a + u } }) }(jQuery))
var jaaulde = window.jaaulde || {}; jaaulde.utils = jaaulde.utils || {}, jaaulde.utils.cookies = (function () { var e; var t; var o; var i; var n = { expiresAt: null, path: '/', domain: null, secure: !1 }; return e = function (e) { var t, o; return typeof e !== 'object' || e === null ? t = n : (t = { expiresAt: n.expiresAt, path: n.path, domain: n.domain, secure: n.secure }, typeof e.expiresAt === 'object' && e.expiresAt instanceof Date ? t.expiresAt = e.expiresAt : typeof e.hoursToLive === 'number' && e.hoursToLive !== 0 && (o = new Date(), o.setTime(o.getTime() + 60 * e.hoursToLive * 60 * 1e3), t.expiresAt = o), typeof e.path === 'string' && e.path !== '' && (t.path = e.path), typeof e.domain === 'string' && e.domain !== '' && (t.domain = e.domain), !0 === e.secure && (t.secure = e.secure)), t }, t = function (t) { return t = e(t), (typeof t.expiresAt === 'object' && t.expiresAt instanceof Date ? '; expires=' + t.expiresAt.toGMTString() : '') + '; path=' + t.path + (typeof t.domain === 'string' ? '; domain=' + t.domain : '') + (!0 === t.secure ? '; secure' : '') }, o = function () { var e; var t; var o; var i; var n; var r = {}; var c = document.cookie.split(';'); for (e = 0; e < c.length; e += 1) { t = c[e].split('='), o = t[0].replace(/^\s*/, '').replace(/\s*$/, ''); try { i = decodeURIComponent(t[1]) } catch (e) { i = t[1] } if (typeof JSON === 'object' && JSON !== null && typeof JSON.parse === 'function') try { n = i, i = JSON.parse(i) } catch (e) { i = n }r[o] = i } return r }, i = function () {}, i.prototype.get = function (e) { var t; var i; var n = o(); if (typeof e === 'string')t = void 0 !== n[e] ? n[e] : null; else if (typeof e === 'object' && e !== null) { t = {}; for (i in e)t[e[i]] = void 0 !== n[e[i]] ? n[e[i]] : null } else t = n; return t }, i.prototype.filter = function (e) { var t; var i = {}; var n = o(); typeof e === 'string' && (e = RegExp(e)); for (t in n)t.match(e) && (i[t] = n[t]); return i }, i.prototype.set = function (e, o, i) { if ((typeof i !== 'object' || i === null) && (i = {}), void 0 === o || o === null)o = '', i.hoursToLive = -8760; else if (typeof o !== 'string') { if (typeof JSON !== 'object' || JSON === null || typeof JSON.stringify !== 'function') throw Error('cookies.set() received non-string value and could not serialize.'); o = JSON.stringify(o) } var n = t(i); document.cookie = e + '=' + (i.noencode ? o : encodeURIComponent(o)) + n }, i.prototype.del = function (e, t) { var o; var i = {}; (typeof t !== 'object' || t === null) && (t = {}), typeof e === 'boolean' && !0 === e ? i = this.get() : typeof e === 'string' && (i[e] = !0); for (o in i) typeof o === 'string' && o !== '' && this.set(o, null, t) }, i.prototype.test = function () { var e = !1; var t = 'cT'; var o = 'data'; return this.set(t, o), this.get(t) === o && (this.del(t), e = !0), e }, i.prototype.setOptions = function (t) { typeof t !== 'object' && (t = null), n = e(t) }, new i() }()), (function () { window.jQuery && (function (e) { e.cookies = jaaulde.utils.cookies; var t = { cookify: function (t) { return this.each(function () { var o; var i; var n; var r = ['name', 'id']; var c = e(this); for (o in r) if (!isNaN(o) && typeof (i = c.attr(r[o])) === 'string' && i !== '') { c.is(':checkbox, :radio') ? c.attr('checked') && (n = c.val()) : n = c.is(':input') ? c.val() : c.html(), (typeof n !== 'string' || n === '') && (n = null), e.cookies.set(i, n, t); break } }) }, cookieFill: function () { return this.each(function () { var t; var o; var i; var n; var r = ['name', 'id']; var c = e(this); for (o = function () { return !!(t = r.pop()) }; o();) if (typeof (i = c.attr(t)) === 'string' && i !== '') { (n = e.cookies.get(i)) !== null && (c.is(':checkbox, :radio') ? c.val() === n ? c.attr('checked', 'checked') : c.removeAttr('checked') : c.is(':input') ? c.val(n) : c.html(n)); break } }) }, cookieBind: function (t) { return this.each(function () { var o = e(this); o.cookieFill().change(function () { o.cookify(t) }) }) } }; e.each(t, function (t) { e.fn[t] = this }) }(window.jQuery)) }())
!(function () { var t = !1; var n = /xyz/.test(function () {}) ? /\b_super\b/ : /.*/; this.Class = function () {}, Class.extend = function (i) { function r () { !t && this.init && this.init.apply(this, arguments) } var s = this.prototype; t = !0; var e = new this(); t = !1; for (var o in i)e[o] = typeof i[o] === 'function' && typeof s[o] === 'function' && n.test(i[o]) ? (function (t, n) { return function () { var i = this._super; this._super = s[t]; var r = n.apply(this, arguments); return this._super = i, r } }(o, i[o])) : i[o]; return r.prototype = e, r.constructor = r, r.extend = arguments.callee, r } }())
/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.3.4 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, https://github.com/requirejs/requirejs/blob/master/LICENSE
 */
var requirejs, require, define; !(function (global, setTimeout) { function commentReplace (e, t) { return t || '' } function isFunction (e) { return ostring.call(e) === '[object Function]' } function isArray (e) { return ostring.call(e) === '[object Array]' } function each (e, t) { if (e) { var i; for (i = 0; i < e.length && (!e[i] || !t(e[i], i, e)); i += 1); } } function eachReverse (e, t) { if (e) { var i; for (i = e.length - 1; i > -1 && (!e[i] || !t(e[i], i, e)); i -= 1); } } function hasProp (e, t) { return hasOwn.call(e, t) } function getOwn (e, t) { return hasProp(e, t) && e[t] } function eachProp (e, t) { var i; for (i in e) if (hasProp(e, i) && t(e[i], i)) break } function mixin (e, t, i, r) { return t && eachProp(t, function (t, n) { !i && hasProp(e, n) || (!r || typeof t !== 'object' || !t || isArray(t) || isFunction(t) || t instanceof RegExp ? e[n] = t : (e[n] || (e[n] = {}), mixin(e[n], t, i, r))) }), e } function bind (e, t) { return function () { return t.apply(e, arguments) } } function scripts () { return document.getElementsByTagName('script') } function defaultOnError (e) { throw e } function getGlobal (e) { if (!e) return e; var t = global; return each(e.split('.'), function (e) { t = t[e] }), t } function makeError (e, t, i, r) { var n = new Error(t + '\nhttp://requirejs.org/docs/errors.html#' + e); return n.requireType = e, n.requireModules = r, i && (n.originalError = i), n } function newContext (e) { function t (e) { var t, i; for (t = 0; t < e.length; t++) if ((i = e[t]) === '.')e.splice(t, 1), t -= 1; else if (i === '..') { if (t === 0 || t === 1 && e[2] === '..' || e[t - 1] === '..') continue; t > 0 && (e.splice(t - 1, 2), t -= 2) } } function i (e, i, r) { var n; var o; var a; var s; var u; var c; var d; var p; var f; var l; var h = i && i.split('/'); var m = y.map; var g = m && m['*']; if (e && (c = (e = e.split('/')).length - 1, y.nodeIdCompat && jsSuffixRegExp.test(e[c]) && (e[c] = e[c].replace(jsSuffixRegExp, '')), e[0].charAt(0) === '.' && h && (e = h.slice(0, h.length - 1).concat(e)), t(e), e = e.join('/')), r && m && (h || g)) { e:for (a = (o = e.split('/')).length; a > 0; a -= 1) { if (u = o.slice(0, a).join('/'), h) for (s = h.length; s > 0; s -= 1) if ((n = getOwn(m, h.slice(0, s).join('/'))) && (n = getOwn(n, u))) { d = n, p = a; break e }!f && g && getOwn(g, u) && (f = getOwn(g, u), l = a) }!d && f && (d = f, p = l), d && (o.splice(0, p, d), e = o.join('/')) } return getOwn(y.pkgs, e) || e } function r (e) { isBrowser && each(scripts(), function (t) { if (t.getAttribute('data-requiremodule') === e && t.getAttribute('data-requirecontext') === q.contextName) return t.parentNode.removeChild(t), !0 }) } function n (e) { var t = getOwn(y.paths, e); if (t && isArray(t) && t.length > 1) return t.shift(), q.require.undef(e), q.makeRequire(null, { skipMap: !0 })([e]), !0 } function o (e) { var t; var i = e ? e.indexOf('!') : -1; return i > -1 && (t = e.substring(0, i), e = e.substring(i + 1, e.length)), [t, e] } function a (e, t, r, n) { var a; var s; var u; var c; var d = null; var p = t ? t.name : null; var f = e; var l = !0; var h = ''; return e || (l = !1, e = '_@r' + (T += 1)), c = o(e), d = c[0], e = c[1], d && (d = i(d, p, n), s = getOwn(j, d)), e && (d ? h = r ? e : s && s.normalize ? s.normalize(e, function (e) { return i(e, p, n) }) : e.indexOf('!') === -1 ? i(e, p, n) : e : (d = (c = o(h = i(e, p, n)))[0], h = c[1], r = !0, a = q.nameToUrl(h))), u = !d || s || r ? '' : '_unnormalized' + (A += 1), { prefix: d, name: h, parentMap: t, unnormalized: !!u, url: a, originalName: f, isDefine: l, id: (d ? d + '!' + h : h) + u } } function s (e) { var t = e.id; var i = getOwn(S, t); return i || (i = S[t] = new q.Module(e)), i } function u (e, t, i) { var r = e.id; var n = getOwn(S, r); !hasProp(j, r) || n && !n.defineEmitComplete ? (n = s(e)).error && t === 'error' ? i(n.error) : n.on(t, i) : t === 'defined' && i(j[r]) } function c (e, t) { var i = e.requireModules; var r = !1; t ? t(e) : (each(i, function (t) { var i = getOwn(S, t); i && (i.error = e, i.events.error && (r = !0, i.emit('error', e))) }), r || req.onError(e)) } function d () { globalDefQueue.length && (each(globalDefQueue, function (e) { var t = e[0]; typeof t === 'string' && (q.defQueueMap[t] = !0), O.push(e) }), globalDefQueue = []) } function p (e) { delete S[e], delete k[e] } function f (e, t, i) { var r = e.map.id; e.error ? e.emit('error', e.error) : (t[r] = !0, each(e.depMaps, function (r, n) { var o = r.id; var a = getOwn(S, o); !a || e.depMatched[n] || i[o] || (getOwn(t, o) ? (e.defineDep(n, j[o]), e.check()) : f(a, t, i)) }), i[r] = !0) } function l () { var e; var t; var i = 1e3 * y.waitSeconds; var o = i && q.startTime + i < (new Date()).getTime(); var a = []; var s = []; var u = !1; var d = !0; if (!x) { if (x = !0, eachProp(k, function (e) { var i = e.map; var c = i.id; if (e.enabled && (i.isDefine || s.push(e), !e.error)) if (!e.inited && o)n(c) ? (t = !0, u = !0) : (a.push(c), r(c)); else if (!e.inited && e.fetched && i.isDefine && (u = !0, !i.prefix)) return d = !1 }), o && a.length) return e = makeError('timeout', 'Load timeout for modules: ' + a, null, a), e.contextName = q.contextName, c(e); d && each(s, function (e) { f(e, {}, {}) }), o && !t || !u || !isBrowser && !isWebWorker || w || (w = setTimeout(function () { w = 0, l() }, 50)), x = !1 } } function h (e) { hasProp(j, e[0]) || s(a(e[0], null, !0)).init(e[1], e[2]) } function m (e, t, i, r) { e.detachEvent && !isOpera ? r && e.detachEvent(r, t) : e.removeEventListener(i, t, !1) } function g (e) { var t = e.currentTarget || e.srcElement; return m(t, q.onScriptLoad, 'load', 'onreadystatechange'), m(t, q.onScriptError, 'error'), { node: t, id: t && t.getAttribute('data-requiremodule') } } function v () { var e; for (d(); O.length;) { if ((e = O.shift())[0] === null) return c(makeError('mismatch', 'Mismatched anonymous define() module: ' + e[e.length - 1])); h(e) }q.defQueueMap = {} } var x; var b; var q; var E; var w; var y = { waitSeconds: 7, baseUrl: './', paths: {}, bundles: {}, pkgs: {}, shim: {}, config: {} }; var S = {}; var k = {}; var M = {}; var O = []; var j = {}; var P = {}; var R = {}; var T = 1; var A = 1; return E = { require: function (e) { return e.require ? e.require : e.require = q.makeRequire(e.map) }, exports: function (e) { if (e.usingExports = !0, e.map.isDefine) return e.exports ? j[e.map.id] = e.exports : e.exports = j[e.map.id] = {} }, module: function (e) { return e.module ? e.module : e.module = { id: e.map.id, uri: e.map.url, config: function () { return getOwn(y.config, e.map.id) || {} }, exports: e.exports || (e.exports = {}) } } }, b = function (e) { this.events = getOwn(M, e.id) || {}, this.map = e, this.shim = getOwn(y.shim, e.id), this.depExports = [], this.depMaps = [], this.depMatched = [], this.pluginMaps = {}, this.depCount = 0 }, b.prototype = { init: function (e, t, i, r) { r = r || {}, this.inited || (this.factory = t, i ? this.on('error', i) : this.events.error && (i = bind(this, function (e) { this.emit('error', e) })), this.depMaps = e && e.slice(0), this.errback = i, this.inited = !0, this.ignore = r.ignore, r.enabled || this.enabled ? this.enable() : this.check()) }, defineDep: function (e, t) { this.depMatched[e] || (this.depMatched[e] = !0, this.depCount -= 1, this.depExports[e] = t) }, fetch: function () { if (!this.fetched) { this.fetched = !0, q.startTime = (new Date()).getTime(); var e = this.map; if (!this.shim) return e.prefix ? this.callPlugin() : this.load(); q.makeRequire(this.map, { enableBuildCallback: !0 })(this.shim.deps || [], bind(this, function () { return e.prefix ? this.callPlugin() : this.load() })) } }, load: function () { var e = this.map.url; P[e] || (P[e] = !0, q.load(this.map.id, e)) }, check: function () { if (this.enabled && !this.enabling) { var e; var t; var i = this.map.id; var r = this.depExports; var n = this.exports; var o = this.factory; if (this.inited) { if (this.error) this.emit('error', this.error); else if (!this.defining) { if (this.defining = !0, this.depCount < 1 && !this.defined) { if (isFunction(o)) { if (this.events.error && this.map.isDefine || req.onError !== defaultOnError) try { n = q.execCb(i, o, r, n) } catch (t) { e = t } else n = q.execCb(i, o, r, n); if (this.map.isDefine && void 0 === n && ((t = this.module) ? n = t.exports : this.usingExports && (n = this.exports)), e) return e.requireMap = this.map, e.requireModules = this.map.isDefine ? [this.map.id] : null, e.requireType = this.map.isDefine ? 'define' : 'require', c(this.error = e) } else n = o; if (this.exports = n, this.map.isDefine && !this.ignore && (j[i] = n, req.onResourceLoad)) { var a = []; each(this.depMaps, function (e) { a.push(e.normalizedMap || e) }), req.onResourceLoad(q, this.map, a) }p(i), this.defined = !0 } this.defining = !1, this.defined && !this.defineEmitted && (this.defineEmitted = !0, this.emit('defined', this.exports), this.defineEmitComplete = !0) } } else hasProp(q.defQueueMap, i) || this.fetch() } }, callPlugin: function () { var e = this.map; var t = e.id; var r = a(e.prefix); this.depMaps.push(r), u(r, 'defined', bind(this, function (r) { var n; var o; var d; var f = getOwn(R, this.map.id); var l = this.map.name; var h = this.map.parentMap ? this.map.parentMap.name : null; var m = q.makeRequire(e.parentMap, { enableBuildCallback: !0 }); return this.map.unnormalized ? (r.normalize && (l = r.normalize(l, function (e) { return i(e, h, !0) }) || ''), o = a(e.prefix + '!' + l, this.map.parentMap, !0), u(o, 'defined', bind(this, function (e) { this.map.normalizedMap = o, this.init([], function () { return e }, null, { enabled: !0, ignore: !0 }) })), void ((d = getOwn(S, o.id)) && (this.depMaps.push(o), this.events.error && d.on('error', bind(this, function (e) { this.emit('error', e) })), d.enable()))) : f ? (this.map.url = q.nameToUrl(f), void this.load()) : ((n = bind(this, function (e) { this.init([], function () { return e }, null, { enabled: !0 }) })).error = bind(this, function (e) { this.inited = !0, this.error = e, e.requireModules = [t], eachProp(S, function (e) { e.map.id.indexOf(t + '_unnormalized') === 0 && p(e.map.id) }), c(e) }), n.fromText = bind(this, function (i, r) { var o = e.name; var u = a(o); var d = useInteractive; r && (i = r), d && (useInteractive = !1), s(u), hasProp(y.config, t) && (y.config[o] = y.config[t]); try { req.exec(i) } catch (e) { return c(makeError('fromtexteval', 'fromText eval for ' + t + ' failed: ' + e, e, [t])) }d && (useInteractive = !0), this.depMaps.push(u), q.completeLoad(o), m([o], n) }), void r.load(e.name, m, n, y)) })), q.enable(r, this), this.pluginMaps[r.id] = r }, enable: function () { k[this.map.id] = this, this.enabled = !0, this.enabling = !0, each(this.depMaps, bind(this, function (e, t) { var i, r, n; if (typeof e === 'string') { if (e = a(e, this.map.isDefine ? this.map : this.map.parentMap, !1, !this.skipMap), this.depMaps[t] = e, n = getOwn(E, e.id)) return void (this.depExports[t] = n(this)); this.depCount += 1, u(e, 'defined', bind(this, function (e) { this.undefed || (this.defineDep(t, e), this.check()) })), this.errback ? u(e, 'error', bind(this, this.errback)) : this.events.error && u(e, 'error', bind(this, function (e) { this.emit('error', e) })) }i = e.id, r = S[i], hasProp(E, i) || !r || r.enabled || q.enable(e, this) })), eachProp(this.pluginMaps, bind(this, function (e) { var t = getOwn(S, e.id); t && !t.enabled && q.enable(e, this) })), this.enabling = !1, this.check() }, on: function (e, t) { var i = this.events[e]; i || (i = this.events[e] = []), i.push(t) }, emit: function (e, t) { each(this.events[e], function (e) { e(t) }), e === 'error' && delete this.events[e] } }, q = { config: y, contextName: e, registry: S, defined: j, urlFetched: P, defQueue: O, defQueueMap: {}, Module: b, makeModuleMap: a, nextTick: req.nextTick, onError: c, configure: function (e) { if (e.baseUrl && e.baseUrl.charAt(e.baseUrl.length - 1) !== '/' && (e.baseUrl += '/'), typeof e.urlArgs === 'string') { var t = e.urlArgs; e.urlArgs = function (e, i) { return (i.indexOf('?') === -1 ? '?' : '&') + t } } var i = y.shim; var r = { paths: !0, bundles: !0, config: !0, map: !0 }; eachProp(e, function (e, t) { r[t] ? (y[t] || (y[t] = {}), mixin(y[t], e, !0, !0)) : y[t] = e }), e.bundles && eachProp(e.bundles, function (e, t) { each(e, function (e) { e !== t && (R[e] = t) }) }), e.shim && (eachProp(e.shim, function (e, t) { isArray(e) && (e = { deps: e }), !e.exports && !e.init || e.exportsFn || (e.exportsFn = q.makeShimExports(e)), i[t] = e }), y.shim = i), e.packages && each(e.packages, function (e) { var t; t = (e = typeof e === 'string' ? { name: e } : e).name, e.location && (y.paths[t] = e.location), y.pkgs[t] = e.name + '/' + (e.main || 'main').replace(currDirRegExp, '').replace(jsSuffixRegExp, '') }), eachProp(S, function (e, t) { e.inited || e.map.unnormalized || (e.map = a(t, null, !0)) }), (e.deps || e.callback) && q.require(e.deps || [], e.callback) }, makeShimExports: function (e) { return function () { var t; return e.init && (t = e.init.apply(global, arguments)), t || e.exports && getGlobal(e.exports) } }, makeRequire: function (t, n) { function o (i, r, u) { var d, p, f; return n.enableBuildCallback && r && isFunction(r) && (r.__requireJsBuild = !0), typeof i === 'string' ? isFunction(r) ? c(makeError('requireargs', 'Invalid require call'), u) : t && hasProp(E, i) ? E[i](S[t.id]) : req.get ? req.get(q, i, t, o) : (p = a(i, t, !1, !0), d = p.id, hasProp(j, d) ? j[d] : c(makeError('notloaded', 'Module name "' + d + '" has not been loaded yet for context: ' + e + (t ? '' : '. Use require([])')))) : (v(), q.nextTick(function () { v(), (f = s(a(null, t))).skipMap = n.skipMap, f.init(i, r, u, { enabled: !0 }), l() }), o) } return n = n || {}, mixin(o, { isBrowser: isBrowser, toUrl: function (e) { var r; var n = e.lastIndexOf('.'); var o = e.split('/')[0]; var a = o === '.' || o === '..'; return n !== -1 && (!a || n > 1) && (r = e.substring(n, e.length), e = e.substring(0, n)), q.nameToUrl(i(e, t && t.id, !0), r, !0) }, defined: function (e) { return hasProp(j, a(e, t, !1, !0).id) }, specified: function (e) { return e = a(e, t, !1, !0).id, hasProp(j, e) || hasProp(S, e) } }), t || (o.undef = function (e) { d(); var i = a(e, t, !0); var n = getOwn(S, e); n.undefed = !0, r(e), delete j[e], delete P[i.url], delete M[e], eachReverse(O, function (t, i) { t[0] === e && O.splice(i, 1) }), delete q.defQueueMap[e], n && (n.events.defined && (M[e] = n.events), p(e)) }), o }, enable: function (e) { getOwn(S, e.id) && s(e).enable() }, completeLoad: function (e) { var t; var i; var r; var o = getOwn(y.shim, e) || {}; var a = o.exports; for (d(); O.length;) { if ((i = O.shift())[0] === null) { if (i[0] = e, t) break; t = !0 } else i[0] === e && (t = !0); h(i) } if (q.defQueueMap = {}, r = getOwn(S, e), !t && !hasProp(j, e) && r && !r.inited) { if (!(!y.enforceDefine || a && getGlobal(a))) return n(e) ? void 0 : c(makeError('nodefine', 'No define call for ' + e, null, [e])); h([e, o.deps || [], o.exportsFn]) }l() }, nameToUrl: function (e, t, i) { var r; var n; var o; var a; var s; var u; var c; var d = getOwn(y.pkgs, e); if (d && (e = d), c = getOwn(R, e)) return q.nameToUrl(c, t, i); if (req.jsExtRegExp.test(e))s = e + (t || ''); else { for (r = y.paths, o = (n = e.split('/')).length; o > 0; o -= 1) if (a = n.slice(0, o).join('/'), u = getOwn(r, a)) { isArray(u) && (u = u[0]), n.splice(0, o, u); break }s = n.join('/'), s = ((s += t || (/^data\:|^blob\:|\?/.test(s) || i ? '' : '.js')).charAt(0) === '/' || s.match(/^[\w\+\.\-]+:/) ? '' : y.baseUrl) + s } return y.urlArgs && !/^blob\:/.test(s) ? s + y.urlArgs(e, s) : s }, load: function (e, t) { req.load(q, e, t) }, execCb: function (e, t, i, r) { return t.apply(r, i) }, onScriptLoad: function (e) { if (e.type === 'load' || readyRegExp.test((e.currentTarget || e.srcElement).readyState)) { interactiveScript = null; var t = g(e); q.completeLoad(t.id) } }, onScriptError: function (e) { var t = g(e); if (!n(t.id)) { var i = []; return eachProp(S, function (e, r) { r.indexOf('_@r') !== 0 && each(e.depMaps, function (e) { if (e.id === t.id) return i.push(r), !0 }) }), c(makeError('scripterror', 'Script error for "' + t.id + (i.length ? '", needed by: ' + i.join(', ') : '"'), e, [t.id])) } } }, q.require = q.makeRequire(), q } function getInteractiveScript () { return interactiveScript && interactiveScript.readyState === 'interactive' ? interactiveScript : (eachReverse(scripts(), function (e) { if (e.readyState === 'interactive') return interactiveScript = e }), interactiveScript) } var req; var s; var head; var baseElement; var dataMain; var src; var interactiveScript; var currentlyAddingScript; var mainScript; var subPath; var version = '2.3.4'; var commentRegExp = /\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm; var cjsRequireRegExp = /[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g; var jsSuffixRegExp = /\.js$/; var currDirRegExp = /^\.\//; var op = Object.prototype; var ostring = op.toString; var hasOwn = op.hasOwnProperty; var isBrowser = !(typeof window === 'undefined' || typeof navigator === 'undefined' || !window.document); var isWebWorker = !isBrowser && typeof importScripts !== 'undefined'; var readyRegExp = isBrowser && navigator.platform === 'PLAYSTATION 3' ? /^complete$/ : /^(complete|loaded)$/; var defContextName = '_'; var isOpera = typeof opera !== 'undefined' && opera.toString() === '[object Opera]'; var contexts = {}; var cfg = {}; var globalDefQueue = []; var useInteractive = !1; if (void 0 === define) { if (void 0 !== requirejs) { if (isFunction(requirejs)) return; cfg = requirejs, requirejs = void 0 } void 0 === require || isFunction(require) || (cfg = require, require = void 0), req = requirejs = function (e, t, i, r) { var n; var o; var a = defContextName; return isArray(e) || typeof e === 'string' || (o = e, isArray(t) ? (e = t, t = i, i = r) : e = []), o && o.context && (a = o.context), (n = getOwn(contexts, a)) || (n = contexts[a] = req.s.newContext(a)), o && n.configure(o), n.require(e, t, i) }, req.config = function (e) { return req(e) }, req.nextTick = void 0 !== setTimeout ? function (e) { setTimeout(e, 4) } : function (e) { e() }, require || (require = req), req.version = version, req.jsExtRegExp = /^\/|:|\?|\.js$/, req.isBrowser = isBrowser, s = req.s = { contexts: contexts, newContext: newContext }, req({}), each(['toUrl', 'undef', 'defined', 'specified'], function (e) { req[e] = function () { var t = contexts[defContextName]; return t.require[e].apply(t, arguments) } }), isBrowser && (head = s.head = document.getElementsByTagName('head')[0], (baseElement = document.getElementsByTagName('base')[0]) && (head = s.head = baseElement.parentNode)), req.onError = defaultOnError, req.createNode = function (e, t, i) { var r = e.xhtml ? document.createElementNS('http://www.w3.org/1999/xhtml', 'html:script') : document.createElement('script'); return r.type = e.scriptType || 'text/javascript', r.charset = 'utf-8', r.async = 'false', r }, req.load = function (e, t, i) { var r; var n = e && e.config || {}; if (isBrowser) return (r = req.createNode(n, t, i)).setAttribute('data-requirecontext', e.contextName), r.setAttribute('data-requiremodule', t), !r.attachEvent || r.attachEvent.toString && r.attachEvent.toString().indexOf('[native code') < 0 || isOpera ? (r.addEventListener('load', e.onScriptLoad, !1), r.addEventListener('error', e.onScriptError, !1)) : (useInteractive = !0, r.attachEvent('onreadystatechange', e.onScriptLoad)), r.src = i, n.onNodeCreated && n.onNodeCreated(r, n, t, i), currentlyAddingScript = r, baseElement ? head.insertBefore(r, baseElement) : head.appendChild(r), currentlyAddingScript = null, r; if (isWebWorker) try { setTimeout(function () {}, 0), importScripts(i), e.completeLoad(t) } catch (r) { e.onError(makeError('importscripts', 'importScripts failed for ' + t + ' at ' + i, r, [t])) } }, isBrowser && !cfg.skipDataMain && eachReverse(scripts(), function (e) { if (head || (head = e.parentNode), dataMain = e.getAttribute('data-main')) return mainScript = dataMain, cfg.baseUrl || mainScript.indexOf('!') !== -1 || (src = mainScript.split('/'), mainScript = src.pop(), subPath = src.length ? src.join('/') + '/' : './', cfg.baseUrl = subPath), mainScript = mainScript.replace(jsSuffixRegExp, ''), req.jsExtRegExp.test(mainScript) && (mainScript = dataMain), cfg.deps = cfg.deps ? cfg.deps.concat(mainScript) : [mainScript], !0 }), define = function (e, t, i) { var r, n; typeof e !== 'string' && (i = t, t = e, e = null), isArray(t) || (i = t, t = null), !t && isFunction(i) && (t = [], i.length && (i.toString().replace(commentRegExp, commentReplace).replace(cjsRequireRegExp, function (e, i) { t.push(i) }), t = (i.length === 1 ? ['require'] : ['require', 'exports', 'module']).concat(t))), useInteractive && (r = currentlyAddingScript || getInteractiveScript()) && (e || (e = r.getAttribute('data-requiremodule')), n = contexts[r.getAttribute('data-requirecontext')]), n ? (n.defQueue.push([e, t, i]), n.defQueueMap[e] = !0) : globalDefQueue.push([e, t, i]) }, define.amd = { jQuery: !0 }, req.exec = function (text) { return eval(text) }, req(cfg) } }(this, typeof setTimeout === 'undefined' ? void 0 : setTimeout))
function sk_preloadImages (e, t, n) { if (e && e.length > 0) for (var i = new Array(e.length), r = 0, o = function () { ++r == i.length && t && t(n) }, a = 0; a < e.length; a++)i[a] = new Image(), i[a].onload = o, i[a].onerror = o, i[a].src = e[a] ? e[a] : ''; else t && t(n) } function sk_getQueryParamByName (e, t, n) { e = e.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]'); var i = '[\\?&]' + e + '=([^&#]*)'; var r = new RegExp(i); var o = r.exec(n || window.location.href); return o == null ? t : decodeURIComponent(o[1].replace(/\+/g, ' ')) } function sk_includeJavaScript (e, t, n) { var i = document.createElement('script'); i.setAttribute('type', 'text/javascript'), i.setAttribute('src', removeProtocol(e)); var r = !1; i.onload = i.onreadystatechange = function () { r || this.readyState && this.readyState !== 'loaded' && this.readyState !== 'complete' || (r = !0, i.onload = i.onreadystatechange = null, t && t()) }, document.getElementsByTagName('head')[0].appendChild(i) } function sk_includeCssFile (e, t, n) { var i = document.createElement('link'); i.setAttribute('type', 'text/css'), i.setAttribute('rel', 'stylesheet'), i.setAttribute('href', removeProtocol(e)), document.getElementsByTagName('head')[0].appendChild(i) } function cloneObj (e) { return JSON.parse(JSON.stringify(e || null)) } function removeProtocol (e) { return e.indexOf('https://') == 0 && (e = '//' + e.substring(8)), e.indexOf('http://') == 0 && (e = '//' + e.substring(7)), e } function setSession (e, t) { if (e) try { sessionStorage.setItem(e, JSON.stringify(t)) } catch (e) { console.log('localstorage not available') } } function getSession (e) { var t = null; if (e) try { t = JSON.parse(sessionStorage.getItem(e) || null) } catch (e) { console.log('localstorage not available') } return t } function sksCalculateEventPosition (e, t) { var e = e || ''; var n = {}; var i = {}; i.width = e.naturalWidth ? e.naturalWidth : t.width, i.height = e.naturalHeight ? e.naturalHeight : t.height; var r = {}; return r.width = $(e).width() && $(e).width() != 0 ? $(e).width() : e.width && e.width != 0 ? e.width : 1, r.height = $(e).height() && $(e).height() != 0 ? $(e).height() : e.height && e.height != 0 ? e.height : 1, n.left = t.left * r.width / i.width, n.width = t.width * r.width / i.width, n.top = t.top * r.height / i.height, n.height = t.height * r.height / i.height, n } function redrawEvents (e, t) { var n = t != null ? parseInt(t) : 0; var i = e.getItemContainer() && e.getItemContainer().length > 0 ? e.getItemContainer()[n] : ''; var r = e.getHotspotContainer() && e.getHotspotContainer().length > 0 ? e.getHotspotContainer()[n] : ''; var o = r ? e.getImageInContainer(r)[0] : ''; var a = i ? $(i).closest('.lyt_cont_div') : ''; var s = e.widget && e.widget.items ? e.widget.items[n] : ''; if (s && s.events) { var c = function (e) { for (var t in e) if (e.hasOwnProperty(t)) { var n = e[t]; if (n.scope == SKRConstants.SCOPE_TYPE_SPECIFIC) { var r = sksCalculateEventPosition(o, n.eventArea); var s = $('.hotSpotOverlay.' + t, i); for (var u in r) if (r.hasOwnProperty(u)) { var l = r[u]; l += 'px', $(s).css(u, l) } } if (n.actions) for (var h = 0; h < n.actions.length; h++) { var d = n.actions[h]; if (d.action == SKRConstants.EVT_ACTION_SHOW_WIDGET) { var f = {}; f.left = d.overlayWidget.position.left, f.top = d.overlayWidget.position.top, f.width = d.overlayWidget.dimension.width, f.height = d.overlayWidget.dimension.height; var r = sksCalculateEventPosition(o, f); var g = d.params[5] == 'true' ? i : a; var p = $('.showWidgetCont.' + t + '_' + d.actionName, g); for (var u in r) if (r.hasOwnProperty(u)) { var l = r[u]; l += 'px', $(p).css(u, l) } } else if (d.action == SKRConstants.EVT_ACTION_SHOW_IMG_LAYER) { var r = sksCalculateEventPosition(o, d.overlayItem.position); var v = $('.showOverlayItemCont.' + t + '_' + d.actionName, i); for (var u in r) if (r.hasOwnProperty(u)) { var l = r[u]; l += 'px', $(v).css(u, l) } if (d.overlayItem.events) { var R = d.overlayItem.events; c(R) } } } } }; if (i && i != null) { var u = s.events; c(u) } } } function validateMacroValue (e) { return e && typeof e === 'string' && (e = e.replace(/\"/g, '\\"')), e }window.onerror = function (e) { console.log(e) }, Array.prototype.indexOf || (Array.prototype.indexOf = function (e) { var t = this.length >>> 0; var n = Number(arguments[1]) || 0; for (n = n < 0 ? Math.ceil(n) : Math.floor(n), n < 0 && (n += t); n < t; n++) if (n in this && this[n] === e) return n; return -1 }), Array.prototype.contains = function (e) { return this.indexOf(e) > -1 }, Array.prototype.intersect = function (e) { for (var t = [], n = 0; n < this.length; n++)e.contains(this[n]) && !t.contains(this[n]) && t.push(this[n]); return t }, Array.isArray || (Array.isArray = function (e) { return e instanceof Array }), Array.prototype.filter || (Array.prototype.filter = function (e) { 'use strict'; if (void 0 === this || this === null) throw new TypeError(); var t = Object(this); var n = t.length >>> 0; if (typeof e !== 'function') throw new TypeError(); for (var i = [], r = arguments.length >= 2 ? arguments[1] : void 0, o = 0; o < n; o++) if (o in t) { var a = t[o]; e.call(r, a, o, t) && i.push(a) } return i }), String.prototype.endsWith || (String.prototype.endsWith = function (e, t) { var n = this.toString(); (typeof t !== 'number' || !isFinite(t) || Math.floor(t) !== t || t > n.length) && (t = n.length), t -= e.length; var i = n.indexOf(e, t); return i !== -1 && i === t }), (function (e) { e.getOrigin = function () { return location.protocol + '//' + location.host }, e.getQueryStrings = function (t) { var n = {}; t = t || location.href; var i = t.indexOf('?'); if (i > -1) { var r = decodeURIComponent(t.substr(i + 1)); var o = r.split('&'); e.each(o, function (e, t) { if (t) { var i = t.split('='); n[i[0]] = i[1] } }) } return n }, e.buildQueryString = function (t, n) { var i = ''; if (!e.isEmptyObject(t)) { for (var r in t)t.hasOwnProperty(r) && (i += n ? encodeURIComponent(r) + '=' + encodeURIComponent(t[r]) + '&' : r + '=' + t[r] + '&'); i = i.substr(0, i.length - 1) } return i }, e.activePage = function () { var t = e('.scfPage.sks-page-active'); return t.length > 0 ? t : null }, e.documentReady = function (e, t) { if (e) { var n = null; var i = function () { document.readyState === 'complete' && (clearInterval(n), e && e()) }; document.readyState == 'complete' ? i() : n = setInterval(i, t || 500) } }, e.createDelegate = function (e, t, n) { return function () { try { var i = []; void 0 != n && (i = n.slice(0)); for (var r = 0; r < arguments.length; ++r)i.push(arguments[r]); return t.apply(e, i) } catch (e) { console.log('Exception from delegate :' + e.message); var o = e.stack || e.stacktrace || ''; console.log(o) } } }, e.isSameDomain = function (e) { var t = e && e.match(/(\/\/)[^\/]*/)[0]; return !(!t || !t.match(window.location.hostname)) }, e.loadRequiredFiles = function (t, n, i) { if (t && 'skReaderRequire' in window && typeof skReaderRequire === 'function') { var r = []; if (r = Array.isArray(t) ? t : typeof t === 'string' ? [t] : e.extendArray(t.js, t.css), i) { var o = readerObj.getCombinedResourceDomain(); if ('STUDIO_REQUIREJS_MODULE_ORDER' in window) { var a = []; var s = []; var c = []; var u = []; var l = ''; l = 'STUDIO_PRIMARY_READER_VERSION' in window && 'STUDIO_READER_TYPE' in window ? '&version=' + STUDIO_PRIMARY_READER_VERSION + '&readerType=' + STUDIO_READER_TYPE : '&version=' + STUDIO_READER_VERSION, e.each(r, function (e, t) { skReaderRequire.defined(t) || (STUDIO_REQUIREJS_MODULE_ORDER.js.indexOf(t) > -1 ? (a.push(t), c.push(STUDIO_REQUIREJS_MODULE_ORDER.js.indexOf(t))) : STUDIO_REQUIREJS_MODULE_ORDER.css.indexOf(t) > -1 && (s.push(t), u.push(STUDIO_REQUIREJS_MODULE_ORDER.css.indexOf(t)))) }), c.length > 0 ? (c = c.sort(function (e, t) { return e > t }), console.log('Combined JS modules: ', a, c, STUDIO_READER_VERSION), skReaderRequire(['require'], function (t) { t([SKRConstants.DYNAMIC_JS_CDN_URL.replace('<domain>', o ? '//' + o : '') + '?core=' + c.join(',') + l], function () { e.each(a, function (e, t) { define(t, [], function () {}) }), t(a, n) }) })) : n && n(), u.length > 0 && (u = u.sort(function (e, t) { return e > t }), console.log('Combined CSS modules: ', s, u, STUDIO_READER_VERSION), e.addStyleSheetTagForRequireJS(SKRConstants.DYNAMIC_CSS_CDN_URL.replace('<domain>', o ? '//' + o : '') + '?core=' + u.join(',') + l), skReaderRequire(['require'], function (t) { e.each(s, function (e, t) { require.s.contexts[STUDIO_REQUIREJS_CONTEXT_NAME].defined[t] = void 0 }) })) } else skReaderRequire(r, n) } else skReaderRequire(r, n) } else n && n() }, e.loadPluginRequiredFiles = function (e, t) { e && 'skReaderPluginRequire' in window && typeof skReaderPluginRequire === 'object' && (Array.isArray(e) ? skReaderPluginRequire.require(e, t) : typeof e === 'string' && skReaderPluginRequire.require([e], t)) }, e.extendArray = function () { var t = []; var n = []; return arguments.length > 0 && e.each(arguments, function (i, r) { Array.isArray(r) && e.each(r, function (e, i) { var r = null; r = typeof i === 'object' ? JSON.stringify(i) : i, n.contains(r) || (t.push(i), n.push(r)) }) }), t }, e.evalObject = function (t, n) { var i = null; if (t) { n = n || window; var r = t.split('.'); e.each(r, function (e, t) { if ((i = i == null ? n[t] : i[t]) == null) return !1 }) } return i }, e.hasPageMacro = function (e) { if (e) { var t = e.match(/\${pm\.(.*?)}/g); if (t && t.length > 0) return !0 } return !1 }, e.hasSnippetMacro = function (e) { if (e) { var t = e.match(/\${sn\.(.*?)}/g); if (t && t.length > 0) return !0 } return !1 }, e.applyPageMacro = function (e, t) { if (e && t) for (var n in t)t.hasOwnProperty(n) && (e = e.replace('${pm.' + n + '}', t[n])); return e }, e.updateQueryStringParameter = function (e, t, n) { if (e && t && n) { var i = new RegExp('([?&])' + t + '=.*?(&|$)', 'i'); var r = e.indexOf('?') !== -1 ? '&' : '?'; return e.match(i) ? e.replace(i, '$1' + t + '=' + n + '$2') : e + r + t + '=' + n } return e }, e.onOrientationChanged = function (t) { if (t) { void 0 !== (window.msMatchMedia || window.MozMatchMedia || window.WebkitMatchMedia || window.matchMedia) ? (window.matchMedia('(orientation: portrait)').addListener(function (e) { e.matches && t('portrait') }), window.matchMedia('(orientation: landscape)').addListener(function (e) { e.matches && t('landscape') })) : e(window).on('orientationchange', function (e) { window.setTimeout(function () { t(e.orientation) }, 300) }) } }, e.getDeviceOrientation = function () { return window.orientation ? window.orientation == -90 || window.orientation == 90 ? SKRConstants.ORIENTATION_LANDSCAPE : SKRConstants.ORIENTATION_PORTRAIT : window.matchMedia ? window.matchMedia('(orientation: landscape)').matches ? SKRConstants.ORIENTATION_LANDSCAPE : SKRConstants.ORIENTATION_PORTRAIT : null }, e.fn.moveAtIndex = function (e) { var t = this.parent().children().eq(e); return this.index() == e ? this : (this.index() > e ? t.before(this) : t.after(this), this) } }(jQuery)), typeof String.prototype.trim !== 'function' && (String.prototype.trim = function () { return this.replace(/^\s+|\s+$/g, '') })
'STUDIO_REQUIREJS_CONTEXT_NAME' in window || (window.STUDIO_REQUIREJS_CONTEXT_NAME = 'skReader'), $.addStyleSheetTagForRequireJS = function () { var e = document.getElementsByTagName('head').item(0); $.each(arguments, function (t, r) { if ($("link[data-requiremodule='" + r + "']").length == 0 && !skReaderRequire.defined(r)) { var i = document.createElement('link'); i.setAttribute('data-requiremodule', r), i.setAttribute('href', skReaderRequire.toUrl(r)), i.setAttribute('type', 'text/css'), i.setAttribute('rel', 'stylesheet'), e.appendChild(i) } }) }, (function () { var e = 'STUDIO_REQUIREJS_BASE_URL' in window ? STUDIO_REQUIREJS_BASE_URL : ''; var t = 'STUDIO_REQUIREJS_JS_PATHS_CONFIG' in window ? STUDIO_REQUIREJS_JS_PATHS_CONFIG : null; var r = 'STUDIO_REQUIREJS_CSS_PATHS_CONFIG' in window ? STUDIO_REQUIREJS_CSS_PATHS_CONFIG : null; var i = {}; window.skReaderRequire = require.config({ context: STUDIO_REQUIREJS_CONTEXT_NAME, baseUrl: e, paths: $.extend($.extend(t, r), i) }), skReaderRequire(['require'], function (e) { define('jQueryBxSliderCSS', [], $.createDelegate(this, $.addStyleSheetTagForRequireJS, ['jQueryBxSliderCSS'])) }), define.amd = null }()), require.onError = function (e) { throw console.log('Error on load modules: ', e.requireModules), e }
'STUDIO_PLUGINREQUIRE_CONTEXT_NAME' in window || (window.STUDIO_PLUGINREQUIRE_CONTEXT_NAME = 'skReaderPluginRequire'), (function () { skReaderPluginRequireClass = Class.extend({ setRequires: function (e, t, i) { var n = this; n.require = require.config(e), n.define = define, n.paths = e.paths, n.loadedRequires = t, n.require(['require'], function (u) { if ($.each(t, function (e, t) { n.define(t, [], null), n.define(t + '-css', [], null) }), e.paths && !$.isEmptyObject(e.paths)) { var r = 0; $.each(e.paths, function (t, u) { t.endsWith('-css') && !n.require.defined(t) && n.define(t, [], $.createDelegate(u, n.addStyleSheetTagForPluginRequire, [t])), ++r == Object.keys(e.paths).length && i && i() }) } else i && i() }) }, requireQueue: function (e, t) { function i (e, u) { e.length ? n.require([e.shift()], function (t) { u.push(t), i(e, u) }) : t && t.apply(null, u) } var n = this; i(e, []) }, addStyleSheetTagForPluginRequire: function (e) { var t = this; var i = document.getElementsByTagName('head').item(0); $("link[data-requiremodule='" + e + "']").length != 0 || typeof t !== 'object' || $.isEmptyObject(t) || $.each(t, function (t, n) { var u = document.createElement('link'); u.setAttribute('data-requiremodule', e), u.setAttribute('href', n), u.setAttribute('type', 'text/css'), u.setAttribute('rel', 'stylesheet'), i.appendChild(u) }) } }), window.skReaderPluginRequire = new skReaderPluginRequireClass() }())
var SKRConstants = {}; SKRConstants._CATALOG_DOWNLOAD_ERRCODE_NOTABLE_TODOWNLOAD_ = 0, SKRConstants._CATALOG_DOWNLOAD_ERRCODE_USER_CANCELLED_DOWNLOAD_ = 1, SKRConstants._CATALOG_DOWNLOAD_ERRCODE_USER_CANCELLED_UPDATE_ = 2, SKRConstants._CATALOG_DOWNLOAD_ERRCODE_ANOTHER_CATALOG_BEINGDOWNLOADED_ = 3, SKRConstants._CATALOG_DOWNLOAD_ERRCODE_NOCATALOG_TODOWNLOAD_ = 4, SKRConstants._CATALOG_DOWNLOAD_ERRCODE_NETWORK_ERROR_ = 6, SKRConstants.PINNED_ITEMS_LIMIT = 20, SKRConstants.SPREADOUT_HORZ_NAME = 'true', SKRConstants.SPREADOUT_VERT_NAME = 'false', SKRConstants.PARALLAX_HORZ_NAME = 'true', SKRConstants.PARALLAX_VERT_NAME = 'false', SKRConstants.PINNED_ITEM_SESSION_NAME = 'pinneditems', SKRConstants.PAGE_PARAMS_SESSION_NAME = 'pageparams', SKRConstants.STUDIO_PAGE_PREFIX_IDX = 'studiop', SKRConstants.HOMEPAGE_FACET_NAME = 'homepage', SKRConstants.TRANSITION_FACET_NAME = 'transition', SKRConstants.SITE_SEARCH_PARAM_FACET_NAME = 'site_search_param', SKRConstants.SITE_ENABLE_REQUIREJS_FACET_NAME = 'enableRequireJS', SKRConstants.SITE_COMBINED_REQUIREJS_FACET_NAME = 'combinedStudioResources', SKRConstants.SITE_COMBINED_RESOURCE_FACET_NAME = 'combinedCustomResources', SKRConstants.SITE_COMBINED_RESOURCE_DOMAIN_FACET_NAME = 'combinedResourceDomain', SKRConstants.SITE_NAME_RESTRICTION_FACET_NAME = 'skipSiteNameDomainRestriction', SKRConstants.SITE_WAIT_FOR_PAGE_DOM_READY_FACET_NAME = 'wairForPageDOMReady', SKRConstants.SITE_WAIT_FOR_PAGE_DOM_READY_FACET_NAME = 'waitForPageDOMReady', SKRConstants.SITE_DISABLE_DEFAULT_VIEWPORT_FACET_NAME = 'disableDefaultViewport', SKRConstants.HOME_PAGE_IDX = '', SKRConstants.OFFLINE_APP_DEFAULT_PARAMS = { t: '1' }, SKRConstants.PageLevelMacroOrderGetFirst = '0', SKRConstants.PageLevelMacroOrderCookieFirst = '1', SKRConstants.HEADER_WGET_IDX = 'headerw', SKRConstants.FOOTER_WGET_IDX = 'footerw', SKRConstants.MENU_WGET_IDX = 'menuw', SKRConstants.CATALOG_WGET_IDX = 'catalogw', SKRConstants.EMAILPINS_WGET_IDX = 'emailpinsw', SKRConstants.CONTACTUS_WGET_IDX = 'contactusw', SKRConstants.SUBHEADER_WGET_IDX = 'subheaderw', SKRConstants.HERO_WGET_IDX = 'herow', SKRConstants.PXP_WGET_IDX = 'pxpw', SKRConstants.LIST_WGET_IDX = 'listw', SKRConstants.GRID_WGET_IDX = 'gridw', SKRConstants.PXPCHILD_WGET_IDX = 'pxpchildw', SKRConstants.RICHTEXT_WGET_IDX = 'richtextw', SKRConstants.CUSTOM_WGET_IDX = 'customw', SKRConstants.EVENTS_WGET_IDX = 'eventsw', SKRConstants.MEDIA_WGET_IDX = 'mediaw', SKRConstants.SOCIAL_WGET_IDX = 'socialw', SKRConstants.INSTAGRAM_WGET_IDX = 'instagramw', SKRConstants.DYNAMIC_PXP_WGET_IDX = 'dynpxpw', SKRConstants.TEXT_LIST_WGET_IDX = 'textlistw', SKRConstants.SEARCH_WGET_IDX = 'searchw', SKRConstants.ACCORDION_WGET_IDX = 'accordionw', SKRConstants.TEMPLATE_WGET_IDX = 'templatew', SKRConstants.SLIDE_TRANSITION_TYPE = 'slide', SKRConstants.FADE_TRANSITION_TYPE = 'fade', SKRConstants.POP_TRANSITION_TYPE = 'pop', SKRConstants.FLIP_TRANSITION_TYPE = 'flip', SKRConstants.TURN_TRANSITION_TYPE = 'turn', SKRConstants.FLOW_TRANSITION_TYPE = 'flow', SKRConstants.SLIDEDOWN_TRANSITION_TYPE = 'slidedown', SKRConstants.SLIDEUP_TRANSITION_TYPE = 'slideup', SKRConstants.HERO_WIDGET = '1', SKRConstants.PXP_WIDGET = '2', SKRConstants.LIST_WIDGET = '3', SKRConstants.GRID_WIDGET = '4', SKRConstants.PXP_CHILD_WIDGET = '5', SKRConstants.RICH_TEXT_WIDGET = '6', SKRConstants.CUSTOM_WIDGET = '7', SKRConstants.INSTAGRAM_WIDGET = '8', SKRConstants.DYNAMIC_PXP_WIDGET = '9', SKRConstants.TEXT_LIST_WIDGET = '10', SKRConstants.SEARCH_WIDGET = '11', SKRConstants.ACCORDION_WIDGET = '12', SKRConstants.TEMPLATE_WIDGET = '14', SKRConstants.EVT_TYPE_HOVER = '9', SKRConstants.SCOPE_TYPE_SPECIFIC = '2', SKRConstants.EVT_ACTION_SHOW_WIDGET = '1', SKRConstants.EVT_ACTION_SHOW_IMG_LAYER = '6', SKRConstants.GET_CATALOG_URL = 'http://<domain>/skavastream/studio/v1/skava/getCatalog/<campaignId>/<version>', SKRConstants.GET_PAGES_URL = 'http://<domain>/skavastream/studio/v1/skava/getPages/<campaignId>/<version>/<pageId>/<deviceName>', SKRConstants.EMAIL_IMG_PATH_PREFIX = 'http://' + document.domain, SKRConstants.GET_POOL_ENTRIES_URL = 'http://<domain>/social/entry/getSimplePoolEntries?campaignId=<campaignId>&offset=<offset>&limit=<limit>&poolName=<poolName>', SKRConstants.INSTAGRAM_ENTRIES_URL = '/social/entry/getCampaignEntries?campaignId=<campaignId>&offset=0&limit=<limit>&filter={"operations":[[{"property":"ct_prop_2","value":"4","operator":"EQUALS"}]]}', SKRConstants.GET_FACET_URL = 'http://<domain>/skavastream/studio/v1/skava/getFacets/<campaignId>/<version>/<view>', SKRConstants.NativeGetCatalogURL = 'skava://getcatalog?partner=<partner>&catalogid=<catalogid>&jscallback=ReaderHybridApp_nativeCallback', SKRConstants.NativeShowAlertURL = 'skava://showAlert?message=<msg>&cancelButton=<btnText>', SKRConstants.OfflineAnalyticsURL = 'http://<domain>/skavastream/studio/trackoffline.jsp', SKRConstants.LOAD_PAGE_URL = '//<domain>/skavastream/semantic/studio/loadPage/', SKRConstants.LOAD_WIDGET_URL = '//<domain>/skavastream/studio/loadWidget', SKRConstants.DYNAMIC_JS_CDN_URL = '<domain>/skavastream/studio/loadJSModules', SKRConstants.DYNAMIC_CSS_CDN_URL = '<domain>/skavastream/studio/loadCSSModules', SKRConstants.FILETYPE_JS = 'JS', SKRConstants.FILETYPE_CSS = 'CSS', SKRConstants.FILE_SCOPE_GLOBAL = 'global', SKRConstants.FILE_SCOPE_EXTVIEWS = 'extViewLevel', SKRConstants.HEADER_EL_ID = 'id_scfHeader', SKRConstants.FOOTER_EL_ID = 'id_scfFooter', SKRConstants.READER_OFFLINE_DATA_JSONP_CALLBACK = 'sksReaderJsonpCallback', SKRConstants.APP_READY_EVT = 'readerAppReady', SKRConstants.CAMPAIGN_READY_EVT = 'readerCampaignReady', SKRConstants.READERPAGE_READY_EVT = 'readerPageReady', SKRConstants.READERPAGE_BEFORELOAD_EVT = 'readerPageBeforeLoad', SKRConstants.READERPAGE_LOAD_EVT = 'readerPageLoad', SKRConstants.READERPAGE_BEFORECHANGE_EVT = 'readerPageBeforeChange', SKRConstants.READERPAGE_CHANGE_EVT = 'readerPageChange', SKRConstants.READERPAGE_BEFORESHOW_EVT = 'readerPageBeforeShow', SKRConstants.READERPAGE_SHOW_EVT = 'readerPageShow', SKRConstants.READERPAGE_BEFORECREATE_EVT = 'readerPageBeforeCreate', SKRConstants.READERPAGE_CREATE_EVT = 'readerPageCreate', SKRConstants.SHOW_CUSTOM_WIDGET_EVT = 'showCustomWidget', SKRConstants.READER_PIN_UPDATE_EVT = 'readerPinUpdate', SKRConstants.SHOW_IMAGE_REFERENCE = 'showImageReference', SKRConstants.READER_TEMPLATE_RENDERED_EVT = 'readerTemplateRendered', SKRConstants.READER_WIDGET_LOAD_EVT = 'readerWidgetLoad', SKRConstants.READER_WIDGET_READY_EVT = 'readerWidgetReady', SKRConstants.READER_WIDGET_LOAD_ERROR = 'readerWidgetLoadError', SKRConstants.READER_ANALYTICS_TRACK_PAGEVIEW = 'readerAnalyticsTrackPageView', SKRConstants.READER_ANALYTICS_TRACK_EVENT = 'readerAnalyticsTrackEvent', SKRConstants.ANALYTICS_READY_EVT = 'readerAnalyticsReady', SKRConstants.SUCCESS_RESPONSE_CODE = 0, SKRConstants.CUSTOM_WIDGET_AJAX_TIMEOUT = 3e4, SKRConstants.REQUIREJS_TIMEOUT = 60, SKRConstants.PAGE_READY_INTERVAL = 500, SKRConstants.OFFLINE_CATALOG_URL = 'catalog/result/studio.js', SKRConstants.OFFLINE_CATALOG_PAGE_URL = 'catalog/result/<pageName>.js', SKRConstants.FOOTER_NAVI_TIME_INTERVAL = '3000', SKRConstants.MEDIA_TYPE_IMAGE = '1', SKRConstants.MEDIA_TYPE_YOUTUBE = '2', SKRConstants.MEDIA_TYPE_OTHER = '3', SKRConstants.AUTOSCROLL_EFFECT_NONE = '1', SKRConstants.AUTOSCROLL_EFFECT_FADE_IN = '2', SKRConstants.AUTOSCROLL_EFFECT_FADE_OUT = '3', SKRConstants.AUTOSCROLL_EFFECT_SLIDE_DOWN = '4', SKRConstants.AUTOSCROLL_EFFECT_SLIDE_UP = '5', SKRConstants.AUTOSCROLL_EFFECT_SLIDE_LEFT = '6', SKRConstants.AUTOSCROLL_EFFECT_SLIDE_RIGHT = '7', SKRConstants.AUTOSCROLL_EFFECT_FLIP = '8', SKRConstants.QUERY_PARAM_TRIGGER_EVENTS = 'trigger', SKRConstants.DEEPLINK_WIDGETNAME_DELIMITER = '~', SKRConstants.MSG_PAGE_NOT_AVAILABLE = 'The Page you are trying to open is currently not available. Please try again later', SKRConstants.WIDGET_TRANSITION_SLIDE_LEFT = 'slideleft', SKRConstants.WIDGET_TRANSITION_SLIDE_RIGHT = 'slideright', SKRConstants.WIDGET_TRANSITION_SLIDE_UP = 'slideup', SKRConstants.WIDGET_TRANSITION_SLIDE_DOWN = 'slidedown', SKRConstants.WIDGET_TRANSITION_FADE = 'fade', SKRConstants.WIDGET_TRANSITION_POP = 'pop', SKRConstants.WIDGET_TRANSITION_FLIP = 'flip', SKRConstants.WIDGET_TRANSITION_NONE = 'none', SKRConstants.ANCHOR_TRANSITION_EFFECT_NONE = 'none', SKRConstants.ANCHOR_TRANSITION_EFFECT_FLIP = 'flip', SKRConstants.SEARCH_TYPE_GRID = 'grid', SKRConstants.default_prop_CssHover_Old = '{ "border" : "2px solid blue" }', SKRConstants.default_prop_CssHover = '{ "box-shadow" : "0 0 0 2px blue inset" }', SKRConstants.default_prop_CssPress = '{ "background" : "green", "opacity" : "0.5" }', SKRConstants.ViewStandAlone = '0', SKRConstants.ViewInsideIframe = '1', SKRConstants.ViewFullHeight = '0', SKRConstants.ViewFixedHeight = '1', SKRConstants.PageMaintainByWidget = '1', SKRConstants.PageMaintainByPixel = '2', SKRConstants.PageMaintainNoPosition = '', SKRConstants.NoDataFound = 'No data available.', SKRConstants.TemplateMacro = '####TEMPLATE_WIDGET_CONTENT_<cellId>####', SKRConstants.ErrorLoadingPluginAPI = 'Error in loading widget API', SKRConstants.LOCAL_FILE_BASEPATH = 'localFileBasePath', SKRConstants.FILE_BASEPATH = 'fileBasePath', SKRConstants.Environments = {}, SKRConstants.Environments.DEV = 'dev', SKRConstants.Environments.PREPROD = 'preprod', SKRConstants.Environments.STG = 'stg', SKRConstants.Environments.PROD = 'prod', SKRConstants.ORIENTATION_PORTRAIT = 'portrait', SKRConstants.ORIENTATION_LANDSCAPE = 'landscape'
!(function () { HttpService = Class.extend({ init: function (e) { var t = this; t.isOffline = !!e && e.offline, t.jsonpCallbacks = {} }, get: function (e, t, n, o, r, a, l) { if (this.isOffline)$.ajax({ cache: r || 'false', type: t || 'GET', url: e, dataType: o || 'json', success: function (e) { a(e) }, error: function () { l && l() } }); else if (window.XDomainRequest && !$.isSameDomain(e)) { var s = new XDomainRequest(); s ? (s.open('get', e), s.onerror = function () { l() }, s.onload = function () { a(s.responseText) }, s.onprogress = function () {}, s.ontimeout = function () {}, s.onerror = function () {}, setTimeout(function () { s.send() }, 0)) : alert('Failed to create new XDR object.') } else $.get(e, a).error(function () { l && l() }) }, getJsonp: function (e) { function t (e, t, n, o) { $.ajax.handleError ? $.ajax.handleError(e, t, n, o) : $.handleError && $.handleError(e, t, n, o) } var n = { dataType: 'jsonp' }; n = $.extend(n, e); var o = $.ajax(n); var r = $(document.getElementsByTagName('head')[0].firstChild); var a = r.attr('src') || ''; var l = null; if (n.jsonpCallback)l = n.jsonpCallback; else { var s = $.getQueryStrings(a); l = s[n.jsonp || 'callback'] } if (l) { var i = 0; var c = window[l]; if (r[0].onerror = function (e) { n.error && n.error(o), $(r).remove(), t(n, {}, 'error', e), clearTimeout(i) }, n.timeout) return window[l] = function (e) { clearTimeout(i), c(e), c = null }, i = setTimeout(function () { $(r).remove(), t(n, {}, 'timeout'), c && (window[l] = function () {}) }, n.timeout), o } }, getJsonpScript: function (e) { var t = this; var n = $.extend({ url: null, jsonp: 'callback', jsonpCallback: 'sksReader_' + (new Date()).getTime(), timeout: 3e4, cache: !1, $script: null, aborted: !1, success: null, error: null, abort: function () {} }, e); if (!n.url) return console.log('Failed to load url in getJsonpScript method:', n), n; var o = $.getQueryStrings(n.url); var r = o[n.jsonp]; var a = n.url.indexOf('?'); r ? n.jsonpCallback = r : (n.url += (a > -1 ? '&' : '?') + n.jsonp + '=' + n.jsonpCallback, a = 0), n.cache || (n.url += (a > -1 ? '&' : '?') + '_=' + (new Date()).getTime()); var l = document.createElement('script'); l.setAttribute('src', n.url), l.setAttribute('type', 'text/javascript'), l.setAttribute('charset', 'UTF-8'), n.$script = l, n.abort = function () { console.log('Aborted in getJsonpScript method'), n.aborted = !0 }; var s = function (e, n) { n || t.jsonpCallbacks[e].splice(0, 1), t.jsonpCallbacks[e][0] && (function (e) { var t = document.getElementsByTagName('head').item(0); var n = null; var o = function (t) { clearTimeout(n), window[e.jsonpCallback] = function () {}, $(e.$script).remove(), e.aborted || e.success && e.success.apply(this, arguments), s(e.jsonpCallback, !1) }; var r = function (t) { console.log('Error on getJsonpScript method:', arguments, e), clearTimeout(n), window[e.jsonpCallback] = function () {}, $(e.$script).remove(), s(e.jsonpCallback, !1), e.error && (e.error.apply(this, arguments), e.error = null) }; var a = !1; e.$script.onload = e.$script.onreadystatechange = function () { a || this.readyState && this.readyState !== 'loaded' && this.readyState !== 'complete' || (a = !0, e.$script.onload = e.$script.onreadystatechange = null) }, e.$script.onerror = r, window[e.jsonpCallback] = o, e.timeout && (n = setTimeout(function () { e.aborted = !0, r() }, e.timeout)), t.appendChild(e.$script) }(t.jsonpCallbacks[e][0])) }; return t.jsonpCallbacks[n.jsonpCallback] || (t.jsonpCallbacks[n.jsonpCallback] = []), t.jsonpCallbacks[n.jsonpCallback].push(n), t.jsonpCallbacks[n.jsonpCallback].length == 1 && s(n.jsonpCallback, !0), n } }) }())
function FacetFilter (t) { t && this.setOperations(t) }FacetFilter.prototype.operations, FacetFilter.prototype.setOperations = function (t) { this.operations = []; for (var e in t) if (t.hasOwnProperty(e)) { this.operations[e] = []; for (var o in t[e])t[e].hasOwnProperty(o) && (this.operations[e][o] = new FacetFilterOperation(t[e][o])) } }, FacetFilter.prototype.matches = function (t, e) { var o = !1; var i = !0; if (this.operations != null && this.operations.length > 0) for (var r = 0; r < this.operations.length; r++) if (this.operations[r] != null && this.operations[r].length > 0) { for (var n = !1, s = 0; s < this.operations[r].length && !(n = n || this.operations[r][s].matches(t, e)); s++);if (i = i && n, o = !0, !i) break } return o || (i = !1), i }
function FacetFilterOperation (e) { this.property = e.property, this.value = e.value, this.values = e.values, this.valueToLowerCase = e.value ? e.value.toLowerCase() : null, this.operator = e.operator }FacetFilterOperation.prototype.property, FacetFilterOperation.prototype.value, FacetFilterOperation.prototype.valueToLowerCase, FacetFilterOperation.prototype.values, FacetFilterOperation.prototype.operator, FacetFilterOperation.prototype.OPERATOR_EQUALS = 'EQUALS', FacetFilterOperation.prototype.OPERATOR_CONTAINS = 'CONTAINS', FacetFilterOperation.prototype.OPERATOR_NOTCONTAINS = 'NOTCONTAINS', FacetFilterOperation.prototype.OPERATOR_MATCHES = 'MATCHES', FacetFilterOperation.prototype.OPERATOR_BETWEEN = 'BETWEEN', FacetFilterOperation.prototype.OPERATOR_LESSTHAN = 'LESSTHAN', FacetFilterOperation.prototype.OPERATOR_GREATERTHAN = 'GREATERTHAN', FacetFilterOperation.prototype.OPERATOR_NOTEQUALS = 'NOTEQUALS', FacetFilterOperation.prototype.OPERATOR_ISNULL = 'ISNULL', FacetFilterOperation.prototype.OPERATOR_ISNOTNULL = 'ISNOTNULL', FacetFilterOperation.prototype.OPERATOR_STR_CONTAINS = 'STRCONTAINS', FacetFilterOperation.prototype.setValue = function (e) { this.value = e, this.valueToLowerCase = e ? e.toLowerCase() : null }, FacetFilterOperation.prototype.matches = function (e, t) { var r = !1; try { if (e != null) { var a = e[this.property]; var o = this.operator || this.OPERATOR_EQUALS; if (o.toUpperCase() == this.OPERATOR_EQUALS || o.toUpperCase() == this.OPERATOR_NOTEQUALS)r = this.value == a, o.toUpperCase() == this.OPERATOR_NOTEQUALS && (r = !r); else if (o.toUpperCase() == this.OPERATOR_CONTAINS || o.toUpperCase() == this.OPERATOR_NOTCONTAINS) { if (a != null) if (this.value != null && this.value.indexOf('[') != -1 && this.value.indexOf(']') != -1 && a.indexOf('[') != -1 && a.indexOf(']') != -1)r = a.indexOf(this.value) != -1; else for (var i = a.split(','), O = 0; O < i.length; O++) if (i[O].toUpperCase() == this.value) { r = !0; break }o.toUpperCase() == this.OPERATOR_NOTCONTAINS && (r = !r) } else if (o.toUpperCase() == this.OPERATOR_STR_CONTAINS && t)a != null && this.value != null && (r = a.toLowerCase().indexOf(this.valueToLowerCase) != -1); else if (o.toUpperCase() == this.OPERATOR_ISNULL || o.toUpperCase() == this.OPERATOR_ISNOTNULL)r = a == null, o.toUpperCase() == this.OPERATOR_ISNOTNULL && (r = !r); else if (o.toUpperCase() == this.OPERATOR_MATCHES)(r = this.value == a) || this.value == null || a == null || (r = a.match(this.value)); else if (o.toUpperCase() == this.OPERATOR_BETWEEN) { var p = this.values[0] || 0; var l = this.values[1] || 0; var s = a; r = s >= p && s <= l } else if (o.toUpperCase() == this.OPERATOR_LESSTHAN) { var T = this.value || 0; var s = a || 0; r = s < T } else if (o.toUpperCase() == this.OPERATOR_GREATERTHAN) { var T = this.value || 0; var s = a || 0; r = s > T } } } catch (e) { r = !1 } return r }
!(function () {
  SksReader = Class.extend({ init: function () { this.isWebApp = !1, this.CAMPAIGN_ID = null, this.catalog = null, this.pageData = null, this.pageParams = {}, this.currentPage = null, this.studioPageObj = null, this.studioPages = {}, this.viewName = null, this.httpService = null, this.analyticsObj = null, this.analyticsReady = !1, this.pluginResourcesLoaded = !1, this.isPageNavigating = !1, this.pageMacroCache = {}, this.jsonpCallbacks = {}, this.pluginWidgetResourceMap = {}, this.pluginWidgetShimConfig = {}, this.pluginWidgetBasePath = {}, this.loadedPluginId = []; var e = navigator.userAgent.toLowerCase(); this.iosTouch = e.indexOf('ipad') != -1 || e.indexOf('iphone') != -1 || e.indexOf('iPod') != -1, this.isIPad = e.indexOf('ipad') != -1, this.isMobile = e.indexOf('iphone') != -1 || e.indexOf('iPod') != -1 || e.indexOf('android') != -1 && e.indexOf('mobile') != -1, this.isIPhone = e.indexOf('iphone') != -1 || e.indexOf('iPod') != -1, this.isAndroid = e.indexOf('android') != -1, this.isAndroid && (this.androidVersion = e.match(/android\s([0-9\.]*)/)[1]), this.isBlackBerry = e.indexOf('blackberry') != -1 || e.indexOf('bb10') != -1 || e.indexOf('playbook') != -1, this.isIEBrowser = !!(navigator.userAgent.indexOf('MSIE') > 0 || navigator.userAgent.match(/Trident.*rv[ :]*11\./)) },
    initApp: function (e) { STUDIO_PAGE_DATA && STUDIO_PAGE_DATA.cells && $.each(STUDIO_PAGE_DATA.cells, function (e, a) { if (a.widget && a.widget.properties && a.widget.properties.customizeWidget) { var t = JSON.parse(a.widget.properties.customizeWidget); t.css && $('<style>' + t.css + '</style>').appendTo('head') } }); var a = this; a.setViewName(STUDIO_CURRENT_VIEW != 'null' ? STUDIO_CURRENT_VIEW : null), e.CAMPAIGN_ID && (a.CAMPAIGN_ID = e.CAMPAIGN_ID), e.IS_DV && setInterval(function () { $.ajax({ url: '/u-route/baas/sys/v1.0/verify', method: 'GET' }) }, 12e4), 'HttpService' in window && (a.httpService = new HttpService()), $('body').addClass(a.isMobile ? 'skMobile' : ''), $('body').addClass(a.isIEBrowser ? 'IEBrowser' : ''), a.getCatalogData(function (e) { a.setupReader(function () { a.appReadyEvent(function () { 'SksReaderAnalytics' in window && (a.analyticsObj = new SksReaderAnalytics(e.analyticsProperties, e.streamDomain)); var t = function () { a.analyticsReadyEvent(function () { var e = a.getCurrentPageId(); a.pageBeforeLoadEvent(function () { a.loadPage() }, { pageId: e, pageUri: ROOT_PAGE_URL, params: a.getPageParams(), viewName: a.viewName, pageEl: $(".scfPage[data-pageid='" + e + "']"), pageData: a.pageData }) }) }; a.analyticsObj ? a.analyticsObj.initTracking(t) : t() }) }) }), a.handleWindowResize() },
    setupReader: function (e) { var a = this; var t = $.getQueryStrings(); a.setPageParams(t), a.pageData = a.replacePageLevelMacros($.extend({ facets: a.catalog.pages[STUDIO_PAGE_DATA.pageId].facets, pageLevelMacro: STUDIO_PAGE_LEVEL_MACRO }, STUDIO_PAGE_DATA)), e && e() },
    navToPageById: function (e, a, t, n, i) { var r = this; var o = r.getPageUrlByPageId(e); var s = null; if ($.hasPageMacro(o)) { var l = r.getDefaultPageLevelMacroByPageId(e); l = $.extend(l, t), s = { pageMacros: l }, o = $.applyPageMacro(o, l) } var g = $.extend({}, a); r.navigateTo(e, o, g, s, n, i) },
    navToPageByUrl: function (e, a, t, n) { var i = this; var r = e; var o = $.extend({}, a); for (var s in o)o.hasOwnProperty(s) && (r = r.replace('<' + s + '>', o[s])); var l = i.getPageByPageUrlPattern(r); var g = l.pageId; var c = l.pageMacros; g ? i.navigateTo(g, r, o, c, t, n) : console.log('Invalid PageId: ' + g + ' PageUrl: ' + r) },
    gotoHomePage: function (e, a, t) { SKRConstants.HOME_PAGE_IDX != null && this.navToPageById(SKRConstants.HOME_PAGE_IDX, e, a, t) },
    navToWidget: function (e, a) { var t = this; !(function () { if (e) if (e = e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g, '\\$&'), t.studioPageObj.pageiScrollObj) { var a = $('.' + e).attr('id'); t.studioPageObj.pageiScrollObj.scrollToElement('#' + a, 0) } else { var n = $('.skc_pageCellLayout.' + e, $.activePage).offset(); var i = n ? n.top : 0; var r = n ? n.left : 0; window.scrollTo(r, i) } }()) },
    navigateTo: function (e, a, t, n, i, r) { var o = this; var s = o.getSiteFacetByName('encodePageParams') == 'true'; o.setPageNavigating(!0), o.pageBeforeChangeEvent(function () { var n = $.buildQueryString(t, s); var o = SITE_ROOT_PATH + '/' + a + (n ? '?' + n : ''); var l = null; if (i && (i.widgetName && (o += '~' + i.widgetName), i.protocol && (l = i.protocol || null)), !l || l != 'http' && l != 'https') { var g = readerObj.getPageFacetByName(e, 'allowHttpsOnly'); g == null || g != 1 && g.toLowerCase() != 'true' ? r == 11 || r == 10 ? window.open(o) : window.location = o : r == 11 || r == 10 ? window.open('https://' + location.host + o) : window.location = 'https://' + location.host + o } else r == 11 || r == 10 ? window.open(l + '://' + location.host + o) : window.location = l + '://' + location.host + o }, { pageId: e, pageUri: a, params: t, macros: n }) },
    loadPage: function () { var e = this; var a = e.getCurrentPageId(); var t = ROOT_PAGE_URL; var n = e.pageData; var i = e.getPageParams(); var r = $(".scfPage[data-pageid='" + a + "']"); var o = { pageUri: t }; var s = { pageId: a, pageUri: t, viewName: e.viewName, pageEl: r, pageData: n, params: i }; var l = $.getDeviceOrientation(); e.onOrientationChanged(l), e.pageBeforeShowEvent(function () { $('.scfPage.sks-page-active').removeClass('sks-page-active'), r.addClass('sks-page-active'), e.makeCenterPage(a), e.loadPageEvent(function () { e.studioPageObj = new SksReaderPage(n, i, o), e.studioPageObj.renderPage() }, s) }, s) },
    setViewName: function (e) { this.viewName = e },
    getViewName: function () { return this.viewName },
    getCatalogData: function (e) { var a = this; if (a.catalog)e && e(a.catalog); else { if (a.catalog = STUDIO_DATA, STUDIO_VERSION = STUDIO_VERSION || a.catalog.version, !SKRConstants.HOME_PAGE_IDX) { var t = [[{ property: SKRConstants.HOMEPAGE_FACET_NAME, value: 'true', operator: 'EQUALS' }]]; var n = a.findPage(t); for (var i in n)n.hasOwnProperty(i) && (SKRConstants.HOME_PAGE_IDX = i) }SKRConstants.HOME_PAGE_IDX || (SKRConstants.HOME_PAGE_IDX = '1'); var r = a.catalog.pluginIncludes; var o = !1; var s = []; var l = []; var g = a.catalog.pages[STUDIO_PAGE_DATA.pageId].facets; var c = a.getSiteFacetByName('supportClientInclude') == 'true'; var d = a.getSiteFacetByName(SKRConstants.SITE_COMBINED_RESOURCE_FACET_NAME) == 'true'; var u = -1; var p = -1; g.supportClientInclude && (u = g.supportClientInclude == 'true' ? 1 : 0), g[SKRConstants.SITE_COMBINED_RESOURCE_FACET_NAME] && (p = g[SKRConstants.SITE_COMBINED_RESOURCE_FACET_NAME] == 'true' ? 1 : 0); var f = a.catalog.rawIncludes || []; var h = f.length; var v = {}; a.themeWidgetPlugin = v; for (var P = 0; P < h; P++) { var m = f[P]; if (m.pluginInfo && m.pluginInfo.domainType == 'theme') { var y = m.pluginInfo; var E = JSON.parse(y.pluginDetails); var I = E.fileUrls; var S = E.filePackageInfo; var A = E.fileBasePath; if (S && S.template) { (S.template || []).forEach(function (e) { var a = e.widget; if (a) { v[a] = {}; var t = A + 'template/' + a + '/' + a + '.css'; I.indexOf(t) > 0 && (a = a.replace(/_/g, ''), v[a] = t) } }) } break } } for (var C in r) if (r.hasOwnProperty(C)) { var _ = r[C]; if (_ && _.filePackageInfo && _.fileBasePath && _.fileName && _.fileUrls) { var O = STUDIO_VERSION; if (_.filePackageInfo.widgetApi) for (var R = 0; R < _.filePackageInfo.widgetApi.length; R++) if (_.filePackageInfo.widgetApi[R].name) { var T; var b = _.filePackageInfo.widgetApi[R].name; var k = _.fileBasePath + b + '.js'; var w = b.substr(b.indexOf('_') + 1); T = a.themeWidgetPlugin[w] && a.themeWidgetPlugin[w] ? a.themeWidgetPlugin[w] : _.fileBasePath + b + '.css', O == SKRConstants.Environments.DEV && _.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH] ? a.pluginWidgetBasePath[b] = _.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH] : a.pluginWidgetBasePath[b] = _[SKRConstants.FILE_BASEPATH], _.fileUrls.indexOf(k) > -1 && (a.pluginWidgetResourceMap[b] = [], O == SKRConstants.Environments.DEV && _.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH] ? a.pluginWidgetResourceMap[b].push(removeProtocol(_.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH]) + b) : a.pluginWidgetResourceMap[b].push(removeProtocol(_[SKRConstants.FILE_BASEPATH]) + b), o = !0), (_.fileUrls.indexOf(T) > -1 || a.themeWidgetPlugin[w]) && (a.pluginWidgetShimConfig[b] || (a.pluginWidgetShimConfig[b] = {}, a.pluginWidgetShimConfig[b].deps = []), a.pluginWidgetResourceMap[b + '-css'] = [], O == SKRConstants.Environments.DEV && _.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH] && !a.themeWidgetPlugin[w] ? (a.pluginWidgetResourceMap[b + '-css'].push(removeProtocol(_.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH] + b + '.css') + '?_=' + Date.now()), a.pluginWidgetShimConfig[b].deps.push(b + '-css')) : (a.pluginWidgetResourceMap[b + '-css'].push(removeProtocol(T)), a.pluginWidgetShimConfig[b].deps.push(b + '-css'))) } if (_.filePackageInfo.eventApi) for (var L = !!readerObj.eventApiPlugins, D = readerObj.eventApiPlugins, N = function (e) { var a = _.fileBasePath + e + '.js'; if (_.fileUrls.indexOf(a) > -1) { var t = {}; O == SKRConstants.Environments.DEV && _.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH] ? t.fileURL = removeProtocol(_.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH]) + e + '.js' : t.fileURL = removeProtocol(_[SKRConstants.FILE_BASEPATH]) + e + '.js', t.fileType = 'JS', s.push(t) } }, R = 0; R < _.filePackageInfo.eventApi.length; R++) { var M = _.filePackageInfo.eventApi[R].name; M && (L ? D.indexOf(M) != -1 && N(M) : N(M)) } if (_.filePackageInfo.connectorApi) for (var L = !!readerObj.connectorApiPlugins, U = readerObj.connectorApiPlugins, B = function (e, a) { var t = e.filePackageInfo.connectorApi[a].name; var n = e.filePackageInfo.connectorApi[a].model; if (t) { var i = _.fileBasePath + t + '.js'; if (_.fileUrls.indexOf(i) > -1) { var r = {}; O == SKRConstants.Environments.DEV && _.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH] ? r.fileURL = removeProtocol(_.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH]) + t + '.js' : r.fileURL = removeProtocol(_[SKRConstants.FILE_BASEPATH]) + t + '.js', r.fileType = 'JS', s.push(r) } } if (n) { var o = _.fileBasePath + n + '.js'; if (_.fileUrls.indexOf(o) > -1) { var r = {}; O == SKRConstants.Environments.DEV && _.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH] ? r.fileURL = removeProtocol(_.filePackageInfo[SKRConstants.LOCAL_FILE_BASEPATH]) + n + '.js' : r.fileURL = removeProtocol(_[SKRConstants.FILE_BASEPATH]) + n + '.js', r.fileType = 'JS', l.push(r) } } }, R = 0; R < _.filePackageInfo.connectorApi.length; R++) { var W = _.filePackageInfo.connectorApi[R].name; W && (L ? U.indexOf(W) != -1 && B(_, R) : B(_, R)) } } } var j = function () { if (p == 1 || d && p == -1 || u == 1 || c && u == -1)e && e(a.catalog); else { var t = function () { var t = function () { e && e(a.catalog) }; s.length > 0 ? a.loadPluginResources(s, function () { t() }) : t() }; l.length > 0 ? a.loadPluginResources(l, t) : t() } }; if (o && typeof require === 'function' && typeof skReaderPluginRequire === 'object') { var x = { context: 'skReaderPluginRequire', paths: a.pluginWidgetResourceMap, waitSeconds: SKRConstants.REQUIREJS_TIMEOUT }; a.pluginWidgetShimConfig && !$.isEmptyObject(a.pluginWidgetShimConfig) && (x.shim = a.pluginWidgetShimConfig), skReaderPluginRequire.setRequires(x, $.merge(a.loadedPlugins || [], a.loadedPluginRequires || []), j) } else j() } },
    getCatalog: function () { return this.catalog || null },
    getCurrentPage: function () { return this.pageData },
    getRawPageData: function () { return this.pageData },
    getCatalogName: function () { return this.catalog ? this.catalog.catalogName : null },
    getPageNameById: function (e) { var a = this; var t = ''; return a.catalog && a.catalog.pages && a.catalog.pages[e] && (t = a.catalog.pages[e].pageName), t },
    getWidgetDataFromLibrary: function (e) { return 'STUDIO_WIDGET_LIB_DATA' in window ? STUDIO_WIDGET_LIB_DATA[e] : null },
    getStreamDomain: function () { if (this.catalog) return this.catalog.streamDomain },
    getCombinedResourceDomain: function () { var e = this.getSiteFacetByName(SKRConstants.SITE_COMBINED_RESOURCE_DOMAIN_FACET_NAME); var a = this.getSiteFacetByName(SKRConstants.SITE_NAME_RESTRICTION_FACET_NAME); return e || a && a.length > 0 && a.toLowerCase() == 'true' || (e = this.getStreamDomain()), e },
    getPageIdByName: function (e) { var a = this; var t = ''; return a.catalog && a.catalog.pages && $.each(a.catalog.pages, function (a, n) { if (n.pageName == e) return t = a, !1 }), t },
    getSiteFacetByName: function (e) { var a = null; return this.catalog && this.catalog.catalogFacets && (a = this.catalog.catalogFacets[e]), a },
    getResourceHash: function () { return this.catalog.resourceHash },
    getPageFacetByName: function (e, a) { var t = null; return this.catalog.pages && this.catalog.pages[e] && this.catalog.pages[e].facets && (t = this.catalog.pages[e].facets[a]), t },
    getItemFacetsByCellId: function (e, a) { var t = this; if (t.studioPageObj) { var n = t.studioPageObj.getAllWidgetList(); if (n[e] && n[e].items && n[e].items[a]) return n[e].items[a].facets || null } return null },
    getFacetUrl: function (e, a, t) { var n = this; var i = n.getStreamDomain(); return e = e || n.CAMPAIGN_ID, a = a || STUDIO_VERSION, SKRConstants.GET_FACET_URL.replace('<domain>', i).replace('<campaignId>', e).replace('<version>', a).replace('<view>', t) },
    buildLoadWidgetUrl: function (e, a, t, n) { var i = this; var r = null; if (n = $.extend({ isFromTemplate: !1 }, n), e) { var o = i.getStreamDomain(); t = t || i.getPageParams(), a = a || ROOT_PAGE_URL, r = SKRConstants.LOAD_WIDGET_URL.replace('<domain>', o), r = r + '?campaignId=' + i.CAMPAIGN_ID + '&version=' + STUDIO_VERSION + '&widgetId=' + e + '&view=' + STUDIO_CURRENT_VIEW, t && !$.isEmptyObject(t) && (a = a + '?' + $.buildQueryString(t, !1)), r = r + '&pageUrl=' + encodeURIComponent(a), r = r + '&isFromTemplate=' + n.isFromTemplate, r += n.cacheControl ? '&cacheControl=' + n.cacheControl : '' } return r },
    getWidgetFromLibrary: function (e, a, t) { var n = this; var i = n.buildLoadWidgetUrl(e); n.getWidgetByUrl(i, a, t) },
    getWidgetByUrl: function (e, a, t) { var n = this; if (e) { var i = function (e) { if ($('#id_skWidgetLoader').length == 0) { var n = document.createElement('div'); n.id = 'id_skWidgetLoader', $('body').append(n), $('#id_skWidgetLoader').hide() } else $('#id_skWidgetLoader').empty().hide(); e && e.responseCode == SKRConstants.SUCCESS_RESPONSE_CODE ? $('#id_skWidgetLoader').html(e.content) : (t && t(), console.log('Get widget Error')); var i = $('#id_skWidgetLoader').children(); a && a(i), $('#id_skWidgetLoader').remove() }; var r = function () { t && t(), console.log('Get widget Error') }; $.isSameDomain(e) ? n.httpService.get(e, null, null, 'html', null, i, r) : n.httpService.getJsonp({ type: 'GET', cache: !1, url: e, success: i, error: r }) } else t && t() },
    getWidgetById: function (e, a, t) { var n = this; e && n.getWidgetFromLibrary(e, function (i) { var r = n.getWidgetDataFromLibrary(e); if (r) { var o = null; for (var s in r.cells) if (r.cells.hasOwnProperty(s)) { o = s; break } var l = $('#' + o, i); a(r, l) } else console.log('Error: load widget'), t && t({ responseMessage: 'Widget not found' }) }, function (e) { console.log('Error: load widget'), t && t({ responseMessage: 'Widget not found' }) }) },
    getWidgetExById: function (e, a, t, n, i, r, o, s) { var l = this; if (i && i != -1)l.getWidgetFromPage(i, t, o, s, e, a); else { s = $.extend({}, s); var g = l.buildLoadWidgetUrl(t, r, o, s); l.getWidgetByUrl(g, function (n) { var i = null; var r = /_t/; i = s.isFromTemplate && !r.test(t) ? l.getWidgetDataFromLibrary(t + '_t') || l.getWidgetDataFromLibrary(t) : l.getWidgetDataFromLibrary(t); var o = null; var g = null; if (i) { for (var c in i.cells) if (i.cells.hasOwnProperty(c) && i.cells[c] && i.cells[c].widget) { o = c, g = i.cells[c]; break } var d = $('#' + o, n); e(d, g, i) } else console.log('Error: load widget'), a && a({ responseMessage: 'Widget not found' }) }, function () { console.log('Error: load widget'), a && a({ responseMessage: 'Widget not found' }) }) } },
    getWidgetByName: function () { console.log('This API not available for online') },
    getWidgetFromPage: function (e, a, t, n, i, r) { var o = this; if (e && e != -1) { var s = function () { console.log('Error: load widget'), r && r({ responseMessage: 'Widget not found' }) }; o.getStudioPage(e, t, null, n, function (e, t) { var n = null; var r = null; var o = null; if ((t = t || null) && t.cells) for (var l in t.cells) if (t.cells.hasOwnProperty(l)) { var g = t.cells[l]; if (g.widget && g.widget.widgetId == a) { n = g; break } } if (!n && t && t.absoluteWidgets) for (var l in t.absoluteWidgets) if (t.absoluteWidgets.hasOwnProperty(l) && t.absoluteWidgets[l].cells) for (var c in t.absoluteWidgets[l].cells) if (t.absoluteWidgets[l].cells.hasOwnProperty(c)) { var g = t.absoluteWidgets[l].cells[c]; if (g.widget && g.widget.widgetId == a) { n = g, o = t.absoluteWidgets[l]; break } }r = e && n ? $('#' + n.cellId + '.cls_skWidget', e) : null, r ? i(r, n, o) : s() }, function (e) { console.log('Error: load page'), r && r() }) } },
    getStudioPage: function (e, a, t, n, i, r) { var o = this; var s = SKRConstants.STUDIO_PAGE_PREFIX_IDX + '_' + e; var l = o.getViewName(); n = $.extend({ skipCache: !1 }, n); var g = o.getDynamicPageHtmlUrlByPageId(e, l, a); if (t && t.pageMacros && (g = $.applyPageMacro(g, t.pageMacros)), g && g.length > 0 && (g = removeProtocol(g)), o.studioPages[s] || (o.studioPages[s] = {}), n.skipCache || !n.skipCache && $.isEmptyObject(o.studioPages[s][l])) if (g) { g = g + '?domain=' + encodeURIComponent(window.location.origin) + '&campaignId=' + o.CAMPAIGN_ID; var c = function (a) { if ($('#id_skPageLoader').length == 0) { var t = document.createElement('div'); t.id = 'id_skPageLoader', $('body').append(t), $('#id_skPageLoader').hide() } else $('#id_skPageLoader').empty().hide(); $('#id_skPageLoader').html(a), $.each($('.scfPage', '#id_skPageLoader'), function (e, a) { if (!$.isEmptyObject(a)) { var t = $(a).attr('id'); l = $(a).data('viewname') || l, o.setStudioPage(t, l, $(a).clone()) } }); var n = $('#' + s, '#id_skPageLoader'); var r = 'STUDIO_PAGES_DATA' in window && STUDIO_PAGES_DATA[e] ? STUDIO_PAGES_DATA[e] : null; $('#id_skPageLoader').remove(), i && i(n.clone(), r) }; var d = function () { r && r(), console.log('Get page Error') }; $.isSameDomain(g) ? o.httpService.get(g, null, null, 'html', null, c, d) : o.httpService.getJsonp({ type: 'GET', cache: !1, url: g, success: c, error: d }) } else r && r(); else if (i) { var u = 'STUDIO_PAGES_DATA' in window && STUDIO_PAGES_DATA[e] ? STUDIO_PAGES_DATA[e] : null; i(o.studioPages[s][l].clone(), u) } },
    getDynamicPageHtmlUrlByPageId: function (e, a, t) { var n = this; var i = n.getPageUrlByPageId(e); a = a || n.getViewName(); var r = null; var o = n.getStreamDomain(); var s = n.getCatalogName(); r = SKRConstants.LOAD_PAGE_URL.replace('<domain>', o), r = r + STUDIO_VERSION + '-' + (a || 'prod') + '/' + s + '/' + i; var l = n.getSiteFacetByName('encodePageParams') == 'true'; return $.isEmptyObject(t) || (r += '?' + $.buildQueryString(t, l)), r },
    setStudioPage: function (e, a, t) { var n = this; n.studioPages[e] || (n.studioPages[e] = {}), n.studioPages[e][a] || (n.studioPages[e][a] = {}), n.studioPages[e][a] = t },
    getPageUrlByPageId: function (e) { var a = this; var t = null; if (a.catalog && a.catalog.pageUrlPageIdMap) for (var n in a.catalog.pageUrlPageIdMap) if (a.catalog.pageUrlPageIdMap[n] == e) { t = n; break } return t },
    getPageIdByPageUrl: function (e) { var a = this; var t = null; return a.catalog && a.catalog.pageUrlPageIdMap && (t = a.catalog.pageUrlPageIdMap[e]), t || (t = readerObj.getPageIdByVanityUrl(e)), t },
    getPageIdByVanityUrl: function (e) { var a = this; var t = null; if (a.catalog && a.catalog.vanityURLMapping) { var n = a.catalog.vanityURLMapping[e]; n && n.pageId && (t = n.pageId) } return t },
    getPageByPageUrlPattern: function (e) { var a = this; var t = {}; if (e) { var n = a.getPageIdByPageUrl(e); if (n)t.isPatternUrl = !1, t.pageId = n, t.pageMacros = null; else { if (a.pageMacroCache[e]) return a.pageMacroCache[e]; var i = a.catalog.pageUrlPatternPageIdMap; var r = a.catalog.vanityUrlPatternMapping; var o = a.catalog.commonUrlPatternMapping; if (o && o.length > 0) for (var s = 0; s < o.length; s++) { var l = o[s].urlPattern; if (l) { var g = new RegExp(l); if (g.test(e) && a.validateCommonUrlPatternWithQueryParams(o[s])) { var n = o[s].pageId; var c = o[s].url; if (t.isPatternUrl = !0, t.pageId = n, t.pageMacros = {}, c && g.test(c)) { var d = g.exec(c); var u = g.exec(e); if (d && d.length > 1) for (var s = 1; s < d.length; s++) { var p = d[s].match(/\${pm\.(.+?)\}/); p && p.length > 1 && (t.pageMacros[p[1]] = u[s]) } } } } if (!$.isEmptyObject(t)) return a.pageMacroCache[e] = t, t } else { for (var l in r) if (r.hasOwnProperty(l)) { var g = new RegExp(l); if (g.test(e)) { var n = r[l].pageId; var f = r[l].vanityUrl; if (t.isPatternUrl = !0, t.pageId = n, t.pageMacros = {}, f && g.test(f)) { var d = g.exec(f); var u = g.exec(e); if (d && d.length > 1) for (var s = 1; s < d.length; s++) { var p = d[s].match(/\${pm\.(.+?)\}/); p && p.length > 1 && (t.pageMacros[p[1]] = u[s]) } } } } if ($.isEmptyObject(t)) for (var l in i) if (i.hasOwnProperty(l)) { var g = new RegExp(l); if (g.test(e)) { var n = i[l]; t.isPatternUrl = !0, t.pageId = n, t.pageMacros = {}; var h = a.getPageUrlByPageId(n); if (h && g.test(h)) { var d = g.exec(h); var u = g.exec(e); if (d && d.length > 1) for (var s = 1; s < d.length; s++) { var p = d[s].match(/\${pm\.(.+?)\}/); p && p.length > 1 && (t.pageMacros[p[1]] = u[s]) } } } }a.pageMacroCache[e] = t } } } return t },
    getDefaultPageLevelMacroByPageId: function (e) { var a = this; var t = {}; if (a.catalog && a.catalog.pages && a.catalog.pages[e] && a.catalog.pages[e].pageLevelMacro) { var n = a.catalog.pages[e].pageLevelMacro; if (n) for (var i in n)n.hasOwnProperty(i) && (t[n[i].id] = n[i].defaultValue) } return t },
    getAnalyticsProperties: function () { var e = this; return e.catalog ? e.catalog.analyticsProperties : null },
    setGAId: function (e, a) { var t = this; if (e) { var n = t.getAnalyticsProperties(); if (n && !$.isEmptyObject(n.googleAnalytics) && (n.googleAnalytics.analyticsId = e), t.analyticsObj)a && a(); else { var i = function () { 'SksReaderAnalytics' in window && (t.analyticsObj = new SksReaderAnalytics(t.catalog.analyticsProperties, t.catalog.streamDomain), t.analyticsObj.initTracking(function () { a && a() })) }; skReaderRequire(['skAnalyticsJS'], i) } } },
    setGASettings: function (e) { var a = this.getAnalyticsProperties(); e && a && !$.isEmptyObject(a.googleAnalytics) && (a.googleAnalytics.settings = e) },
    getCurrentPageObj: function () { return this.studioPageObj },
    getCurrentPageId: function () { return this.pageData ? this.pageData.pageId : null },
    setPageParams: function (e) { this.pageParams = e },
    getPageParams: function () { return STUDIO_PREVIEW ? {} : (this.pageParams = $.getQueryStrings(), this.pageParams) },
    getAssetById: function (e) { var a = this; var t = null; return a.catalog && (a.catalog.assetMap && a.catalog.assetMap[e] ? t = a.catalog.assetMap[e] : a.catalog.assets && $.each(a.catalog.assets, function (a, n) { if (n.assetId == e) return t = n, !1 })), t },
    getAssetByName: function (e) { var a = this; var t = null; return a.catalog && (a.catalog.assetMap ? $.each(a.catalog.assetMap, function (a, n) { if (n.displayName == e) return t = n, !1 }) : a.catalog.assets && $.each(a.catalog.assets, function (a, n) { if (n.displayName == e) return t = n, !1 })), t },
    loadPluginResources: function (e, a) { for (var t = this, n = 0, i = 0, r = function () { ++i >= n && a && a() }, o = function (e) { console.log("Resource can't load " + e.fileURL), r() }, s = 0; s < e.length; s++) { var l = e[s]; l.fileType == SKRConstants.FILETYPE_JS && (n++, l.loadCbk = r, l.errorCbk = $.createDelegate(t, o, [l])), t.addNewTag(l) }n == 0 && a && a() },
    addNewTag: function (e, a) { var t = this; var n = removeProtocol(e.fileURL) || null; var i = e.fileType || null; var r = e.loadCbk || null; var o = e.errorCbk || null; var s = e.resourceId || null; if (n != null) { var l = a || document.getElementsByTagName('head').item(0); if (i == SKRConstants.FILETYPE_JS) if (t.isIEBrowser)$.getScript(n, r); else { var g = document.createElement('script'); if (g.setAttribute('src', n), g.setAttribute('data-resourceId', s), g.setAttribute('type', 'text/javascript'), g.setAttribute('charset', 'UTF-8'), r) { var c = !1; g.onload = g.onreadystatechange = function () { c || this.readyState && this.readyState !== 'loaded' && this.readyState !== 'complete' || (c = !0, g.onload = g.onreadystatechange = null, r && r()) } }o && (g.onerror = o), l.appendChild(g) } else if (i == SKRConstants.FILETYPE_CSS) { var g = document.createElement('link'); g.setAttribute('href', n), g.setAttribute('data-resourceId', s), g.setAttribute('type', 'text/css'), g.setAttribute('rel', 'stylesheet'), l.appendChild(g) } } },
    findPage: function (e, a) { var t = this; var n = {}; if (e) { var i = t.catalog.pages; try { var r = new FacetFilter(e); for (var o in i) if (i.hasOwnProperty(o)) { var s = i[o]; var l = s.facets; a ? (l.page_icon || l.pin_thumbnail) && r.matches(l, !0) && (n[o] = s) : r.matches(l, !0) && (n[o] = s) } } catch (e) { return console.error('Error on find page: ', e), n } } return n },
    findItems: function (e, a, t) { function n (n) { i.allItems = n; var o = []; if (n.responseCode == 0 && n.model && n.model.allItems && (o = n.model.allItems), e) { var s = o; try { var l = new FacetFilter(e); for (var g in s) if (s.hasOwnProperty(g)) { var c = s[g]; if (c && c.facets) { var d = c.facets; l.matches(d, !0) && (r[g] = c) } } } catch (e) { t && t(r) } } else if (a) { var s = o; try { for (var g in s) if (s.hasOwnProperty(g)) { var c = s[g]; if (c && c.facets) { var d = c.facets; d && d[a] && (r[d[a]] ? r[d[a]]++ : r[d[a]] = 1) } } } catch (e) { t && t(r) } }t && t(r) } var i = this; var r = {}; i.allItems && n(i.allItems), $.ajax({ cache: 'false', type: 'GET', url: i.getFacetUrl(), dataType: 'json', data: null, contentType: 'application/json', success: function (e) { n(e) }, error: function () { console.log('Get Facet for all items Error'), t && t && t() } }) },
    buildSearchFilter: function (e, a) { var t = []; if (a && a.length > 0) for (var n = 0; n < a.length; n++) { var i = {}; i.property = a[n], i.value = e, i.operator = 'STRCONTAINS', t.push(i) } return [t] },
    renderSearchPanel: function (e, a, t, n) { var i = this; if (e) { var r = document.createElement('div'); r.className = 'cls_searchDiv'; var o = document.createElement('input'); o.id = 'id_searchInput', o.className = 'cls_searchInput', o.type = 'text', o.value = '', o.setAttribute('placeholder', n || 'Search'), o.onkeypress = function (e) { var n = $(this).val(); e.keyCode == 13 && n != '' && (n = n.trim(), i.doSearch(a, t, n)) }, r.appendChild(o), $('#' + e).append(r) } },
    doSearch: function (e, a, t) { var n = this; var i = n.buildSearchFilter(t, a); var r = { filter: encodeURIComponent(JSON.stringify(i)) }; n.navToPageByUrl(e, r) },
    renderSortByPanel: function (e, a, t, n, i) { var r = this; if (e) { var o = document.createElement('div'); o.className = 'cls_sortByDiv'; var s = document.createElement('select'); s.id = 'id_sortBySelect_' + t, s.className = 'cls_sortBySelect', s.type = 'select', s.value = '', r.findItems(null, t, function (l) { if (l) { var g = document.createElement('option'); g.setAttribute('disabled', 'disabled'), g.setAttribute('selected', 'selected'), g.value = '', g.innerHTML = i, s.appendChild(g); for (var c in l) if (l.hasOwnProperty(c)) { var g = document.createElement('option'); g.value = c, g.innerHTML = c, s.appendChild(g) } }s.onchange = function (e) { var n = $(this).val(); if (n != '') { var i = r.buildSearchFilter(n, [t]); var o = { filter: encodeURIComponent(JSON.stringify(i)) }; r.navToPageByUrl(a, o) } }; var d = document.createElement('span'); d.className = 'cls_searchLabelSpan', n && (d.innerHTML = n), o.appendChild(d), o.appendChild(s), $('#' + e).append(o) }) } },
    setJsonpCallback: function (e, a) { var t = this; a && a.jsonpCallback ? (t.jsonpCallbacks[a.jsonpCallback] || (t.jsonpCallbacks[a.jsonpCallback] = []), t.jsonpCallbacks[a.jsonpCallback].push({ dao: e, params: a }), t.jsonpCallbacks[a.jsonpCallback].length == 1 && t.handleJsonpCallback(a.jsonpCallback, !0)) : a.dataType == 'jsonp' ? e && e.url && typeof e.url === 'function' ? (a.url = e.url(), t.httpService.getJsonp(a)) : a.url && t.httpService.getJsonp(a) : e ? e.fetch(a) : t.httpService.getJsonp(a) },
    handleJsonpCallback: function (e, a) { var t = this; a || t.jsonpCallbacks[e].splice(0, 1), t.jsonpCallbacks[e][0] && (function (e) { var a = e.params.success; var n = e.params.error; e.params.success = function (n) { a && a.apply(this, arguments), t.handleJsonpCallback(e.params.jsonpCallback, !1) }, e.params.error = function (a) { t.handleJsonpCallback(e.params.jsonpCallback, !1), n && (n.apply(this, arguments), n = null) }, e.dao && e.dao.url && typeof e.dao.url === 'function' ? (e.params.url = e.dao.url(), t.httpService.getJsonp(e.params)) : e.params.url ? t.httpService.getJsonp(e.params) : t.handleJsonpCallback(e.params.jsonpCallback, !1) }(t.jsonpCallbacks[e][0])) },
    replacePageLevelMacros: function (e, a) { var t = this; var n = e.pageLevelMacro; var i = a ? JSON.stringify(a) : JSON.stringify(e); for (var r in n) if (n.hasOwnProperty(r)) { var o = new RegExp('\\$\\{pm\\.' + r + '\\}', 'g'); n[r].order == SKRConstants.PageLevelMacroOrderCookieFirst ? i = $.cookies.get(r) ? i.replace(o, validateMacroValue($.cookies.get(r))) : t.getPageParams()[r] ? i.replace(o, validateMacroValue(t.getPageParams()[r])) : i.replace(o, validateMacroValue(n[r].defaultValue)) : n[r].order == SKRConstants.PageLevelMacroOrderGetFirst && (i = t.getPageParams()[r] ? i.replace(o, validateMacroValue(t.getPageParams()[r])) : $.cookies.get(r) ? i.replace(o, validateMacroValue($.cookies.get(r))) : i.replace(o, validateMacroValue(n[r].defaultValue))) } return JSON.parse(i) },
    replaceSiteLevelMacros: function (e) { var a = this; var t = null; if (e) { var n = null; var i = JSON.stringify(e); var r = a.getCatalog(); if (r != null && r.siteMacros && (n = r.siteMacros), n != null) for (var o in n) if (n.hasOwnProperty(o)) { var s = new RegExp('\\$\\{sm\\.' + o + '\\}', 'g'); i = i.replace(s, n[o]) }t = JSON.parse(i) } return t },
    setPageNavigating: function (e) { this.isPageNavigating = e },
    showLoadingGauge: function () { var e = document.getElementById('id_loadingMask'); if (e)$(e).show(); else { e = document.createElement('div'), e.className = 'loadingMask', e.id = 'id_loadingMask'; var a = document.createElement('div'); a.className = 'ui-loader', e.appendChild(a), document.body.appendChild(e) } },
    hideLoadingGauge: function () { $('#id_loadingMask').hide() },
    makeCenterPage: function (e) { var a = $(".scfPage[data-pageid='" + e + "']:not(.sk-ui-layout-grid)"); if ($('.lyt_cont_div', a).attr('flexiPage') != 'true') { var t = $('.lyt_cont_div', a); var n = $(t).width(); var i = ($(window).width() - n) / 2; $(t).parents('#id_scfContent_').hasClass('parallaxWrapper') && $(t).parents('#id_scfContent_').siblings('#skPageParallax').length > 0 ? $(t).parents('#id_scfContent_').siblings('#skPageParallax').css('margin-left', i > 0 ? i : 0) : $(t).css('margin-left', i > 0 ? i : 0) } },
    handleWindowResize: function () { var e = this; var a = null; var t = function () { clearTimeout(a), a = setTimeout(function () { for (var a = $('.lyt_cont_div', $.activePage), t = $('.cls_absWidget', a), n = 0; n < t.length; n++) { var i = $(t[n]); e.calculateAbsoluteWidgetPosition(i) } }, 100) }; $(window).resize(t), $.onOrientationChanged(function (a) { e.onOrientationChanged(a) }) },
    onOrientationChanged: function (e) { var a = this; var t = a.getCurrentPage(); var n = $(".scfPage[data-pageid='" + t.pageId + "']"); if (e == SKRConstants.ORIENTATION_LANDSCAPE) { if (n.hasClass('sk-ui-layout-landscape')) return } else { if (e != SKRConstants.ORIENTATION_PORTRAIT) return; if (n.hasClass('sk-ui-layout-portrait')) return } if (t.gridLayout && t.gridLayout.landscape && n.hasClass('sk-ui-layout-grid')) { var i = null; e == SKRConstants.ORIENTATION_LANDSCAPE ? (n.removeClass('sk-ui-layout-portrait').addClass('sk-ui-layout-landscape'), i = t.gridLayout.landscape) : (n.removeClass('sk-ui-layout-landscape').addClass('sk-ui-layout-portrait'), i = t.gridLayout); var r = i.properties; n.hide(), n.attr('data-gridcols', r.columns), n.attr('data-gridlayoutmargin', r.margin), n.attr('data-gridguttersize', r.gutterSize); var o = function (e) { $.each(e, function (e, a) { var t = $('#' + a.cellId, n); t.attr('data-cols', a.properties.columns), 'maxCellHeight' in a.properties ? t.attr('data-maxheight', a.properties.maxCellHeight) : t.removeAttr('data-maxheight'), a.properties.hidden ? t.addClass('sk-ui-layout-grid-cell-hide') : t.removeClass('sk-ui-layout-grid-cell-hide'), t.moveAtIndex(e), a.cells && o(a.cells) }) }; o(i.cells), a.processGridLayout(n), n.fadeIn('fast', function () { n.show(), setTimeout(function () { $('body').animate({ scrollTop: 0 }, '500') }, 100) }) } },
    processGridLayout: function (e) { var a = this; var t = $(e); if (t.hasClass('sk-ui-layout-grid')) { var n = parseInt(t.attr('data-devicetype') || '0', 10); var i = parseInt(t.attr('data-gridcols') || '0', 10); var r = parseInt(t.attr('data-gridlayoutmargin') || '0', 10); var o = parseInt(t.attr('data-gridguttersize') || '0', 10); var s = o > 0 ? o / 2 : 0; var l = r - s; var g = !1; var c = !1; n > 0 ? n == 3 ? g = !0 : n == 2 ? c = !0 : n == 1 && !0 : i == 12 ? g = !0 : i == 8 ? c = !0 : i == 4 && !0; var d = $('.lyt_cont_div', t); $(t).css('overflow', 'hidden'), $('> .scfContent', t).css('margin', l).css('width', 'auto'), $('#sk_id_layout_grid .sk-ui-layout-grid-cell', d).css('padding', s); var u = $('#sk_id_layout_grid .sk-ui-layout-grid-cell', d).not('.sk-ui-layout-grid-cell-container > .sk-ui-layout-grid-cell, .cls_absWidget > .sk-ui-layout-grid-cell'); var p = 100 / i; $.each(u, function (e, t) { var n = parseInt($(t).attr('data-cols') || '0', 10); var i = 0; if (i = (g || c) && a.isMobile ? 100 : n * p, $(t).css('width', i + '%'), $(t).attr('data-maxheight')) { var r = parseInt($(t).attr('data-maxheight') || '0', 10); $(t).css('max-height', r + 'px').css('overflow-y', 'hidden') } else $(t).css('max-height', '').css('overflow-y', '') }) } },
    appReadyEvent: function (e) { var a = this; $(document).triggerHandler(SKRConstants.APP_READY_EVT, { continue: $.proxy(e, this) }) != 0 ? e && e() : (console.log('Reader appReady cancelled'), a.setPageNavigating(!1), a.hideLoadingGauge()) },
    analyticsReadyEvent: function (e) { var a = this; a.analyticsReady = !0, $(document).triggerHandler(SKRConstants.ANALYTICS_READY_EVT, { continue: $.proxy(e, this) }) != 0 ? e && e() : (console.log('Reader analyticsReady cancelled'), a.setPageNavigating(!1), a.hideLoadingGauge()) },
    loadPageEvent: function (e, a) { var t = this; $(document).triggerHandler(SKRConstants.READERPAGE_LOAD_EVT, a) != 0 ? e && e() : (console.log('Reader pageLoad cancelled'), t.setPageNavigating(!1), t.hideLoadingGauge()) },
    pageBeforeChangeEvent: function (e, a) { var t = this; $(document).triggerHandler(SKRConstants.READERPAGE_BEFORECHANGE_EVT, $.extend({ continue: $.proxy(e, this) }, a)) != 0 ? e && e() : (console.log('Reader pageBeforeChange cancelled for pageId: ', a.pageId), t.setPageNavigating(!1), t.hideLoadingGauge()) },
    pageBeforeLoadEvent: function (e, a) { var t = this; $(document).triggerHandler(SKRConstants.READERPAGE_BEFORELOAD_EVT, $.extend({ continue: $.proxy(e, this) }, a)) != 0 ? e && e() : (console.log('Reader pageBeforeLoad cancelled for pageId: ', a.pageId), t.setPageNavigating(!1), t.hideLoadingGauge()) },
    pageBeforeShowEvent: function (e, a) { var t = this; $(document).triggerHandler(SKRConstants.READERPAGE_BEFORESHOW_EVT, $.extend({ continue: $.proxy(e, this) }, a)) != 0 ? e && e() : (console.log('Reader pageBeforeShow cancelled for pageId: ', t.pageId), t.setPageNavigating(!1), readerObj.hideLoadingGauge()) },
    gaJsTrackPageView: function (e) { var a = readerObj.getAnalyticsProperties(); a && a.googleAnalytics && a.googleAnalytics.pageTracking && $(document).triggerHandler(SKRConstants.READER_ANALYTICS_TRACK_PAGEVIEW, e), readerObj.analyticsObj && readerObj.analyticsObj.gaJsTrackPageView.apply(readerObj.analyticsObj, arguments) },
    gaJsTrackEvent: function (e, a, t, n, i) {
      var r = readerObj.getAnalyticsProperties(); r && r.googleAnalytics && r.googleAnalytics.eventTracking && $(document).triggerHandler(SKRConstants.READER_ANALYTICS_TRACK_EVENT, arguments),
      readerObj.analyticsObj && readerObj.analyticsObj.gaJsTrackEvent.apply(readerObj.analyticsObj, arguments)
    },
    calculateAbsoluteWidgetPosition: function (e) { var a; var t; var n; var i; var r; var o; var s = (e.attr('data-abswidgetlevel'), e.attr('data-vertposition')); var l = e.attr('data-horzposition'); if (s && l) { switch (s) { case 'top':t = '0%'; break; case 'center':t = '50%', o = -e.height() / 2; break; case 'bottom':i = '0%' } switch (l) { case 'left':a = '0%'; break; case 'center':a = '50%', r = -e.width() / 2; break; case 'right':n = '0%' }e.animate({ left: a, top: t, right: n, bottom: i, 'margin-left': r, 'margin-top': o }) } },
    getQueryStringArray: function () { var e = this; var a = e.getPageParams(); var t = []; for (var n in a)t.push(n + '=' + a[n]); return t },
    validateCommonUrlPatternWithQueryParams: function (e) { var a = this; var t = !0; try { var n = a.getQueryStringArray(); if (e.queryParams && e.queryParams.advanced && e.queryParams.advanced.length > 0) { for (var i = JSON.parse(e.queryParams.advanced), r = {}, o = 0; o < i.length; o++)i[o].query.length > 0 && i[o].action.length > 0 && (r[i[o].action] ? r[i[o].action].push(i[o]) : (r[i[o].action] = [], r[i[o].action].push(i[o]))); if (r.Contain) for (var o = 0; o < r.Contain.length; o++) { t = !1; for (var s = r.Contain[o].query, l = 0; l < n.length; l++) if (n[l].contains(s)) { t = !0; break } if (!t) return !1 } if (r.Match) for (var o = 0; o < r.Match.length; o++) { t = !1; for (var g = new RegExp('^' + r.Match[o].query + '$'), l = 0; l < n.length; l++) if (g.test(n[l])) { t = !0; break } if (!t) return !1 } if (r['Not Contain']) for (var o = 0; o < r['Not Contain'].length; o++) for (var s = r.Contain[o].query, l = 0; l < n.length; l++) if (n[l].contains(s)) return !1; if (r['Not Match']) for (var o = 0; o < r['Not Match'].length; o++) for (var g = new RegExp('^' + r['Not Match'][o].query + '$'), l = 0; l < n.length; l++) if (g.test(n[l])) return !1 } } catch (e) { console.log('Parse error - Invalid vanity url - query param input') } return t } })
}()); var readerObj = new SksReader(); var SKReader = readerObj; var SksWidgets = {}; var Studio = new PluginService()
!(function () { SksReaderAPI = Class.extend({ init: function (e) { this.CAMPAIGN_ID = null, this.isWebApp = readerObj.isWebApp, this.isAndroid = readerObj.isAndroid, this.isIPad = readerObj.isIPad, this.isIEBrowser = readerObj.isIEBrowser, 'SksReaderRouter' in window && (this.history = { back: function () { readerObj.router.history.goBack() }, forward: function () { readerObj.router.history.goForward() }, pop: function () { readerObj.router.history.pop() }, getState: function () { return readerObj.router.getActiveUserState() }, replaceState: function (e) { readerObj.router.replaceUserState(e) } }) }, initApp: function (e) { e.CAMPAIGN_ID && (this.CAMPAIGN_ID = e.CAMPAIGN_ID), readerObj.initApp(e) }, require: function () { $.loadRequiredFiles.apply(window, arguments) }, getHeaderEl: function () { return '#' + SKRConstants.HEADER_EL_ID }, getFooterEl: function () { return '#' + SKRConstants.FOOTER_EL_ID }, gotoPage: function (e, t, r, a) { STUDIO_PREVIEW ? alert('Event Triggered : Go To Page') : readerObj.navToPageById(e, t, a, r) }, gotoHomePage: function (e, t, r) { STUDIO_PREVIEW ? alert('Event Triggered : Go To Home Page') : readerObj.gotoHomePage(e, t, r) }, navToPageByUrl: function (e, t, r, a) { STUDIO_PREVIEW ? alert('Event Triggered : Navigate To Page By Url') : readerObj.navToPageByUrl(e, t, r, a) }, navToWidget: function (e, t) { readerObj.navToWidget(e, t) }, getCatalogName: function () { return readerObj.getCatalogName() }, getCatalog: function () { return readerObj.getCatalog() }, getCurrentPage: function () { return readerObj.getCurrentPage() }, getPageNameById: function (e) { return readerObj.getPageNameById(e) }, getWidgetDataFromLibrary: function (e, t) { var r = /_t/; return t = $.extend({ isFromTemplate: !1 }, t), t.isFromTemplate && !r.test(e) ? readerObj.getWidgetDataFromLibrary(e + '_t') || readerObj.getWidgetDataFromLibrary(e) : readerObj.getWidgetDataFromLibrary(e) }, getPageIdByName: function (e) { return readerObj.getPageIdByName(e) }, getPageParams: function () { return readerObj.studioPageObj ? readerObj.studioPageObj.getPageParams() : null }, getDefaultPageMacros: function (e) { return readerObj.getDefaultPageLevelMacroByPageId(e) }, getPageMacros: function () { return readerObj.studioPageObj && readerObj.studioPageObj.macros ? readerObj.studioPageObj.macros : null }, getAssetById: function (e) { return readerObj.getAssetById(e) }, getAssetByName: function (e) { return readerObj.getAssetByName(e) }, getSiteFacetByName: function (e) { return readerObj.getSiteFacetByName(e) }, getPageFacetByName: function (e, t) { return readerObj.getPageFacetByName(e, t) }, getItemFacetsByCellId: function (e, t) { return readerObj.getItemFacetsByCellId(e, t) }, setCustomWidgetAjaxTimeout: function (e) { SKRConstants.CUSTOM_WIDGET_AJAX_TIMEOUT = e }, replaceSiteLevelMacros: function (e) { return readerObj.replaceSiteLevelMacros(e) }, setPageNavigating: function (e) { readerObj.setPageNavigating(e) }, setGAId: function (e, t) { readerObj.setGAId(e, t) }, setGASettings: function (e) { readerObj.setGASettings(e) }, isAnalyticsReady: function () { return readerObj.analyticsReady }, setGAProps: function (e, t) { readerObj.analyticsObj && readerObj.analyticsObj.gaJsAnalyticsSetProps(e, t) }, analyticsTrackGeneric: function (e) { if (readerObj.analyticsObj && e) if (typeof e === 'object')readerObj.analyticsObj.gaJsAnalyticsTrackGeneric(e); else try { readerObj.analyticsObj.gaJsAnalyticsTrackGeneric(JSON.parse(e)) } catch (t) { console.log('analyticsTrackGeneric Error : ', e, t) } }, analyticsTrackPageView: function (e) { readerObj.analyticsObj && readerObj.analyticsObj.gaJsTrackPageViewEx(e) }, analyticsTrackEvent: function (e, t, r, a, n) { readerObj.analyticsObj && readerObj.analyticsObj.gaJsTrackEventEx(e, t, r, a, n) }, getJSONP: function (e, t) { t && readerObj.setJsonpCallback(e, t) }, getJSONPScript: function (e) { e && (readerObj.httpService ? readerObj.httpService.getJsonpScript(e) : console.log("Can't found HttpService in Reader")) }, triggerEvent: function (e, t) { $('#' + readerObj.getCurrentPageObj().pageId).trigger(e, t) }, setURLForCustomRefImage: function (e, t) { $(e).attr('src', t) }, getWidgetById: function (e, t, r, a, n, i, d, o) { d = $.extend({ skipRender: !1, isFromTemplate: !1, cacheControl: null, skipCache: !1 }, d); var g = function (t, a) { readerObj.studioPageObj.widgetReadyEvent({ widgetId: r, widgetType: a.widgetType, widgetEl: t, widgetData: a }), e && e(t, a) }; var c = function () { readerObj.studioPageObj.widgetLoadError({ widgetId: r }), t && t() }; var s = function (r, n, i) { var o = { isOverlay: !0, parentWidget: i, params: a }; d.skipRender ? g(r, n.widget) : readerObj.studioPageObj.renderWidget(function () { e && e(r, n.widget) }, function (e) { t && t() }, r, n, o) }; readerObj.getWidgetExById(s, c, r, a, o, n, i, d) }, getWidgetByName: function (e, t, r, a, n, i, d) { d = $.extend({ skipRender: !1, isFromTemplate: !1, cacheControl: null, skipCache: !1 }, d); var o = function (t, a) { readerObj.studioPageObj.widgetReadyEvent({ widgetName: r, widgetType: a.widgetType, widgetEl: t, widgetData: a }), e && e(t, a) }; var g = function () { readerObj.studioPageObj.widgetLoadError({ widgetName: r }), t && t() }; var c = function (r, n, i) { var g = { isOverlay: !0, parentWidget: i, params: a }; d.skipRender ? o(r, n.widget) : readerObj.studioPageObj.renderWidget(function () { e && e(r, n.widget) }, function (e) { t && t() }, r, n, g) }; readerObj.getWidgetByName(c, g, r, a, n, i, d) }, renderSearchPanel: function (e, t, r, a) { readerObj.renderSearchPanel(e, t, r, a) }, renderSortByPanel: function (e, t, r, a, n) { readerObj.renderSortByPanel(e, t, r, a, n) } }) }()); var SKReader = new SksReaderAPI()
!(function () { SksReaderEvents = Class.extend({ init: function (e, t, a, s, n, r, i, o) { this.element = $(e), this.widgetElement = $(t), this.bindElement = null, this.itemData = a, this.widgetData = s, this.widgetName = this.widgetData ? this.widgetData.widgetName || '' : '', this.widgetType = this.widgetData ? this.widgetData.widgetType || '' : '', this.isEventMapping = !1, this.pageId = n ? n.pageId || null : null, this.isFlexi = n && n.isFlexi || !1, this.isClonedElement = n && n.isClonedElement || !1, this.isWidgetEvt = i || !1, this.bindType = o || '', this.EVT_TYPE_CLICK = '1', this.EVT_TYPE_SWIPE_LEFT = '2', this.EVT_TYPE_SWIPE_RIGHT = '3', this.EVT_TYPE_SWIPE_TOP = '4', this.EVT_TYPE_SWIPE_BOTTOM = '5', this.EVT_TYPE_PINCH_ZOOM = '6', this.EVT_TYPE_SWIPE_CIRCLE = '7', this.EVT_TYPE_LINGER = '8', this.EVT_TYPE_HOVER = '9', this.EVT_TYPE_CUSTOM = '10', this.EVT_TYPE_ON_FOCUS = '11', this.EVT_TYPE_THUMBNAIL_CLICK = '12', this.LINGER_EFFECT_NONE = '1', this.LINGER_EFFECT_FADE_IN = '2', this.LINGER_EFFECT_FADE_OUT = '3', this.LINGER_EFFECT_SLIDE_DOWN = '4', this.LINGER_EFFECT_SLIDE_UP = '5', this.LINGER_EFFECT_SLIDE_LEFT = '6', this.LINGER_EFFECT_SLIDE_RIGHT = '7', this.LINGER_EFFECT_POP = '8', this.EVT_ACTION_SHOW_WIDGET = '1', this.EVT_ACTION_SHOW_GLOBAL_WIDGET = '2', this.EVT_ACTION_OPEN_INAPP_URL = '3', this.EVT_ACTION_OPEN_EXT_URL = '4', this.EVT_ACTION_NAV_TO_PAGE = '5', this.EVT_ACTION_OPEN_PAGE = '11', this.EVT_ACTION_SHOW_IMG_LAYER = '6', this.EVT_ACTION_NAV_TO_PAGE_BY_URL = '7', this.EVT_ACTION_OPEN_PAGE_BY_URL = '10', this.EVT_ACTION_HIDE_LAYER = '8', this.EVT_ACTION_NAV_TO_WIDGET = '9', this.SCOPE_TYPE_GLOBAL = '1', this.SCOPE_TYPE_SPECIFIC = '2' }, show: function () { $(this.element).show() }, hide: function () { $(this.element).hide() }, remove: function () { $(this.element).remove() }, render: function (e, t) { var a = this; if ($('.cls_skMediaHotSpotWrapper .cls_skEventsMap', a.element).length > 0 ? (a.bindElement = $('.cls_skMediaHotSpotWrapper .cls_skEventsMap', a.element), a.isEventMapping = !0) : a.bindElement = $('.cls_skMediaHotSpotWrapper', a.element).length > 0 ? $('.cls_skMediaHotSpotWrapper', a.element) : a.element, a.itemData && a.itemData.events) { var s = a.itemData.events; var n = []; for (key in s) if (s.hasOwnProperty(key)) { var r = s[key]; if (n.push(key), r.scope == a.SCOPE_TYPE_GLOBAL && a.bindType != 'bindHotspotCont')r.type == a.EVT_TYPE_CUSTOM ? a.registerEvents(r) : (a.bindElement = $('.cls_skMediaHotSpotWrapper', a.element).length > 0 ? $('.cls_skMediaHotSpotWrapper', a.element) : a.element, a.registerEvents(r, a.bindElement)); else if (r.scope == a.SCOPE_TYPE_SPECIFIC && a.bindType != 'bindItemCont') { var i = r.overlayItem && r.overlayItem.overlayName ? a.cleanupEventName(r.overlayItem.overlayName) : a.cleanupEventName(r.name); if (a.isEventMapping && r.points && r.points.length > 0) { a.bindElement = $('.cls_skMediaHotSpotWrapper .cls_skEventsMap', a.element); var o = document.createElement('area'); o.href = 'javascript:void(0)' } else { a.bindElement = $('.cls_skMediaHotSpotWrapper', a.element).length > 0 ? $('.cls_skMediaHotSpotWrapper', a.element) : a.element; var o = document.createElement('div') } if (o.className = 'hotSpotOverlay ' + i, o.setAttribute('style', 'position: absolute;cursor: pointer;' + (readerObj.isIEBrowser ? "background: url('http://d16rliti0tklvn.cloudfront.net/741/1482401944267.2005161648.png') repeat;" : '')), (!a.isEventMapping || !r.points || r.points.length <= 0) && r.eventArea) { if (isNaN(parseInt(a.widgetType))) { var l = (a.widgetElement.attr('id'), $('#' + r.overlayNode)[0] || $('>img', a.bindElement)[0] || $(a.bindElement)[0]); var m = sksCalculateEventPosition(l, r.eventArea); for (key in m) if (m.hasOwnProperty(key)) { var p = m[key]; $.inArray(key, ['width', 'height', 'top', 'left']) != -1 && (p += 'px', $(o).css(key, p)) } } else for (key in r.eventArea) if (r.eventArea.hasOwnProperty(key)) { var p = r.eventArea[key]; $.inArray(key, ['width', 'height', 'top', 'left']) != -1 && (p += 'px', $(o).css(key, p)) } } else if (a.isEventMapping && r.eventArea && (!r.points || !r.points.length > 0)) { var p = r.eventArea.left + ','; p = p + r.eventArea.top + ',', p = p + (parseInt(r.eventArea.width) + parseInt(r.eventArea.left)) + ',', p += parseInt(r.eventArea.height) + parseInt(r.eventArea.top), o.setAttribute('shape', 'rect'), o.setAttribute('coords', p) } else if (a.isEventMapping && r.eventArea && r.points.length > 0) { for (var v = [], E = 0; E < r.points.length; E += 2)v[E] = parseInt(r.points[E]) + parseInt(r.eventArea.left), v[E + 1] = parseInt(r.points[E + 1]) + parseInt(r.eventArea.top); o.setAttribute('shape', 'poly'), o.setAttribute('coords', v.join(',')) } if (r.overlayNode ? $('#' + r.overlayNode).parent().append(jQuery(o)) : a.bindElement.append(jQuery(o)), r.actions) for (var c = 0; c < r.actions.length; c++) { var d = r.actions[c]; d.name = r.name, d.cssHover = r.cssHover, d.cssPress = r.cssPress, d.eventArea = r.eventArea, d.type = r.type, d.index = c, r.lingerEffect && r.lingerTimestamp && (d.lingerEffect = r.lingerEffect, d.lingerTimestamp = r.lingerTimestamp), a.setAnimationEffects(d) } else a.setAnimationEffects(r); a.registerEvents(r, o) } }a.widgetName && (readerObj.studioPageObj.eventWidgetList[a.widgetName] || (readerObj.studioPageObj.eventWidgetList[a.widgetName] = []), readerObj.studioPageObj.eventWidgetList[a.widgetName].push({ eventObj: a, eventNames: n })) } }, cleanupEventName: function (e) { return e ? e.replace(/\s/g, '_') : null }, registerEvents: function (e, t) { function a () { var a = ($(s.bindElement).actual('width') - $('img', s.bindElement).actual('width')) / 2; var n = ($(s.bindElement).actual('height') - $('img', s.bindElement).actual('height')) / 2; e && e.eventArea && e.eventArea.left && (a = parseFloat(a) + parseFloat(e.eventArea.left)), e && e.eventArea && e.eventArea.top && (n = parseFloat(n) + parseFloat(e.eventArea.top)), $(t).css('left', a), $(t).css('top', n) } var s = this; if (e = JSON.parse(JSON.stringify(e))) if (isNaN(e.type)) { var n = e.type; $(t).attr('hotfix') == 'true' && (n += '.' + $(t).attr('id')), $(document).unbind(n).bind(n, function (t, a) { var n = $(t.target).parent().parent().attr('uniqueid'); a && (e.eventParam = a), s.doAction(e, n, t.target) }) } else { var r = s.getEventType(e); if (r != 'linger' || s.isClonedElement) if (r == 'swipecircle') { if (e.eventArea) { var i = function () {}; var o = function (t) { var a = t && t.element && t.element.offsetParent ? t.element.offsetParent : []; s.doAction(e, null, $('img', a).get(0) || null) }; $('.hotSpotOverlay.' + (e.overlayItem && e.overlayItem.overlayName ? s.cleanupEventName(e.overlayItem.overlayName) : s.cleanupEventName(e.name))).circulable({ canvasWidth: e.eventArea.width ? parseInt(e.eventArea.width) : 0, canvasHeight: e.eventArea.height ? parseInt(e.eventArea.height) : 0, tapCbk: i, circleEndCbk: o }) } } else e.type == s.EVT_TYPE_CUSTOM && (t = $(".scfPage[data-pageid='" + s.pageId + "']")), r == 'swipetop' ? $(t).swipe({ swipe: function (t, a, n, r, i) { a == 'up' && (e.eventParam = t, s.doAction(e, null, null, t)), t.stopPropagation() } }) : r == 'swipedown' ? $(t).swipe({ swipe: function (t, a, n, r, i) { a == 'down' && (e.eventParam = t, s.doAction(e, null, null, t)), t.stopPropagation() } }) : ($(t).bind(r == 'hover' ? 'mouseenter' : r, function (t) { if (!($(t.target).hasClass('showWidgetContInvisMask') || $(t.target).hasClass('showOverlayItemInvisMask') || $(t.target).hasClass('showOverlayWidgetEvtInvisMask'))) { var a = $(t.target).parent().parent().attr('uniqueid'); e.eventParam = t, s.doAction(e, a, t.target, t) } }), $(t).hasClass('hotSpotOverlay') && e.scope == s.SCOPE_TYPE_SPECIFIC && s.isFlexi && !$(t).hasClass('skOverlayEvt') && $(s.bindElement).bind('onfocus', function (e) { isNaN(parseInt(s.widgetType)) || a(), e.stopPropagation() })); else readerObj.studioPageObj.setLingerTimeout(setTimeout(function (a) { s.doAction(e, null, $('img', t).get(0), a) }, parseInt(e.lingerTimestamp, 10))) } }, triggerEvent: function (e, t) { var a = this; if (a.itemData && a.itemData.events && a.itemData.events[e]) { var s = a.itemData.events[e]; var n = parseInt(t && t.timestamp ? t.timestamp : '0', 10); n > 0 ? readerObj.studioPageObj.setLingerTimeout(setTimeout(function (e) { a.doAction(s) }, n)) : a.doAction(s) } }, setAnimationEffects: function (e) { var t = this; var a = null; if (e) { if (e.overlayItem && e.overlayItem.events) for (key in e.overlayItem.events)e.overlayItem.events.hasOwnProperty(key) && (a = e.overlayItem.events[key]); if (e.cssHover && e.cssHover != SKRConstants.default_prop_CssHover && e.cssHover != SKRConstants.default_prop_CssHover_Old) { var s = {}; hoverEffects = a ? a.cssHover : e.cssHover, hoverEffects && (s.hoverEffects = hoverEffects, s.className = e.overlayItem && e.overlayItem.overlayName ? t.cleanupEventName(e.overlayItem.overlayName) : t.cleanupEventName(e.name), (e.overlayItem && e.overlayItem.events && !$.isEmptyObject(e.overlayItem.events) || e.eventArea) && t.setHoverEffects(s)) } if (e.cssPress && e.cssPress != SKRConstants.default_prop_CssPress) { var s = {}; pressEffects = a ? a.cssPress : e.cssPress, pressEffects && (s.pressEffects = pressEffects, s.className = e.overlayItem && e.overlayItem.overlayName ? t.cleanupEventName(e.overlayItem.overlayName) : t.cleanupEventName(e.name), (e.overlayItem && e.overlayItem.events && !$.isEmptyObject(e.overlayItem.events) || e.eventArea) && t.setCssPressEffects(s)) } } }, getEventType: function (e) { var t = this; switch (e.type) { case t.EVT_TYPE_CLICK:return 'click'; case t.EVT_TYPE_SWIPE_LEFT:return 'swipeleft'; case t.EVT_TYPE_SWIPE_RIGHT:return 'swiperight'; case t.EVT_TYPE_SWIPE_TOP:return 'swipetop'; case t.EVT_TYPE_SWIPE_BOTTOM:return 'swipedown'; case t.EVT_TYPE_PINCH_ZOOM:return 'pinch'; case t.EVT_TYPE_SWIPE_CIRCLE:return 'swipecircle'; case t.EVT_TYPE_LINGER:return 'linger'; case t.EVT_TYPE_HOVER:return 'hover'; case t.EVT_TYPE_CUSTOM:return t.cleanupEventName(e.name); case t.EVT_TYPE_ON_FOCUS:return 'onfocus'; case t.EVT_TYPE_THUMBNAIL_CLICK:return 'thumbnailClick' } }, doAction: function (e, t, a, s) { var n = this; var r = function (e) { var r = e.action; var i = null; if (readerObj.gaJsTrackEvent(n.widgetName, n.getEventType(e), n.cleanupEventName(e.name) + '_' + n.cleanupEventName(e.actionName), '', 1), /\b\d+\b/.test(r) && (r = parseInt(r, 10)), typeof r === 'number') { if (e.eventParam && !jQuery.isEmptyObject(e.eventParam)) { var o; r == n.EVT_ACTION_SHOW_WIDGET ? (o = e.actionParamsOriginal || (e.params[2] ? JSON.parse(e.params[2]) : null)) && !jQuery.isEmptyObject(o) && e.type && isNaN(parseInt(e.type)) && (e.params[2] = readerObj.studioPageObj.parseEventParams(e.eventParam, o)) : (o = e.actionParamsOriginal || (e.params[1] ? JSON.parse(e.params[1]) : null)) && !jQuery.isEmptyObject(o) && e.eventParam && e.type && isNaN(parseInt(e.type)) && !jQuery.isEmptyObject(e.eventParam) && (e.params[1] = readerObj.studioPageObj.parseEventParams(e.eventParam, o)), e.actionParamsOriginal = e.actionParamsOriginal || o } var l = r.toString(); switch (l) { case n.EVT_ACTION_SHOW_WIDGET:var m = e.name + '_' + e.actionName; e.type == n.EVT_TYPE_HOVER && n.bindElement.data().eventElements && n.bindElement.data().eventElements[m] ? $(n.bindElement.data().eventElements[m]).is(':visible') || (i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.showWidget(e, a) }, parseInt(e.timestamp ? e.timestamp : '0', 10)))) : i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.showWidget(e, a) }, parseInt(e.timestamp ? e.timestamp : '0', 10))); break; case n.EVT_ACTION_SHOW_GLOBAL_WIDGET:var p = parseInt(e.timestamp ? e.timestamp : '0', 10); p > 0 ? i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.showGlobalWidget(e, s) }, p)) : n.showGlobalWidget(e, s); break; case n.EVT_ACTION_OPEN_INAPP_URL:STUDIO_PREVIEW ? alert('Event Triggered : Open In App Url') : i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.openInAppUrl(e) }, parseInt(e.timestamp ? e.timestamp : '0', 10))); break; case n.EVT_ACTION_OPEN_EXT_URL:var p = parseInt(e.timestamp ? e.timestamp : '0', 10); p > 0 ? i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.openExtUrl(e) }, p)) : n.openExtUrl(e); break; case n.EVT_ACTION_NAV_TO_PAGE_BY_URL:case n.EVT_ACTION_OPEN_PAGE_BY_URL:STUDIO_PREVIEW ? alert('Event Triggered : Navigate To Page By Url') : i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.navToPageByUrl(e, l) }, parseInt(e.timestamp ? e.timestamp : '0', 10))); break; case n.EVT_ACTION_NAV_TO_PAGE:case n.EVT_ACTION_OPEN_PAGE:STUDIO_PREVIEW ? alert('Event Triggered : Navigate To Page') : i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.navToPage(e, l) }, parseInt(e.timestamp ? e.timestamp : '0', 10))); break; case n.EVT_ACTION_SHOW_IMG_LAYER:var m = e.name + '_' + e.actionName; e.type == n.EVT_TYPE_HOVER && n.bindElement.data().eventElements && n.bindElement.data().eventElements[m] ? $(n.bindElement.data().eventElements[m]).is(':visible') || (i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.showOverlayImg(e, t, a) }, parseInt(e.timestamp ? e.timestamp : '0', 10)))) : i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.showOverlayImg(e, t, a) }, parseInt(e.timestamp ? e.timestamp : '0', 10))); break; case n.EVT_ACTION_HIDE_LAYER:i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.hideOverlayLayer(e) }, parseInt(e.timestamp ? e.timestamp : '0', 10))); break; case n.EVT_ACTION_NAV_TO_WIDGET:i = readerObj.studioPageObj.setLingerTimeout(setTimeout(function () { n.navToWidget(e) }, parseInt(e.timestamp ? e.timestamp : '0', 10))) } } else if (typeof r === 'string') { var o; var v = r.split('.')[0]; var E = r.split('.')[1]; var c = Studio.eventsApi.actionNameSpace[v]; var d = /\$\{(.+?).(.+?)\}/; if (c) { var _ = c.actions[E]; o = e.customActionParams, o.widgetName = v || ''; var f = JSON.parse(JSON.stringify(o)); if (f.eventParam = e.eventParam, f.eventParam) for (var u in f) if (f.hasOwnProperty(u)) for (;d.test(f[u]) != 0;) { var h = d.exec(f[u]); h[1] && h[1] == 'e' && (f[u] = f[u].replace(h[0], f.eventParam[h[2]])) } var g = $.proxy(_.callback, n.widgetData); f.eventParam && f.eventParam.currCellId && (f.items = n.widgetData.cells[f.eventParam.currCellId].widget.items), setTimeout(function () { g(f) }, parseInt(e.timestamp ? e.timestamp : '0')) } }e.cancelOnUnHover && i && $(a).bind('mouseout', $.createDelegate(n, function (e, t) { readerObj.clearLingerTimeOut([e - 1], null) }, [i])) }; if (e.actions) for (var i = 0; i < e.actions.length; i++) { var o = e.actions[i]; o.name = e.name, o.cssHover = e.cssHover, o.cssPress = e.cssPress, o.eventArea = e.eventArea, o.type = e.type, o.index = i, e.eventParam && (o.eventParam = e.eventParam), e.lingerEffect && e.lingerTimestamp && (o.lingerEffect = e.lingerEffect, o.lingerTimestamp = e.lingerTimestamp), e.cancelOnUnHover && (o.cancelOnUnHover = e.cancelOnUnHover), r(o) } else r(e) }, showWidget: function (e, t) { var a = this; var s = a.bindElement; s.hasClass('cls_skEventsMap') && (s = s.closest('.cls_skMediaHotSpotWrapper')), readerObj.studioPageObj.showWidget(e, s, a.widgetElement, a.widgetData, t, a.isFlexi) }, showGlobalWidget: function (e, t) { var a = this; a.bindElement; e.params && $(document).trigger(SKRConstants.SHOW_CUSTOM_WIDGET_EVT, [e, t]) }, openInAppUrl: function (e) { e && e.params && e.params[0] && (window.top.location = e.params[0]) }, openExtUrl: function (e) { e && e.params && e.params[0] && window.open(e.params[0]) }, navToPageByUrl: function (e, t) { if (e && e.params && e.params[0]) { var a = e.params[0] || null; var s = e.params[1] ? JSON.parse(e.params[1]) : null; readerObj.navToPageByUrl(a, s, null, t) } }, navToPage: function (e, t) { if (e && e.params && e.params[0]) { var a = e.params[1] ? JSON.parse(e.params[1]) : null; readerObj.navToPageById(e.params[0], a, null, e.urlParams, t) } }, navToWidget: function (e) { if (e && e.params && e.params[0]) { var t = e.params[0].indexOf('~') >= 0 ? e.params[0].split('~') : e.params[0].split('_'); var a = readerObj.getPageNameById(t[0]); var s = $('.cls_skWidget[widgetid=' + t[1] + ']').attr('widgetname'); readerObj.navToWidget(s, a) } }, showOverlayImg: function (e, t, a) { var s = this; var n = (s.widgetElement.attr('id'), $('.cls_skMediaHotSpotWrapper', s.element).length > 0 ? $($('.cls_skMediaHotSpotWrapper', s.element)[0]) : s.element); if (e && e.overlayItem) { var r; r = e.index ? n.find('.hero_overlay_' + s.cleanupEventName(e.name) + '_' + e.index) : n.find('.hero_overlay_' + s.cleanupEventName(e.name)); var i = !!e.params[0] && e.params[0] == 'true'; var o = !!e.params[1] && e.params[1] == 'true'; var l = !!e.params[2] && e.params[2] == 'true'; if (i) { var m = s.isWidgetEvt ? 'showOverlayWidgetEvtInvisMask' : 'showOverlayItemInvisMask'; if (!isNaN(parseInt(s.widgetType)) && $('.' + m, $(a.offsetParent)).length == 0 && $('.' + m, $(a.offsetParent).parent()).length == 0 && ($(a.offsetParent).hasClass('cls_skMediaHotSpotWrapper') || $(a.offsetParent).hasClass('cls_skEventsMap')) || isNaN(parseInt(s.widgetType)) && $('.' + m, n).length == 0 && !$(a).offsetParent().hasClass('showOverlayItemCont')) { var p = document.createElement('div'); p.className = m, p.style.width = n[0].scrollWidth, p.style.height = n[0].scrollHeight, readerObj.isIEBrowser && (p.style.backgroundImage = "url('../img/trans.png')", p.style.backgroundRepeat = 'repeat'), p.onclick = function (e) { e && e.preventDefault(); var t = $(this).parent(); $('.showOverlayItemCont', t).not('.skNonModalOverlayItem,.skOverlayEvt').each(function (e, a) { var s = $(a).attr('uniqueid'); $('.showOverlayItemCont', t).not('.skNonOverlayEvt').each(function (e, t) { $(t).attr('uniqueid').indexOf(s) == 0 && $(t).remove() }) }), $('.showOverlayItemCont', t).not('.skNonModalOverlayItem,.skOverlayEvt').remove(), s.isWidgetEvt ? ($('.showOverlayItemInvisMask', $(this).closest('.cls_skWidget')).hide(), $(this).hide()) : $(this).hide(), $(this).css('background-color', 'transparent').css('opacity', '0'), e && e.stopPropagation() }, $(n).append(p), $(p).bind('touchstart', function () { p.onclick() }) } else $('.' + m, n).show(); if ($('.showSubOverlayItemInvisMask', $(a).offsetParent()).length == 0 && $(a).offsetParent().hasClass('skNonOverlayEvt')) { var p = document.createElement('div'); p.className = 'showSubOverlayItemInvisMask', readerObj.isIEBrowser && (p.style.backgroundImage = "url('../img/trans.png')", p.style.backgroundRepeat = 'repeat'), p.onclick = function (e) { var t = $(this).offsetParent().parent(); var a = $(this).offsetParent().attr('uniqueid'); $(this).css('z-index', '10000'), $('.showOverlayItemCont', t).not('.skNonModalOverlayItem, .skNonOverlayEvt').each(function (e, t) { $(t).attr('uniqueid').indexOf(a) == 0 && $(t).remove() }), $(e.target).hide(), $(this).css('background-color', 'transparent').css('opacity', '0').css('z-index', '9998'), e.stopPropagation() }, $(a).parent().append(p), $(p).bind('touchstart', function () { p.onclick() }) } else $('.showSubOverlayItemInvisMask', n).show() } if (r.length == 0) { var v = function () { function m () { var e = $(r).parent(); var t = ($(e).width() - $('img', e).width()) / 2; E && E.left && (t = parseFloat(t) + parseFloat(E.left)), $(r).css('left', t) }r = document.createElement('div'), e.index ? r.className = 'showOverlayItemCont ' + (i ? 'skModalOverlayItem' : 'skNonModalOverlayItem') + ' hero_overlay_' + s.cleanupEventName(e.name) + '_' + e.index + (t ? ' skOverlayEvt' : ' skNonOverlayEvt') : r.className = 'showOverlayItemCont ' + (i ? 'skModalOverlayItem' : 'skNonModalOverlayItem') + ' hero_overlay_' + s.cleanupEventName(e.name) + (t ? ' skOverlayEvt' : ' skNonOverlayEvt'), e.actionName && (r.className += ' ' + s.cleanupEventName(e.name) + '_' + e.actionName), r.setAttribute('currentevent', e.name), t ? r.setAttribute('uniqueid', t + '_' + s.cleanupEventName(e.name) + '_' + e.actionName) : r.setAttribute('uniqueId', s.cleanupEventName(e.name) + '_' + e.actionName), $(r).hasClass('skOverlayEvt') ? ($('.showSubOverlayItemInvisMask').css('z-index', '10000'), r.setAttribute('style', 'position: absolute;z-index: 10000;')) : ($('.showSubOverlayItemInvisMask', $(r)).css('display', 'none'), r.setAttribute('style', 'position: absolute;z-index: 9999;')); var p = document.createElement('div'); p.className = 'skShowOverlayItemWrapper', r.appendChild(p); var v = document.createElement('img'); e.index ? v.className = 'hero_overlay_' + s.cleanupEventName(e.name) + '_img_' + e.index : v.className = 'hero_overlay_' + s.cleanupEventName(e.name) + '_img', isNaN(parseInt(s.widgetType)) && $(v).addClass('skcOverlayImgNode'), p.appendChild(v), n.append(jQuery(r)); var E = {}; var c = null; isNaN(parseInt(s.widgetType)) ? (c = $('>img', s.bindElement)[0], E = sksCalculateEventPosition(c, e.overlayItem.position)) : E = e.overlayItem.position, $(r).find('img').attr('src', e.overlayItem.url); for (key in E) if (E.hasOwnProperty(key)) { var d = E[key]; $.inArray(key, ['top', 'left', 'width', 'height']) != -1 && (d += 'px', $(r).css(key, d)) } if (e.type == s.EVT_TYPE_HOVER) { var _ = {}; s.bindElement.data() && !s.bindElement.data().eventElements && (s.bindElement.data().eventElements = {}), _ = s.bindElement.data().eventElements, _[e.name + '_' + e.actionName] = r, s.bindElement.data({ eventElements: _ }) } if (s.isFlexi && (!isNaN(parseInt(s.widgetType)) || isNaN(parseInt(s.widgetType)) && c == null) && ($(r).bind('onfocus', function (e) { m(), e.stopPropagation() }), m()), e.overlayItem.events) for (evt in e.overlayItem.events) if (e.overlayItem.events.hasOwnProperty(evt)) { var f = e.overlayItem.events[evt]; if (f.scope == s.SCOPE_TYPE_GLOBAL)f.type == s.EVT_TYPE_CUSTOM ? s.registerEvents(f) : s.registerEvents(f, r); else if (f.scope == s.SCOPE_TYPE_SPECIFIC) { var u = f.actions[0].overlayItem && f.actions[0].overlayItem.overlayName ? s.cleanupEventName(f.actions[0].overlayItem.overlayName) : s.cleanupEventName(f.name); var h = document.createElement('div'); if (h.className = 'hotSpotOverlay skOverlayEvt skModalOverlayItem ' + u, h.setAttribute('style', 'position: absolute;cursor: pointer;' + (readerObj.isIEBrowser ? "background: url('http://d16rliti0tklvn.cloudfront.net/741/1482401944267.2005161648.png') repeat;" : '')), f.eventArea) if (isNaN(parseInt(s.widgetType))) { var g = sksCalculateEventPosition(c, f.eventArea); for (key in g) if (g.hasOwnProperty(key)) { var d = g[key]; $.inArray(key, ['width', 'height', 'top', 'left']) != -1 && (d += 'px'), $(h).css(key, d) } } else { parseInt(f.eventArea.left) + parseInt(f.eventArea.width) > $(p).width() && (f.eventArea.left = 0, f.eventArea.width = $(p).width()), parseInt(f.eventArea.top) + parseInt(f.eventArea.height) > $(p).height() && (f.eventArea.top = 0, f.eventArea.height = $(p).height()); for (key in f.eventArea) if (f.eventArea.hasOwnProperty(key)) { var d = f.eventArea[key]; $.inArray(key, ['width', 'height', 'top', 'left']) != -1 && (d += 'px'), $(h).css(key, d) } } if (p.appendChild(h), f.actions) { for (var T in f.actions) if (f.actions.hasOwnProperty(T)) { var I = f.actions[T]; I.name = f.name, I.cssHover = f.cssHover, I.cssPress = f.cssPress, I.eventArea = f.eventArea, I.type = f.type, I.index = T, f.lingerEffect && f.lingerTimestamp && (I.lingerEffect = f.lingerEffect, I.lingerTimestamp = f.lingerTimestamp), s.setAnimationEffects(I) } } else s.setAnimationEffects(f); s.registerEvents(f, h) } } if (e.lingerEffect != s.LINGER_EFFECT_NONE) { $(p).attr('def-style', $(p).attr('style') || ''), $(r).css('width', $(v).width() + 'px').css('height', $(v).height() + 'px'), $(p).css('position', 'absolute'); var O = { animateTop: ($(p).parent().height() - $(p).height()) / 2, animateLeft: ($(p).parent().width() - $(p).width()) / 2, width: $(r).width(), height: $(r).height(), left: $(r).offset().left, top: $(r).offset().top }; var y = {}; y.lingerEffect = e.lingerEffect, e.index ? y.className = 'hero_overlay_' + s.cleanupEventName(e.name) + '_img_' + e.index : y.className = 'hero_overlay_' + s.cleanupEventName(e.name) + '_img', y.lingerTimeStamp = parseInt(e.lingerTimestamp), s.setLingerEffect(y, $(p), O) }o && e.type == s.EVT_TYPE_HOVER && ($(a).bind('mouseleave', function (e) { $(e.relatedTarget).closest('.showOverlayItemCont').get(0) != r && $(r).remove() }), $(r).bind('mouseleave', function (e) { e.relatedTarget != a && $(this).hide() })), l && e.type == s.EVT_TYPE_ON_FOCUS && $(s.bindElement).bind('onblur', function (e) { this == e.currentTarget && $(r).remove(), e.stopPropagation() }), s.setAnimationEffects(e) }; var E = []; E.push(e.overlayItem.url), sk_preloadImages(E, v) } else r.show(), s.setAnimationEffects(e) } }, hideOverlayLayer: function (e) { if (e && e.params && e.params[0] && e.params[1]) { var t = $('.' + e.params[0] + '_' + e.params[1]); var a = t.offsetParent(); $('.showWidgetContInvisMask', a).not('.showWidgetCont .showWidgetContInvisMask', a).hide(), $('.showOverlayItemInvisMask', a).not('.showWidgetCont .showOverlayItemInvisMask', a).hide(), $('.showOverlayWidgetEvtInvisMask', a).not('.showWidgetCont .showOverlayWidgetEvtInvisMask', a).hide(), t.remove() } }, setLingerEffect: function (e, t, a) { var s = this; if (e) switch (typeof e.lingerEffect === 'number' && (e.lingerEffect = e.lingerEffect.toString()), e.lingerEffect) { case s.LINGER_EFFECT_FADE_IN:case s.LINGER_EFFECT_FADE_OUT:readerObj.studioPageObj.animateElem($(t), a, SKRConstants.WIDGET_TRANSITION_FADE)(); break; case s.LINGER_EFFECT_SLIDE_DOWN:readerObj.studioPageObj.animateElem($(t), a, SKRConstants.WIDGET_TRANSITION_SLIDE_DOWN)(); break; case s.LINGER_EFFECT_SLIDE_UP:readerObj.studioPageObj.animateElem($(t), a, SKRConstants.WIDGET_TRANSITION_SLIDE_UP)(); break; case s.LINGER_EFFECT_SLIDE_LEFT:readerObj.studioPageObj.animateElem($(t), a, SKRConstants.WIDGET_TRANSITION_SLIDE_LEFT)(); break; case s.LINGER_EFFECT_SLIDE_RIGHT:readerObj.studioPageObj.animateElem($(t), a, SKRConstants.WIDGET_TRANSITION_SLIDE_RIGHT)(); break; case s.LINGER_EFFECT_POP:readerObj.studioPageObj.animateElem($(t), a, SKRConstants.WIDGET_TRANSITION_POP)() } }, setHoverEffects: function (e) { e && e.className && ($('.' + e.className).mouseover(function () { if (e.hoverEffects) { var t = JSON.parse(e.hoverEffects); for (key in t)t.hasOwnProperty(key) && key && $(this).css(key, t[key]) } }), $('.' + e.className).mouseout(function () { if (e.hoverEffects) { var t = JSON.parse(e.hoverEffects); for (key in t)t.hasOwnProperty(key) && key && $(this).css(key, 'none') } })) }, setCssPressEffects: function (e) { if (e && e.className) { for (var t = ['mousedown', 'touchstart'], a = 0; a < t.length; a++)$('.' + e.className).bind(t[a], function () { if (e.pressEffects) { var t = JSON.parse(e.pressEffects); for (key in t)t.hasOwnProperty(key) && key && $(this).css(key, t[key]) } }); for (var s = ['mouseup', 'mouseleave', 'touchend'], a = 0; a < t.length; a++)$('.' + e.className).bind(s[a], function () { if (e.pressEffects) { var t = JSON.parse(e.pressEffects); for (key in t)t.hasOwnProperty(key) && key && $(this).css(key, key == 'opacity' ? '1' : 'none') } }) } } }) }())
!(function () { StudioWidget = Class.extend({ init: function () {}, render: function () {}, setConnectorData: function (t) { try { this.connectorData = t, this.render() } catch (t) { console.log(SKRConstants.ErrorLoadingPluginAPI + ' ' + t) } }, triggerEvent: function (t, n) { var e = this.widget ? this.widget.widgetName : this.widgetName; var i = Studio.eventsApi.eventNameSpace[e]; i && i.events[t] && (n && typeof n === 'object' ? $(document).trigger(e + '.' + t, n) : $(document).trigger(e + '.' + t)) }, sksBindItemEvent: function (t, n, e) { var i = this; i.setItemContainer(t), $(t).css('position', 'relative'), e && e(i.el, t, i, n) }, sksAddSetting: function () {}, sksRefreshEvents: function (t) { var n = this; redrawEvents(n, t) }, setItemContainer: function (t) { this.itemContainer = t }, getItemContainer: function () { return this.itemContainer }, setHotspotContainer: function (t) { this.hotspotContainer = t }, getHotspotContainer: function () { return this.hotspotContainer || this.itemContainer }, getImageInContainer: function (t) { return $('>img', t).length ? $('>img', t) : $(t) }, preloadImages: function (t, n, e) { sk_preloadImages(t, n, e) } }), StudioWidget.prototype.baseClassVersion = 'v1' }())
!(function () { StudioWidgetV2 = Class.extend({ init: function (t, e, n, i) { var r = this; n && (r.widget = n, r.setProperties(n.properties), r.setItems(n.items), r.setConnectorProperties(n.connectorProperties)), r.setContainer(i), r.successCbk = t, r.errorCbk = e }, render: function () {}, setConnectorData: function (t) { var e = this; try { e.connectorData = t, e.render() } catch (t) { console.log(SKRConstants.ErrorLoadingPluginAPI + ' ' + t) } }, triggerEvent: function (t, e) { var n = this; var i = n.widget ? n.widget.widgetName : n.widgetName; var r = Studio.eventsApi.eventNameSpace[i]; if (r && r.events[t]) { var o = i + '.' + t; e && typeof e === 'object' ? (e.hotfix && (o += '.' + e.hotfix), $(document).trigger(o, e)) : $(document).trigger(o) } }, bindEvents: function () { var t = this; t.successCbk && t.successCbk(t.getParentContainer(), t.getItemContainer(), t) }, sksBindItemEvent: function (t, e) { var n = this; n.setItemContainer(t), $(t).css('position', 'relative'), n.successCbk && n.successCbk(n.getParentContainer(), t, n, e) }, sksAddSetting: function () {}, sksResizePosition: function () {}, sksRefreshEvents: function (t) { var e = this; redrawEvents(e, t) }, setContainer: function (t) { this.el = t }, getContainer: function () { return this.el }, setProperties: function (t) { this.properties = t }, getProperties: function () { return this.properties }, setItems: function (t) { this.items = t }, getItems: function () { return this.items }, setItemContainer: function (t) { this.itemContainer = t }, getItemContainer: function () { return this.itemContainer }, setParentContainer: function (t) { this.parentContainer = t }, getParentContainer: function () { return this.parentContainer }, setHotspotContainer: function (t) { this.hotspotContainer = t }, getHotspotContainer: function () { return this.hotspotContainer || this.itemContainer }, getImageInContainer: function (t) { return $('>img', t).length ? $('>img', t) : $(t) }, setConnectorProperties: function (t) { this.connectorProperties = t }, getConnectorProperties: function () { return this.connectorProperties }, preloadImages: function (t, e, n) { sk_preloadImages(t, e, n) }, getConnectorInstanceByName: function (t) { var e = null; var n = this.getProperties(); var i = this.getConnectorProperties(); return e = Studio.getConnectorInstanceByName(n[t]), e && e.setConnectorParams(i[t].connectorParams), e }, getWidgetBasePath: function () { var t = this; var e = t.widget && t.widget.widgetType ? t.widget.widgetType : null; var n = null; return e != null && readerObj.pluginWidgetBasePath && readerObj.pluginWidgetBasePath[e] && (n = removeProtocol(readerObj.pluginWidgetBasePath[e])), n } }), StudioWidgetV2.prototype.baseClassVersion = 'v2' }())
!(function () { StudioWidgetWrapper = StudioWidgetV2.extend({ init: function () { var t = this; t._super.apply(t, arguments); var i = t.getContainer(); var o = $(i); var n = $(".sk-ui-layout-grid-cell-background[appendflag='true']", i); n.length == 1 && (o = n); var s = (o.html() || '').trim(); var a = StudioToolkit.getPackageInfo(t); if (!s && a.localFileBasePath) { var r; var d = t.getWidgetBasePath(); var c = t.widget.widgetType; var l = c + '.ftl'; var g = d + l; o && $.ajax({ type: 'get', headers: {}, url: g, data: null, dataType: 'html', success: function (e) { r = e, o.html(r) }, error: function (e) { console.log(e) }, async: !1, crossDomain: !0 }) } typeof Studio !== 'undefined' && Studio && (Studio.inReader || e.isEnableToolkit(t) && (this.toolkit || (this.toolkit = new e(t)))), t.i18n = { messages: {}, datetimes: {}, numbers: {} }; var u = $.ajaxSettings.async; $.ajaxSettings.async = !1, (a.i18n || []).forEach(function (e) { var i = e.type || 'message'; var o = e.name + '.json'; var n = new HttpUtils.URL(t.getWidgetBasePath()).append(o).toString(); i == 'message' && StudioWidgetWrapper.i18nResources[t.widget.widgetType] && StudioWidgetWrapper.i18nResources[t.widget.widgetType][e.name] ? $.extend(t.i18n.messages, StudioWidgetWrapper.i18nResources[t.widget.widgetType][e.name]) : window.skI18nResources && window.skI18nResources[n] ? i == 'message' ? $.extend(t.i18n.messages, window.skI18nResources[n]) : i == 'datetime' ? $.extend(t.i18n.datetimes, window.skI18nResources[n]) : i == 'number' && $.extend(t.i18n.numbers, window.skI18nResources[n]) : $.getJSON(n, null, function (e) { window.skI18nResources || (window.skI18nResources = {}), window.skI18nResources[n] = e, i == 'message' ? $.extend(t.i18n.messages, e) : i == 'datetime' ? $.extend(t.i18n.datetimes, e) : i == 'number' && $.extend(t.i18n.numbers, e) }) }), $.ajaxSettings.async = u }, getMessages: function () { return this.i18n.messages }, getDatetimeFormats: function () { return this.i18n.datetimes }, getNumberFormats: function () { return this.i18n.numbers }, isEditMode: function () { return !!this.editMode && this.editMode }, enterEditMode: function () { this._super(), this.editMode = !0, this.toolkit && this.toolkit.create() }, exitEditMode: function () { this._super(), this.editMode = !1, this.toolkit && this.toolkit.destroy() }, sksExecScript: function (e, t) { var i = this; var o = i.getProperties().script; if (o && !StudioToolkit.isInStudio()) try { o = '"use strict"\n' + o; var n = new Function('$model', '$element', o); var s = function () { n.call(null, e, t) }; $(document).ready(s) } catch (e) { console.log(e) } }, saveProperties: function () { var e = this; if (e._super(), e.toolkit) { var t = e.toolkit.getScriptContent(); t && (e.properties.script = t) } }, getConnectorInstanceByName: function (e) { var t = this; var i = t.getProperties(); var o = t.getConnectorProperties(); var n = Studio.getConnectorInstanceByName(i[e]); return n ? (n.setConnectorParams(o[e].connectorParams), n.setConnectorWidgetId(o[e].connectorWidgetId), n.setConnectorPeriod(o[e].connectorPeriod), n.setConnectorDataType(o[e].connectorDataType), n.setConnectorStaticData(o[e].connectorStaticData)) : n = Studio.getConnectorInstanceByName(e), n } }), StudioWidgetWrapper.i18nResources = {}; var e = Class.extend({ init: function (e) { this.obj = e }, create: function () { var e = $("<div id='idWidgetToolPane'></div>"); e.css('z-index', '999'), e.css('position', 'fixed'), e.css('bottom', 20), e.css('left', $('#idSkcLeftPane').outerWidth() + 20), $('#idSkcLeftPane').append(e); var t = '<div id="idWidgetToolTabs"> <div id="tabs-view" style="display:none"></div>  <div id="tabs-script" style="border: 1px solid lightgray; width: 100%">    <p style="font-size: 13px">This script is executed after the widget completes loading. It is used to control view model for customization. </p>    <p style="font-size: 13px">$model and $element are input objects. $model is the view model of this widget. $element is the dom element of the widget. </p>    <textarea id="idWidgetToolScriptTextarea"></textarea>  </div>  \x3c!--<div id="tabs-mock" style="border: 1px solid lightgray; width: 100%">    <p style="font-size: 13px"></p>    <textarea id="idWidgetToolMockTextarea"></textarea>  </div> --\x3e  <ul>    <li style="border: 1px solid lightgray; height:30px; margin:0;padding:0"><a href="#tabs-view">View</a></li>    <li style="border: 1px solid lightgray; height:30px; margin:0;padding:0"><a href="#tabs-script">Script</a></li>    \x3c!--<li style="border: 1px solid lightgray; height:30px; margin:0;padding:0"><a href="#tabs-mock">Mock</a></li>--\x3e  </ul></div>'.trim(); e.append(t); var i = this.obj.properties.script; var o = $('#idWidgetToolScriptTextarea'); o && (i && o.val(i), this.cm = CodeMirror.fromTextArea(o[0], { mode: 'javascript', extraKeys: { 'Ctrl-1': 'autocomplete' }, lineNumbers: !0, lineWrapping: !0 })), $('#idWidgetToolTabs').tabs(), $('#idWidgetToolTabs').tabs({ show: function (e, t) { this.cm && this.cm.refresh() } }) }, destroy: function () { var e = $('#idWidgetToolPane'); e.length && e.remove() }, getScriptContent: function () { var e; var t = $('#idWidgetToolScriptTextarea'); return t && this.cm && (this.cm.save(), e = t.val()), e } }); e.isEnableToolkit = function (e) { if (skObj) { for (var t, i = skObj.pageService.getPluginIncludes(), o = e.widget.widgetType, n = 0; n < i.length; n++) { var s = i[n].filePackageInfo.widgetApi || i[n].filePackageInfo.connectorApi || i[n].filePackageInfo.eventApi; if (s) for (var a = 0; a < s.length; a++) if (s[a].name == o) { t = i[n].filePackageInfo; break } } if (t) return !!t.enableToolkit } return !1 } }())
function PluginService (e) { this.eventsApi = new EventsApi(), this.connectorApi = new ConnectorApi(), this.inReader = !0 } function EventsApi () { this.actionNameSpace = {}, this.eventNameSpace = {} } function Namespace () { this.nameSpace = new Object() } function Actions () { this.actions = new Array() } function Events () { this.events = new Array() } function ConnectorApi () { this.connectorNameSpace = {} }PluginService.prototype.registerAction = function (e, t, n, c, a, o) { var i = null; typeof e === 'object' ? i = e.widget ? e.widget.widgetName : e.widgetName : typeof e === 'string' && (i = e), this.eventsApi.actionNameSpace[i] = this.eventsApi.actionNameSpace[i] ? this.eventsApi.actionNameSpace[i] : new Namespace(), this.eventsApi.actionNameSpace[i].actions = this.eventsApi.actionNameSpace[i].actions ? this.eventsApi.actionNameSpace[i].actions : new Actions(), this.eventsApi.actionNameSpace[i].actions[t] = {}, this.eventsApi.actionNameSpace[i].actions[t].label = n || {}, this.eventsApi.actionNameSpace[i].actions[t].params = c || [], this.eventsApi.actionNameSpace[i].actions[t].callback = a || '', this.eventsApi.actionNameSpace[i].actions[t].eventFilter = o || [], this.eventsApi.actionNameSpace[i].actions[t].value = t || ''; var p = this.eventsApi.actionNameSpace[i].actions[t].eventFilter; p = p.filter(function (e, t) { return p.indexOf(e) == t }), this.eventsApi.actionNameSpace[i].actions[t].eventFilter = p }, PluginService.prototype.registerEvents = function (e, t, n) { var c = null; typeof e === 'object' ? c = e.widget ? e.widget.widgetName : e.widgetName : typeof e === 'string' && (c = e), this.eventsApi.eventNameSpace[c] = this.eventsApi.eventNameSpace[c] ? this.eventsApi.eventNameSpace[c] : new Namespace(), this.eventsApi.eventNameSpace[c].events = this.eventsApi.eventNameSpace[c].events ? this.eventsApi.eventNameSpace[c].events : new Events(), this.eventsApi.eventNameSpace[c].events[t] = {}, this.eventsApi.eventNameSpace[c].events[t].label = n || {} }, PluginService.prototype.registerConnector = function (e, t, n, c, a) { e = this.replaceAllMacros(e); var o = a.name || a.toString().match(/^function\s*([^\s(]+)/)[1]; this.connectorApi.connectorNameSpace[e] = this.connectorApi.connectorNameSpace[e] ? this.connectorApi.connectorNameSpace[e] : {}, this.connectorApi.connectorNameSpace[e][t] = {}, this.connectorApi.connectorNameSpace[e][t][o] = {}, this.connectorApi.connectorNameSpace[e][t][o].desc = n || '', this.connectorApi.connectorNameSpace[e][t][o].connector = c || null }, PluginService.prototype.resetPlugins = function () { this.eventsApi.actionNameSpace = {}, this.eventsApi.eventNameSpace = {}, this.connectorApi.connectorNameSpace = {} }, PluginService.prototype.getConnectorInstance = function (e) { var t = null; var n = Studio.connectorApi.connectorNameSpace; var c = e.connector; var a = c.split('.')[0]; var o = c.split('.')[1]; if (n[a] && n[a][o]) { var i = e.connectormodel || e.connectorModel; var p = n[a][o][i]; if (!$.isEmptyObject(p)) { t = new (0, p.connector)() } } return t }, PluginService.prototype.getConnectorInstanceByName = function (e) { var t = null; if (e) { var n = Studio.connectorApi.connectorNameSpace; e = e.trim().split('.'); var c = e[0]; var a = e[1]; if (n[c] && n[c][a]) { var o = Object.keys(n[c][a])[0]; var i = n[c][a][o]; if (!$.isEmptyObject(i)) { t = new (0, i.connector)() } } } return t }, PluginService.prototype.getConnectorData = function (e, t, n, c) { var a = e.getUrl(t.connectorparams || t.connectorParams); var o = e.getLoadMethod(); var i = {}; i.type = o.type, i.dataType = o.dataType, i.callback = o.callback, i.callbackName = o.callbackName, a ? i.url = this.replaceAllMacros(a) : console.log('Connector Data URL not exists'), e.load(i, n, c) }, PluginService.prototype.loadConnectorData = function (e, t, n) { var c = Studio.connectorApi.connectorNameSpace; var a = e.connector; var o = a.split('.')[0]; var i = a.split('.')[1]; if (c[o] && c[o][i]) { var p = e.connectormodel || e.connectorModel; var r = c[o][i][p]; if (!$.isEmptyObject(r)) { var s = r.connector; var l = new s(); var v = l.getUrl(e.connectorparams || e.connectorParams); var m = l.getLoadMethod(); var S = {}; S.type = m.type, S.dataType = m.dataType, S.callback = m.callback, S.callbackName = m.callbackName, S.url = this.replaceAllMacros(v), l.load(S, t, n) } } }, PluginService.prototype.replaceAllMacros = function (e) { var t = readerObj.getRawPageData(); var n = e; return t != null && (n = readerObj.replacePageLevelMacros(t, n)), n = readerObj.replaceSiteLevelMacros(n) }, Events.prototype.events, Actions.prototype.actions, Namespace.prototype.nameSpace, ConnectorApi.prototype.connectorNameSpace
function ConnectorModelImage (t) { this.imageUrl = null, this.linkUrl = null, t && (this.imageUrl = t.imageUrl || null, this.linkUrl = t.linkUrl || null) } function ConnectorModelText (t) { this.textData = null, t && (this.textData = t.textData || null) }ConnectorModelImage.prototype.imageUrl, ConnectorModelImage.prototype.linkUrl, ConnectorModelImage.prototype.getImageUrl = function () { return this.imageUrl }, ConnectorModelImage.prototype.setImageUrl = function (t) { this.imageUrl = t }, ConnectorModelImage.prototype.getLinkUrl = function () { return this.linkUrl }, ConnectorModelImage.prototype.setLinkUrl = function (t) { this.linkUrl = t }, ConnectorModelText.prototype.textData, ConnectorModelText.prototype.getTextData = function () { return this.textData }, ConnectorModelText.prototype.setTextData = function (t) { this.textData = t }
!(function () { Connector = Class.extend({ init: function () { this.url = null, this.inputParams = null, this.type = null, this.dataType = null, this.callback = null, this.callbackName = null }, load: function (t, a, l) { var n = this; var s = function (t) { n.transform(t, a) }; var i = function (t) { console.log('Error occurs while getting details of entries.'), l && l(t) }; var e = { type: t.type, dataType: t.dataType, url: t.dataType == 'jsonp' ? t.url : removeProtocol(t.url), jsonp: t.callback ? t.callback : void 0, jsonpCallback: t.callbackName ? t.callbackName : void 0, success: s, error: i }; var c = $.extend(e, this.ajaxOptions); readerObj.setJsonpCallback(null, c) }, transform: function (t, a) { a(t) }, getUrl: function () { return this.url }, setUrl: function (t) { this.url = t }, getInputParams: function () { return this.inputParams }, setInputParams: function (t) { this.inputParams = t }, getLoadMethod: function () { var t = {}; return t.type = this.type, t.dataType = this.dataType, t.callback = this.callback, t.callbackName = this.callbackName, t.ajaxOptions = this.ajaxOptions, t }, setLoadMethod: function (t, a, l, n, s) { this.type = t, this.dataType = a, this.callback = l, this.callbackName = n, this.ajaxOptions = s } }) }())
!(function () { ConnectorV2 = Class.extend({ init: function () { this.url = null, this.inputParams = null, this.type = null, this.dataType = null, this.callback = null, this.callbackName = null }, load: function (t, n, a) { var o = function (t) { n(t) }; var e = function (t) { console.log('Error occurs while getting details of entries.'), a && a(t) }; var c = { type: t.type, dataType: t.dataType, url: t.url, jsonp: t.callback ? t.callback : void 0, jsonpCallback: t.callbackName ? t.callbackName : void 0, success: o, error: e }; var i = $.extend(c, this.ajaxOptions); readerObj.setJsonpCallback(null, i) }, transform: function (t, n) { n(t) }, getUrl: function () { return this.url }, setUrl: function (t) { this.url = t }, getInputParams: function () { return this.inputParams }, setInputParams: function (t) { this.inputParams = t }, getLoadMethod: function () { var t = {}; return t.type = this.type, t.dataType = this.dataType, t.callback = this.callback, t.callbackName = this.callbackName, t.ajaxOptions = this.ajaxOptions, t }, setLoadMethod: function (t, n, a, o, e) { this.type = t, this.dataType = n, this.callback = a, this.callbackName = o, this.ajaxOptions = e, this.ajaxOptions && void 0 !== STUDIO_DATA && STUDIO_DATA.catalogProperties && STUDIO_DATA.catalogProperties['tenant-id'] && (this.ajaxOptions.headers || (this.ajaxOptions.headers = {}), this.ajaxOptions.headers['tenant-id'] = STUDIO_DATA.catalogProperties['tenant-id'].value) }, process: function (t, n) { var a = this; a.constructUrl(this.getConnectorParams()); var o = function (n) { a.transform(n, t) }; a.getConnectorData(o, n) }, getConnectorData: function (t, n) { var a = this.getUrl(); var o = this.getLoadMethod(); o.url = Studio.replaceAllMacros(a), this.load(o, t, n) }, constructUrl: function (t) { this.setUrl('') }, getConnectorParams: function () { return this.connectorParams }, setConnectorParams: function (t) { this.connectorParams = t }, getConnectorParam: function (t) { return this.connectorParams[t] }, setConnectorParam: function (t, n) { this.connectorParams[t] = n }, setConnectorWidgetId: function (t) { this.connectorWidgetId = t }, getConnectorWidgetId: function () { return this.connectorWidgetId }, setConnectorPeriod: function (t) { this.connectorPeriod = t }, getConnectorPeriod: function () { return this.connectorPeriod }, setConnectorDataType: function (t) { this.connectorDataType = t }, getConnectorDataType: function () { return this.connectorDataType }, setConnectorStaticData: function (t) { this.connectorStaticData = t }, getConnectorStaticData: function () { return this.connectorStaticData } }) }())
!(function () { function e (e) { return a.raw ? e : encodeURIComponent(e) } function t (e) { return a.raw ? e : decodeURIComponent(e) } function n (t) { return e(a.json ? JSON.stringify(t) : String(t)) } function i (e) { e.indexOf('"') === 0 && (e = e.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\')); try { return e = decodeURIComponent(e.replace(o, ' ')), a.json ? JSON.parse(e) : e } catch (e) {} } function r (e, t) { var n = a.raw ? e : i(e); return $.isFunction(t) ? t(n) : n } var o = /\+/g; var a = $.cookie = function (i, o, s) { if (void 0 !== o && !$.isFunction(o)) { if (s = $.extend({}, a.defaults, s), typeof s.expires === 'number') { var u = s.expires; var l = s.expires = new Date(); l.setTime(+l + 864e5 * u) } return document.cookie = [e(i), '=', n(o), s.expires ? '; expires=' + s.expires.toUTCString() : '', s.path ? '; path=' + s.path : '', s.domain ? '; domain=' + s.domain : '', s.secure ? '; secure' : ''].join('') } for (var c = i ? void 0 : {}, g = document.cookie ? document.cookie.split('; ') : [], f = 0, d = g.length; f < d; f++) { var p = g[f].split('='); var S = t(p.shift()); var h = p.join('='); if (i && i === S) { c = r(h, o); break }i || void 0 === (h = r(h)) || (c[S] = h) } return c }; a.defaults = {}, $.removeCookie = function (e, t) { return void 0 !== $.cookie(e) && ($.cookie(e, '', $.extend({}, t, { expires: -1 })), !$.cookie(e)) }; var s = { 'en-US': {}, 'zh-CN': {} }; window.ski18n = {}; var u = []; var l = !1; this.HttpUtils = { getLocale: function () { var e = null; return e = HttpUtils.getUrlParam('locale'), !e && window.sessionStorage && (e = window.sessionStorage.getItem('locale')), !e && window.localStorage && (e = window.localStorage.getItem('locale')), e || (e = this.getCookie('u-locale')), e || (e = navigator.language || navigator.userLanguage), e = e && e.indexOf('en') != -1 ? 'en-US' : e && e.indexOf('zh') != -1 ? 'zh-CN' : 'en-US' }, getLocaleWithUnderline: function () { return this.getLocale().replace('-', '_') }, getUrlParam: function (e) { var t = new RegExp('(^|&)' + e + '=([^&]*)(&|$)', 'i'); var n = window.location.search.substr(1).match(t); return n != null ? n[2] : null }, getCookie: function (e) { return $.cookie(e) }, setCookie: function (e, t) { $.cookie(e, t) }, getGlobalItem: function (e) { var t = null; return e ? (t = HttpUtils.getUrlParam(e), !t && window.sessionStorage && (t = window.sessionStorage.getItem(e)), !t && window.localStorage && (t = window.localStorage.getItem(e)), t || (t = this.getCookie(e)), t) : t }, getI18n: function (e) { var t = function (e, t, n, i, r, o) { i = isNaN(i = Math.abs(i)) ? 2 : i, r = void 0 !== r ? r : '$', o = o || ',', n = n || '.'; var a = e < 0 ? '-' : ''; var s = parseInt(e = Math.abs(+e || 0).toFixed(i), 10) + ''; var u = (u = s.length) > 3 ? u % 3 : 0; var l = (u ? s.substr(0, u) + o : '') + s.substr(u).replace(/(\d{3})(?=\d)/g, '$1' + o) + (i ? n + Math.abs(e - s).toFixed(i).slice(2) : ''); return t.replace('s', r).replace('n', a).replace('v', l) }; if (ski18n) { ski18n._vm || typeof Vue === 'undefined' || typeof VueI18n === 'undefined' || (Vue.use(VueI18n), ski18n = new VueI18n({ locale: 'en-US', fallbackLocale: 'en-US', messages: s })); var n = (e ? e.locale : null) || HttpUtils.getLocale(); var i = $.find(ConnectorToolkit.getSiteSettings().currencies, function (e, t) { return t.locale == n }); if (i = i[0] || ConnectorToolkit.getSiteSettings().currencySetting, void 0 === Vue.prototype.$nc && (Vue.prototype.$nc = function (e) { var n = this.$i18n.currencySetting; return n ? arguments.length > 0 ? t(e, n.format, n.decimalsep, n.decimalPlaces, n.symbol, n.thousandsep) : { symbol: n.symbol, code: n.code } : arguments.length > 0 ? t(e, 'snv', '.', 2, '¥', ',') : { symbol: '¥', code: 'CNY' } }), e) { var r = new VueI18n({ locale: n, fallbackLocale: ski18n.fallbackLocale, messages: $.extend(!0, ski18n.messages, e.messages), dateTimeFormats: $.extend(!0, ski18n.dateTimeFormats, e.dateTimeFormats), numberFormats: $.extend(!0, ski18n.numberFormats, e.dateTimeFormats) }); return r.currencySetting = i, r } return ski18n.currencySetting = i, ski18n } }, addLocaleMessage: function (e, t) { var n = HttpUtils.getI18n(); var i = n.getLocaleMessage(e); n.setLocaleMessage(e, $.extend(!0, i, t)) }, URL: function (e) { var t = this; if (!(this instanceof HttpUtils.URL)) return new HttpUtils.URL(e); t.urlString = e || ''; var n = function (e, n) { var i = StringUtils.String(t.urlString).trimIfEndsWith(e).toString(); var r = StringUtils.String(n).trimIfStartsWith(e).toString(); t.urlString = i + e + r }; t.appendPath = function () { for (var e = 0; e < arguments.length; e++) { var i = arguments[e]; if (i) { n('/', i) } } return t }, t.toString = function () { return t.urlString }, t.append = function () { for (var e = 0; e < arguments.length; e++) { var n = arguments[e]; n && (t.urlString += n) } return t }, t.appendParam = function () { StringUtils.String(t.urlString).includes('?') || (t.urlString += '?'); for (var e = 0; e < arguments.length; e++) { var i = arguments[e]; if (i) if (new StringUtils.String(t.urlString).endsWith('?'))t.urlString += i; else { n('&', i) } } return t } }, refreshToken: function (e, t, n) { $.ajax({ type: 'post', headers: { CatalogName: STUDIO_DATA.catalogName, CatalogVersion: STUDIO_DATA.version }, url: '/skavastream/studio/token', data: null, dataType: 'json', success: function (e) { typeof t === 'function' && t(e) }, error: function (e) { console.log(e), typeof n === 'function' && n(e) }, async: !!e && e.getInputParams().async }) }, getCsrfToken: function (e, t) { var n = StudioToolkit.getCatalogProperties(); var i = n && n['add-CSRFToken']; if ((i && i.value && i.value.toLowerCase()) == 'true') { var r = Date.now(); u.length != 2 || r - u[0] > 24e4 ? l ? setTimeout(function () { HttpUtils.getCsrfToken(e, t) }, 0) : (l = !0, $.ajax({ url: '/u-route/baas/sys/v1.0/csrf/get', type: 'post', dataType: 'json', async: t && t.async || 'true', success: function (t) { l = !1, t && t.resCode == '0' && (u = [], u.push(Date.now()), u.push(t.result), e && e(t.result)) }, error: function () { l = !1, u = [], e && e('') } })) : e && e(u[1]) } else e && e('') } }, this.StringUtils = { String: function (e) { var t = this; if (!(this instanceof StringUtils.String)) return new StringUtils.String(e); t.string = e || '', t.startsWith = function (e) { return t.string.slice(0, e.length) === e }, t.endsWith = function (e) { return t.string.indexOf(e, t.string.length - e.length) !== -1 }, t.trimIfEndsWith = function (e) { return t.string && e && t.endsWith(e) && (t.string = t.string.substr(0, t.string.length - e.length)), t }, t.trimIfStartsWith = function (e) { return t.string && e && t.startsWith(e) && (t.string = t.string.substr(e.length)), t }, t.includes = function (e, n) { return t.string.indexOf(e, n) > -1 }, t.toString = function () { return t.string } } }, this.StudioToolkit = { getVersionType: function () { return readerObj ? readerObj.getCatalog().version : skObj ? skObj.catalogService.getRevision().version : void 0 }, isInStudio: function () { return Studio && !Studio.inReader }, isEditMode: function () { return sksObj && sksObj.isEditMode }, getPackageInfo: function (e) { var t, n; t = this.isInStudio() ? skObj.pageService.getPluginIncludes() : SKReader.getCatalog().pluginIncludes; for (var i = 0; i < t.length; i++) { var r = t[i].filePackageInfo.widgetApi || t[i].filePackageInfo.connectorApi || t[i].filePackageInfo.eventApi; if (r) for (var o = 0; o < r.length; o++) { var a = e.widget ? e.widget.widgetType : null; if (r[o].name == a) { n = t[i].filePackageInfo; break } } } return n }, getCatalogProperties: function () { return this.isInStudio() ? skObj.pageService.catalogObj.catalogProperties : (SKReader.getCatalog() || STUDIO_DATA).catalogProperties } } }())
!(function () { ConnectorWrapper = ConnectorV2.extend({ init: function () { this.ajaxOptions = {}, this.connectorInterval = null, this.isWebSocket = !1 }, process: function (e, t, n) { var r = this; if (r.connectorDataType != 'static') { if (r.constructUrl(this.requestParams || this.connectorParams, n), r.isWebSocket) return void r.processWebSocket(e, t, n); var o = r.getInputParams(); HttpUtils.getCsrfToken(function (o) { var a = ConnectorToolkit.getAjaxOptions({ async: r.getInputParams().async }); n && n.operation && (a = $.extend(!0, a, { headers: { Operation: n.operation } })), o && (a = $.extend(!0, a, { headers: { 'CSRF-Token': o } })), r.ajaxOptions = $.extend(!0, r.ajaxOptions, a); var s = function (e) { if (!StudioToolkit.isInStudio()) { console.error(e.resMsg); var t = StudioToolkit.getCatalogProperties() ? StudioToolkit.getCatalogProperties().loginUrl : null; if (t && t.value) return console.info('Now redirect to login page�?', t.value), HttpUtils.setCookie('isLogged', !1), void (location.href = t.value); console.error('loginUrl should be configured in your campaign->Settings->Properties.') } }; var i = function (t) { var n = new CustomEvent('connectorWrapperEvent', { detail: { status: 'success', resp: t } }); window.dispatchEvent ? window.dispatchEvent(n) : window.fireEvent(n), HttpUtils.setCookie('lastSessionRefreshTime', (new Date()).getTime()), t && t.resCode == 'STO-001003' && s(t); var o = r.getInputParams().filters; if (o) { var a = function (e, n) { if (n.length) { var r = n[0]; var o = n.slice(1); r(e, function (t) { a(t || e, o) }) } else t = e }; a(t, o) }r.transform(t, e) }; var c = 0; var u = function (e) { var n = e.responseText || null; var o = { response: e.status != 404 ? JSON.parse(n) : n, status: e.status, statusText: e.statusText, readyState: e.readyState }; var a = new CustomEvent('connectorWrapperEvent', { detail: { status: 'error', resp: o } }); window.dispatchEvent ? window.dispatchEvent(a) : window.fireEvent(a), e.status == 401 ? (console.info('Token exipred, now trying to update...'), HttpUtils.refreshToken(r, function (e) { console.info('Token updated', e.responseMessage), e.responseCode == 0 ? c < 2 ? (c++, r.getConnectorData(i, u)) : (console.log('Retry fail'), c = 0) : window.parent !== window && window.parent.location.reload() }, function () { console.error('Token updated fail!') })) : e.status == 403 ? s(e) : t(o) }; if (r.getConnectorData(i, u), r.connectorInterval && clearInterval(r.connectorInterval), r.connectorPeriod) { var p = setInterval(function () { r.getConnectorData(i, u) }, 1e3 * r.connectorPeriod); r.connectorInterval = p, Studio.inReader || void 0 == r.connectorWidgetId || (window.connectorInterval = window.connectorInterval || {}, window.connectorInterval[r.connectorWidgetId] = window.connectorInterval[r.connectorWidgetId] || [], window.connectorInterval[r.connectorWidgetId].push(p)) } }, o) } else { var a = {}; try { a = JSON.parse(r.connectorStaticData) } catch (e) { a = r.connectorStaticData } finally { if (r.transform(a, e), r.connectorInterval && clearInterval(r.connectorInterval), r.connectorPeriod) { var s = setInterval(function () { r.transform(a, e) }, 1e3 * r.connectorPeriod); r.connectorInterval = s, Studio.inReader || void 0 == r.connectorWidgetId || (window.connectorInterval = window.connectorInterval || {}, window.connectorInterval[r.connectorWidgetId] = window.connectorInterval[r.connectorWidgetId] || [], window.connectorInterval[r.connectorWidgetId].push(s)) } } } }, processWebSocket: function (e, t, n) { function r () { ws = new WebSocket(o.getUrl()), ws.onmessage = function (n) { var r; try { r = JSON.parse(n && n.data || null) } catch (e) { t() }o.transform(r, e) }, ws.onerror = function (e) { t() }, ws.onclose = function (e) { r() } } var o = this; if (o.constructUrl(this.requestParams || this.connectorParams, n), Studio.inReader || !o.connectorBasePath || o.connectorDataType)r(); else { (((skObj.pageService.catalogObj.pluginIncludesObj || {})[o.connectorName] || {}).fileUrls || []).indexOf(o.connectorBasePath + 'mock/data.json') > -1 && $.ajax({ url: o.connectorBasePath + 'mock/data.json', success: function (t) { o.transform(t, e) }, dataType: 'json' }) } }, getRequestParams: function () { return this.requestParams }, setRequestParams: function (e) { this.requestParams = e }, getWebSocket: function () { return this.isWebSocket }, setWebSocket: function () { this.isWebSocket = !0 }, query: function (e) { var t = this; var n = $.Deferred(); return t.requestParams = e, t.process(n.resolve, n.reject, { operation: 'query' }), n.promise() }, mutate: function (e) { var t = this; var n = $.Deferred(); return t.requestParams = e, t.process(n.resolve, n.reject, { operation: 'mutate' }), n.promise() } }), ViewModel = Class.extend({ schema: null, resp: null, data: null }, function () {}), ConnectorToolkit = { filters: { dataFilter: function (e, t) { if (e && typeof e === 'object') { var n = function (e) { $.each(e, function (t, r) { if (r && typeof r === 'string') { var o = moment(r, 'YYYY-MM-DD HH:mm:ss', !0); o.isValid() && (e[t] = o.toDate()) } else r && typeof r === 'number' || (r && typeof r === 'object' ? n(r) : r && $.isArray(r) && n(r)) }) }; n(e) }t(e) } }, getBasePath: function () { return '/u-route/baas/' }, getAjaxOptions: function (e) { var t = { contentType: 'text/html;charset=utf-8', headers: { 'Content-Type': 'application/json', locale: HttpUtils.getLocaleWithUnderline() } }; var n = StudioToolkit.getCatalogProperties() ? StudioToolkit.getCatalogProperties()['tenant-id'] : null; return n && (t.headers['tenant-id'] = n.value), e && $.extend(!0, t, e), t }, getSiteSettings: function () { var e = JSON.parse(sessionStorage.getItem('site-settings')); if (e);else { e = {}; var t = new HttpUtils.URL('/').appendPath(ConnectorToolkit.getBasePath()).appendPath('/sys/v1.0/organization').toString(); $.ajax(t, ConnectorToolkit.getAjaxOptions({ dataType: 'json', type: 'get', async: !1 })).done(function (t) { t.resCode == '0' ? (e.locale = t.result.languageLocaleKey, e.currency = t.result.currencyLocaleKey, e.currencies = [], $.each(t.result.currencies, function (t, n) { if (n.active) { var r = { code: n.currencyCode, format: n.format, symbol: n.symbol, decimalsep: n.decimalsep, thousandsep: n.thousandsep, decimalPlaces: n.decimalPlaces, conversionRate: n.conversionRate }; e.currencies.push(r) }e.currency == n.currencyCode && (e.currencySetting = r) }), sessionStorage.setItem('site-settings', JSON.stringify(e))) : console.log(t.resMsg) }) } return e }, toJsonSchema: function (e) { var t; var n = function (e) { var t = {}; return t.type = '', t.properties = {}, t.required = [], $.each(e || [], function (e, n) { var r = {}; var o = n.name || n.Name; if (n.label && (r.label = n.label), n.description && (r.description = n.description), (n.Size || n.dataLength) && (r.maxLength = n.Size || n.dataLength), n.isConnection)r.type = 'array', r.items = {}; else { var a = (n.dataType || n.valueType || n.Type || n.type || '').toLowerCase(); var s = { text: { type: 'string' }, number: { type: 'integer' }, boolean: { type: 'boolean' }, date: { type: 'string', format: 'date' }, id: { type: 'string' }, name: { type: 'string' }, textarea: { type: 'string' }, datetime: { type: 'string', format: 'date-time' }, checkbox: { type: 'boolean' }, percent: { type: 'integer' }, phone: { type: 'string', format: 'phone' }, currency: { type: 'number', format: 'currency' }, email: { type: 'string', format: 'email' }, url: { type: 'string', format: 'uri' }, autonumber: { type: 'integer' }, lookup: { type: 'string' }, masterdetails: { type: 'string' }, any: {} }; switch (a) { case 'struct':r.$ref = '#/definitions/' + n.structType; break; case 'singleselect':case 'multipleselect':r.enum = n.picklistValues; break; case '':break; default:var i = s[a]; i && $.extend(r, i) } }t.properties[o] = r, (n.required || n.isRequired) && t.required.push(o) }), t }; var r = { $schema: 'http://json-schema.org/draft-06/schema#', title: '' }; if (e && e.result && (t = e.result.outputVariables || e.result.outputs || e.result.RdsDef || e.result.fields), t) { var o = t; var a = e.result.structs; e.result.title ? r.title = e.result.title : e.result.tableInfo && (r.title = e.result.tableInfo.label); var s = n(o); var i = (function (e) { var t = {}; return e && $.each(e, function (e, r) { var o = {}; o.description = r.description; var a = n(r.structMembers || []); $.extend(o, a), t[r.name] = o }), t }(a)); $.extend(r, s, { definitions: i }) } return r }, convertSchema: function (e) { var t = function (e, t, n) { var r = {}; return $.each(t || [], function (t, o) { o.name.replace(/[&\|\\\*^%$#@\-_]/g, '') == e.replace(/[&\|\\\*^%$#@\-_]/g, '') && $.each(o.structMembers || [], function (e, t) { r[t.name] = {}, r[t.name].description = t.description, t.dataType == 'any' ? r[t.name] = {} : r[t.name].type = t.dataType == 'text' ? 'string' : t.dataType, t.required && n.push(t.name) }) }), r }; var n = { $schema: 'http://json-schema.org/draft-06/schema#', title: '', type: '' }; return e && e.result && e.result.outputVariables && (n.title = e.result.name, n.type = 'object', n.properties = {}, n.required = [], $.each(e.result.outputVariables || [], function (r, o) { n.properties[o.name] = {}; var a = []; o.isCollection ? (n.properties[o.name].type = 'array', n.properties[o.name].items = {}, o.dataType == 'struct' ? (n.properties[o.name].items.type = 'object', n.properties[o.name].items.properties = {}, n.properties[o.name].items.properties = t(o.name, e.result.structs, a), n.properties[o.name].items.required = a) : n.properties[o.name].items.type = o.dataType == 'text' ? 'string' : o.dataType) : o.dataType == 'struct' ? (n.properties[o.name].type = 'object', n.properties[o.name].properties = {}, n.properties[o.name].properties = t(o.name, e.result.structs, a), n.properties[o.name].required = a) : n.properties[o.name].type = o.dataType == 'text' ? 'string' : o.dataType, n.properties[o.name].description = o.description, n.required.push(o.name) })), n } } }())
!(function () { SksReaderPage = Class.extend({ init: function (e, t, a) { this.pageData = e, this.params = t, this.pageId = this.pageData.pageId, this.pageName = this.pageData.pageName, this.pageTitle = null, this.viewName = this.pageData.viewName, this.isFlexi = this.pageData.pageViewProperties.flexi_page == 'true', this.element = $(".scfPage[data-pageid='" + this.pageId + "']"), this.pageUri = a.pageUri || null, this.widgetToNav = a.widgetName || null, this.pageData.facets && (this.pageTitle = this.pageData.facets.page_title || '', this.pageUri || (this.pageUri = this.pageData.facets.page_uri || '')), this.waitForPageDOMReady = readerObj.getSiteFacetByName(SKRConstants.SITE_WAIT_FOR_PAGE_DOM_READY_FACET_NAME), this.eventWidgetList = {}, this.allWidgetList = {}, this.renderedWidgetList = {}, this.allWidgetListById = {}, this.pageiScrollObj = null, this.lingerTimeouts = [], this.widgetMapping = [], this.pluginApi = [] }, renderPage: function () { var e = this; var t = location.pathname.lastIndexOf(SKRConstants.DEEPLINK_WIDGETNAME_DELIMITER); t > 0 && (this.widgetToNav = location.pathname.substr(t + 1)), e.pageCreateEvent(function () { readerObj.gaJsTrackPageView(e.pageUri); var t = e.pageData.pageViewProperties; if (readerObj.getSiteFacetByName(SKRConstants.SITE_DISABLE_DEFAULT_VIEWPORT_FACET_NAME) != 'true' && !readerObj.isWebApp && e.isFlexi && e.pageData.dimensions && e.pageData.dimensions.width) { var a = 'width=' + e.pageData.dimensions.width; var i = $("meta[name='viewport']").attr('content'); i = i.replace(/width=(.[^,]*)/, a), $("meta[name='viewport']").attr('content', i) }$('.cls_skWidget', e.element).each(function (t, a) { var i = $(a).attr('id'); var n = null; var s = {}; if ($(a).parent().hasClass('cls_absWidget')) { var r = $(a).parent().attr('widgetid'); var l = e.getAbsoluteWidgetById(r); n = e.getOverlayCellData(l), s.isAbsWidget = !0, s.parentElement = $(a).parent(), s.parentWidget = l } else n = e.getCellByCellId(i); e.allWidgetList[i] = n ? n.widget : null, e.renderWidget(null, null, $(a), n, s) }), e.pageShowEvent(function () { $.documentReady($.proxy(function () { t.page_background && t.page_parallax && t.page_background == 'true' && t.page_parallax == 'true' && e.addParallaxEffect(t.page_parallax_ratio, e.isFlexi), e.afterPageRender() }, e), SKRConstants.PAGE_READY_INTERVAL) }) }) }, renderWidget: function (e, t, a, i, n) { var s = this; if (!$.isEmptyObject(a)) { var r = a.attr('id'); var l = a.attr('widgetid'); var o = a.attr('widgettype'); var d = i ? i.widget : null; var g = $.extend({ pageId: s.pageId, params: s.params, isFlexi: s.isFlexi, isAbsWidget: !1, isOverlay: !1 }, n); var p = function () { var t = function (t, i, n, s, r, l, o) { t = s || t; var d = function (e, t, i, n, s, r, l) { var o = null; var d = null; s ? (o = typeof s === 'object' ? $($(s, e)[l]) : $($('.' + s, e)[l]), d = $('>img', o)[0]) : o = e; var g = t.items[l]; try { var p = 0; var c = function () { p++; var e = p < 20 ? 250 : p < 40 ? 500 : 1e3; $(d).width() && $(d).height() && d.naturalWidth && d.naturalHeight || p > 145 ? new SksReaderEvents(o, a, g, t, i, r).render() : setTimeout(c, e) }; d && d != null ? c() : new SksReaderEvents(o, a, g, t, i, r).render() } catch (e) { console.log(SKRConstants.ErrorLoadingPluginAPI + ' ' + e) } }; if (o != null)d(t, i, n, 0, r, l, o); else for (var g = 0; g < i.items.length; g++)d(t, i, n, 0, r, l, g); if (i.events && !$.isEmptyObject(i.events)) { var p = {}; p.events = i.events, p.eventsArray = i.eventsArray, p.sortOrder = i.sortOrder; try { new SksReaderEvents(t, a, p, i, n, null, !0).render() } catch (e) { console.log(SKRConstants.ErrorLoadingPluginAPI + ' ' + e) } } if (i.absWidget && a.hasClass('sk-ui-layout-grid-cell')) { var c = $(t).closest('.cls_absWidget'); c.length > 0 && readerObj.calculateAbsoluteWidgetPosition(c) }e && e() }; if (window[d.widgetType]) try { if (window[d.widgetType]) { if (d.eventParams = g && g.params ? g.params : {}, window[d.widgetType].prototype && window[d.widgetType].prototype.baseClassVersion && window[d.widgetType].prototype.baseClassVersion == 'v2') var i = new window[d.widgetType]($.createDelegate(s, t, [a, d, g]), null, d, $('.skcCellContainer', $('.cls_customWidgetAPI:first', a))); else var i = new window[d.widgetType](d, $('.cls_customWidgetAPI:first', a), $.createDelegate(s, t, [a, d, g])); s.renderedWidgetList[r] = i, s.widgetReadyEvent({ widgetId: l, widgetType: o, widgetEl: a, widgetData: d }) } } catch (e) { console.log(SKRConstants.ErrorLoadingPluginAPI + ' ' + e), s.widgetLoadError({ widgetId: l, widgetType: o, widgetEl: a, widgetData: d }) } }; readerObj.pluginWidgetResourceMap && readerObj.pluginWidgetResourceMap[d.widgetType] ? $.loadPluginRequiredFiles(d.widgetType, p) : (console.log("Can't find widget type ", o), s.widgetLoadError({ widgetId: l, widgetType: o, widgetEl: a, widgetData: d }), t && t()) } }, showWidget: function (e, t, a, i, n, s) { function r (e, t, a, i, n) { if (n) { e.style[t] = 0 + a + '%' } else e.style[t] = a + 'px' } var l = this; a.attr('id'); if (e) { var o = $(a).attr('widgettype'); var d = null; var g = null; var p = null; var c = null; var h = null; var v = !1; var u = !1; var w = !1; var f = !1; var m = !1; var y = null; var W = null; var E = !1; e.params && e.params.length > 0 && (p = e.params[0], c = e.params[1], h = e.params[2] ? JSON.parse(e.params[2]) : null, v = !!e.params[3] && e.params[3] == 'true', u = !!e.params[4] && e.params[4] == 'true', w = !(!e.params[5] || e.params[5] != 'true') || i && i.libWidget, f = !!e.params[6] && e.params[6] == 'true', m = !!e.params[7] && e.params[7] == 'true', E = !!e.params[8] && e.params[8] == 'true'), w ? (d = isNaN(parseInt(l.widgetType)) ? t : a, g = isNaN(parseInt(l.widgetType)) ? t : a) : (d = $('.lyt_cont_div', l.element), g = $('.lyt_cont_div', l.element)); var I = 'showWidgetCont_' + e.name.replace(/\s/g, '_') + '_' + c; if (v) { if ($('.showWidgetContInvisMask', g).length == 0) { var _ = document.createElement('div'); _.className = 'showWidgetContInvisMask', readerObj.isIEBrowser && (_.style.backgroundImage = "url('../img/trans.png')", _.style.backgroundRepeat = 'repeat'), $(g).append(_) } else $('.showWidgetContInvisMask', g).show(); $('.showWidgetContInvisMask', g).unbind('click').click(function () { $('.showWidgetCont', g).not('.skNonModalWidget').remove(), $('.showWidgetContInvisMask', g).hide(), $('.showWidgetContInvisMask', g).css('background-color', 'transparent').css('opacity', '0') }), $('.showWidgetContInvisMask', g).unbind('touchstart').bind('touchstart', function () { $('.showWidgetContInvisMask', g).trigger('click') }) } if (f && $(t).bind('onblur', function (e) { if (this == e.target) { var t = l.getScrollObj(I, $('#' + I, d).children().attr('id')); $('#' + I, d).length > 0 && (t && t.length > 0 && t.destroySlider(), $('#' + I, d).remove()) }e.stopPropagation() }), $('#' + I, d).length != 0) return !1; var T = document.createElement('div'); if (T.id = I, T.className = 'showWidgetCont ' + (v ? 'skModalWidget' : 'skNonModalWidget') + (f ? ' skHideWidgetOnblur' : ''), T.className += e.actionName ? ' ' + e.name.replace(/\s/g, '_') + '_' + e.actionName.replace(/\s/g, '_') : '', e.overlayWidget && e.overlayWidget.position) if (isNaN(parseInt(l.widgetType))) { var R = $('>img', t)[0]; var O = {}; O.width = e.overlayWidget.dimension.width, O.height = e.overlayWidget.dimension.height, O.left = e.overlayWidget.position.left, O.top = e.overlayWidget.position.top; var C = sksCalculateEventPosition(R, O); T.style.width = C.width + 'px', T.style.height = C.height + 'px', r(T, 'top', parseInt(C.top || 0), w), r(T, 'left', parseInt(C.left || 0), w) } else T.style.width = (e.overlayWidget.dimension && e.overlayWidget.dimension.width ? e.overlayWidget.dimension.width : 100) + 'px', T.style.height = (e.overlayWidget.dimension && e.overlayWidget.dimension.height ? e.overlayWidget.dimension.height : 100) + 'px', r(T, 'top', parseInt(e.overlayWidget.position.top || 0), w), r(T, 'left', parseInt(e.overlayWidget.position.left || 0), w); if ($(d).append(T), E) { var P = document.createElement('div'); P.className = 'skShowWidgetClose', P.innerHTML = 'X', P.title = 'Close Widget', $(P).bind('click', function (e) { v && $('.showWidgetContInvisMask', g).hide(), $('#' + I, d).remove(), e.stopPropagation() }), $(T).append(P) } if (u && ($('.skWidgetLoading', $('#' + I, d)).length == 0 && ($('#' + I, d).append("<div class='skWidgetLoading'></div>"), readerObj && readerObj.catalog && readerObj.catalog.catalogFacets && readerObj.catalog.catalogFacets.loadingSpinner && readerObj.catalog.catalogFacets.loadingSpinner.length > 0 && $('.skWidgetLoading', $('#' + I, d)).addClass('skWidgetSpinnerImgDiv')), $('.skWidgetLoading', $('#' + I, d)).show(), y = function () { $('.skWidgetLoading', $('#' + I, d)).hide() }), m && e.type == SKRConstants.EVT_TYPE_HOVER && ($(n).bind('mouseleave', function (e) { $(e.relatedTarget).closest('#' + I).get(0) != $('#' + I, d).get(0) && $('#' + I, d).remove() }), $('#' + I, d).bind('mouseleave', function (e) { e.relatedTarget != n && $(this).remove() })), e.type == SKRConstants.EVT_TYPE_HOVER) { var S = {}; $(t).data() && !$(t).data().eventElements && ($(t).data().eventElements = {}), S = $(t).data().eventElements, S[e.name + '_' + e.actionName] = T, $(t).data({ eventElements: S }) } var N = function (a, i) { if (a && i) { var n = $('#' + I, d)[0]; if (a && n) { var o = null; if (p == -1) { o = JSON.parse(JSON.stringify(a)); for (var g in a.cells) if (a.cells.hasOwnProperty(g)) { a = a.cells[g] && a.cells[g].widget ? a.cells[g] : null; break } } if (l.allWidgetList[a.cellId] = a.widget, a.widget && a.widget.cells) for (var g in a.widget.cells)a.widget.cells.hasOwnProperty(g) && a.widget.cells[g].widget && (l.allWidgetList[g] = a.widget.cells[g].widget); if (a.widget.properties.absoluteLayout == 'true')a.widget.properties.layoutTop && r(n, 'top', parseInt(a.widget.properties.layoutTop), w), a.widget.properties.layoutLeft && r(n, 'left', parseInt(a.widget.properties.layoutLeft), w), a.widget.properties.layoutWidth && (n.style.width = a.widget.properties.layoutWidth + 'px'), a.widget.properties.layoutHeight && (n.style.height = a.widget.properties.layoutHeight + 'px'), a.widget.properties.zIndex && (n.style.zIndex = a.widget.properties.zIndex || 1); else if (e.overlayWidget && e.overlayWidget.position) { var c = $('>img', t)[0]; if (s && (!isNaN(parseInt(l.widgetType)) || isNaN(parseInt(l.widgetType)) && c == null))n.style.width = (e.overlayWidget.dimension && e.overlayWidget.dimension.width_percent ? e.overlayWidget.dimension.width_percent + '%' : e.overlayWidget.dimension.width ? e.overlayWidget.dimension.width + 'px' : 0) || (o ? o.width + 'px' : null) || a.widget.properties.layoutWidth + 'px', n.style.height = ((e.overlayWidget.dimension && e.overlayWidget.dimension.height ? e.overlayWidget.dimension.height : 0) || (o ? o.heigth : null) || a.widget.properties.layoutHeight) + 'px', e.overlayWidget.position.left_percent ? (r(n, 'top', parseInt(e.overlayWidget.position.top || 0), w), r(n, 'left', parseInt(e.overlayWidget.position.left_percent), w, s)) : (r(n, 'top', parseInt(e.overlayWidget.position.top || 0), w), r(n, 'left', parseInt(e.overlayWidget.position.left || 0), w)); else if (isNaN(parseInt(l.widgetType))) { var v = {}; v.width = e.overlayWidget.dimension.width, v.height = e.overlayWidget.dimension.height, v.left = e.overlayWidget.position.left, v.top = e.overlayWidget.position.top; var u = sksCalculateEventPosition(c, v); n.style.width = u.width + 'px', n.style.height = u.height + 'px', r(n, 'top', parseInt(u.top || 0), w), r(n, 'left', parseInt(u.left || 0), w) } else n.style.width = ((e.overlayWidget.dimension && e.overlayWidget.dimension.width ? e.overlayWidget.dimension.width : 0) || (o ? o.width : null) || a.widget.properties.layoutWidth) + 'px', n.style.height = ((e.overlayWidget.dimension && e.overlayWidget.dimension.height ? e.overlayWidget.dimension.height : 0) || (o ? o.heigth : null) || a.widget.properties.layoutHeight) + 'px', r(n, 'top', parseInt(e.overlayWidget.position.top || 0), w), r(n, 'left', parseInt(e.overlayWidget.position.left || 0), w) }$(n).append(i.html()), $(n).attr('widgetid', a.widget.widgetId), $(n).attr('widgettype', a.widget.widgetType), $(n).attr('widgetname', a.widget.widgetName), $(n).addClass('cls_skWidget').addClass(a.widget.widgetName); var f = { isOverlay: !0, parentWidget: o, params: h, isFlexi: !1 }; W = function (e) { $(e).html('Widget not found').addClass('skWidgetLoadError') }, l.renderWidget(y, W, $(n), a, f) } } else $('#' + I, d).html('Widget not found').addClass('skWidgetLoadError') }; var b = function (e) { $('#' + I, d).html('Widget not found').addClass('skWidgetLoadError'), l.widgetLoadError({ widgetId: c, widgetType: o, widgetEl: a, widgetData: i }) }; p != -1 ? readerObj.getWidgetFromPage(p, c, null, null, function (e, t) { N(t, e) }, b) : readerObj.getWidgetById(c, N, b) } }, applyParallaxEffect: function (e, t, a) { var i = null; var n = typeof t === 'string' ? '#' + t : t; return 'IScroll' in window && (i = new IScroll(n, { mouseWheel: !0, probeType: 3, scrollY: !0, scrollX: !0, click: readerObj.iosTouch || readerObj.isAndroid || readerObj.isBlackBerry || !1, indicators: [{ el: document.getElementById(a), resize: !1, ignoreBoundaries: !0, speedRatioX: e.parallaxBgUrlMoveRatio ? e.parallaxBgUrlMoveRatio : 1, speedRatioY: e.parallaxBgUrlMoveRatio ? e.parallaxBgUrlMoveRatio : 1 }] })), i }, addParallaxEffect: function (e, t) { var a = this; $('.sks-page-active').css('overflow', 'hidden'), $('.sks-page-active .scfContent').addClass('pageParallaxWrapper'), $(window).width() > 0 && $('.sks-page-active .scfContent').width($(window).width() + 'px'), $(window).height() > 0 && $('.sks-page-active .scfContent').height($(window).height() + 'px'); var i = { parallaxBgUrlMoveRatio: e }; $('.sks-page-active #skPageParallax').css('margin-left', $($('.sks-page-active .scfContent').children()).css('margin-left')), $('.sks-page-active #skPageParallax').show(), a.pageiScrollObj = a.applyParallaxEffect(i, $('.sks-page-active .scfContent')[0], 'skPageParallax'), t || $('#skPageParallax').css('margin-left', ($(window).width() - $('.sks-page-active .page').width()) / 2 + 'px') }, animateElem: function (e, t, a, i) { var n = null; if (a == SKRConstants.WIDGET_TRANSITION_SLIDE_LEFT)$(e).parent().addClass('cls_OverlayAnimateParent'), $(e).css('left', t.width + 100 + 'px'), n = function () { $(e).animate({ left: t.animateLeft + 'px' }, 2e3, function () { $(e).parent().removeClass('cls_OverlayAnimateParent'), $(e).attr('style', $(e).attr('def-style')), $(e).find('.hotSpotOverlay').trigger('onfocus'), i && i() }) }; else if (a == SKRConstants.WIDGET_TRANSITION_SLIDE_RIGHT)$(e).parent().addClass('cls_OverlayAnimateParent'), $(e).css('left', -(t.width + 100) + 'px'), n = function () { $(e).animate({ left: t.animateLeft + 'px' }, 2e3, function () { $(e).parent().removeClass('cls_OverlayAnimateParent'), $(e).attr('style', $(e).attr('def-style')), $(e).find('.hotSpotOverlay').trigger('onfocus'), i && i() }) }; else if (a == SKRConstants.WIDGET_TRANSITION_SLIDE_UP)$(e).parent().addClass('cls_OverlayAnimateParent'), $(e).css('top', t.height + 100 + 'px'), n = function () { $(e).animate({ top: t.animateTop + 'px' }, 2e3, function () { $(e).parent().removeClass('cls_OverlayAnimateParent'), $(e).attr('style', $(e).attr('def-style')), $(e).find('.hotSpotOverlay').trigger('onfocus'), i && i() }) }; else if (a == SKRConstants.WIDGET_TRANSITION_SLIDE_DOWN)$(e).parent().addClass('cls_OverlayAnimateParent'), $(e).css('top', -(t.height + 100) + 'px'), n = function () { $(e).animate({ top: t.animateTop + 'px' }, 2e3, function () { $(e).parent().removeClass('cls_OverlayAnimateParent'), $(e).attr('style', $(e).attr('def-style')), $(e).find('.hotSpotOverlay').trigger('onfocus'), i && i() }) }; else if (a == SKRConstants.WIDGET_TRANSITION_FADE)$(e).attr('style', $(e).attr('def-style')), $(e).hide(), n = function () { $(e).fadeIn(2e3), i && i() }; else if (a == SKRConstants.WIDGET_TRANSITION_POP) { var s = $(e).width(); var r = $(e).height(); var l = s / 2; var o = r / 2; $(e).css('left', l + 'px').css('top', o + 'px').css('opacity', 0), n = function () { $(e).width(0).height(0).animate({ width: s, height: r, left: t.animateLeft, top: t.animateTop, opacity: 1 }, 1e3, function () { $(e).attr('style', $(e).attr('def-style')), $(e).find('.hotSpotOverlay').trigger('onfocus'), i && i() }) } } return n }, getCellByCellId: function (e) { var t = this; var a = null; return t.pageData.cells && t.pageData.cells[e] && (a = t.pageData.cells[e] || null), a }, getAbsoluteWidgetById: function (e) { var t = this; var a = null; return t.pageData.absoluteWidgets && (a = t.pageData.absoluteWidgets[e] || null), a }, getOverlayCellData: function (e) { var t = null; if (e && e.cells) for (var a in e.cells) if (e.cells.hasOwnProperty(a) && e.cells[a] && e.cells[a].widget) { t = e.cells[a]; break } return t }, setLingerTimeout: function (e) { this.lingerTimeouts.push(e) }, clearLingerTimeOut: function (e, t) { t ? clearTimeout(t) : clearTimeout(this.lingerTimeouts[e]) }, getPageParams: function () { return this.params }, getAllWidgetList: function () { return this.allWidgetList }, setAllWidgetList: function (e, t) { this.allWidgetList[e] = t }, triggerWidgetEvents: function (e) { function t (e, t, a) { $.each(e, function (e, i) { $.inArray(t, i.eventNames) != -1 && i.eventObj.triggerEvent(t, a) }) } var a = this; if (e) for (var i in e) if (e.hasOwnProperty(i)) { var n = e[i]; if (n && n.eventname) { var s = n.widgetname || null; var r = n.eventname; if (a.eventWidgetList) if (s)a.eventWidgetList[s] && t(a.eventWidgetList[s], r, n); else for (var l in a.eventWidgetList) if (a.eventWidgetList.hasOwnProperty(l)) { var o = a.eventWidgetList[l]; t(o, r, n) } } } }, afterPageRender: function () { var e = this; readerObj.setPageNavigating(!1), readerObj.hideLoadingGauge(), e.widgetToNav && readerObj.navToWidget(e.widgetToNav); try { var t = JSON.parse(sk_getQueryParamByName(SKRConstants.QUERY_PARAM_TRIGGER_EVENTS, null)); e.triggerWidgetEvents(t) } catch (e) { console.log('inavalid trigger event params') }e.pageReadyEvent() }, pageCreateEvent: function (e) { var t = this; $(document).triggerHandler(SKRConstants.READERPAGE_CREATE_EVT, { pageId: t.pageId, pageUri: t.pageUri, params: t.params, pageEl: t.element, pageData: t.pageData }) != 0 ? e && e() : (console.log('Reader pageCreate cancelled for pageId: ', t.pageId), t.setPageNavigating(!1), readerObj.hideLoadingGauge()) }, pageShowEvent: function (e) { var t = this; $(document).triggerHandler(SKRConstants.READERPAGE_SHOW_EVT, { pageId: t.pageId, pageUri: t.pageUri, params: t.params, pageEl: t.element, pageData: t.pageData }) != 0 ? e && e() : (console.log('Reader pageShow cancelled for pageId: ', t.pageId), t.setPageNavigating(!1), readerObj.hideLoadingGauge()) }, pageReadyEvent: function () { var e = this; SKReaderReadyFnCalled = !1; $(document).trigger(SKRConstants.READERPAGE_READY_EVT, { pageId: e.pageId, pageUri: e.pageUri, pageEl: e.element, pageData: e.pageData }) }, widgetReadyEvent: function (e) { $(document).trigger(SKRConstants.READER_WIDGET_READY_EVT, e) }, widgetLoadError: function (e) { $(document).trigger(SKRConstants.READER_WIDGET_LOAD_ERROR, e) }, parseEventParams: function (e, t) { var a = /\$\{(.+?).(.+?)\}/; var i = JSON.parse(JSON.stringify(t)); for (var n in i) if (i.hasOwnProperty(n)) for (;a.test(i[n]) != 0;) { var s = a.exec(i[n]); s[1] && s[1] == 'e' && (i[n] = i[n].replace(s[0], e[s[2]])) } return JSON.stringify(i) } }) }())
